if ((typeof(h9AP67nN46MQi5f2NQrocNd$3university$0university$1)) == "undefined") {h9AP67nN46MQi5f2NQrocNd$3university$0university$1 = {};
};
(function(){h9AP67nN46MQi5f2NQrocNd$3university$0university$1.eq_lang$2735 = function(v$7687,v$7688){return v$7687 == v$7688;
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.eq_sprite$2739 = function(v$7689,v$7690){return v$7689 == v$7690;
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.eq_dir$2743 = function(v$7691,v$7692){return v$7691 == v$7692;
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.eq_hitkind$2747 = function(v$7693,v$7694){return v$7693 == v$7694;
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.s$sl$61 = function(v$7695,v$7696){return v$7696(v$7695);
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.mapi$68 = function(f$71,xs$74){var fix$7942 = {};
fix$7942.$loop = function(v$7697,v$7698,v$7699){lab$loop: while (true) {if (v$7697 == null) {return dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.rev$680(v$7698);
} else {var v$94 = v$7697;
var v$95 = v$94[0];
var v$96 = v$94[1];
var v$7859 = SmlPrims.chk_ovf_i32(v$7699 + 1);
var t$7943 = v$96;
var t$7944 = [f$71([v$7699,v$95]),v$7698];
var t$7945 = v$7859;
var v$7697 = t$7943;
var v$7698 = t$7944;
var v$7699 = t$7945;
continue lab$loop;
};
};
};
var loop$75 = fix$7942.$loop;
return loop$75(xs$74,null,0);
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.ppInt$97 = function(i$100){if (i$100 < 0) {return "-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(i$100))));
} else {return abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(i$100);
};
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.s$d$105 = function(id$108){var v$113 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,id$108);
switch (v$113[0]) { case 0: {return v$113[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,("no element with id '" + id$108) + "' in DOM"];
} };
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.println$116 = function(s$119){return EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161(s$119 + "\n");
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.serverGet$120 = function(file$123){var file$124;
var t$7949 = file$123 + "?_=";
var t$7948;
var t$7947 = y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.toString$158;
var t$7946;
var v$2771 = SmlPrims.getrealtime();
var v$2772 = v$2771[0];
var v$2773 = v$2771[1];
t$7946 = ((v$2772 - (-2147483648)) + (v$2773 / 1000000.0));
t$7948 = (t$7947(t$7946));
file$124 = (t$7949 + t$7948);
var r$125 = SmlPrims.newRequest();
(function(r,m,u,a){return r.open(m,u,a);})(r$125,"GET",file$124,false);
z11cymP27JOrM6FBeJkkje$3js$0Js$1.send$652(r$125,[1]);
var v$132 = (function(r){return SmlPrims.option(r.responseText);})(r$125);
switch (v$132[0]) { case 0: {return v$132[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"serverGet failed on file " + file$124];
} };
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.serverGetAsync$140 = function(file$143,f$146){var file$147;
var t$7953 = file$143 + "?_=";
var t$7952;
var t$7951 = y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.toString$158;
var t$7950;
var v$2782 = SmlPrims.getrealtime();
var v$2783 = v$2782[0];
var v$2784 = v$2782[1];
t$7950 = ((v$2783 - (-2147483648)) + (v$2784 / 1000000.0));
t$7952 = (t$7951(t$7950));
file$147 = (t$7953 + t$7952);
var r$148 = SmlPrims.newRequest();
(function(r,m,u,a){return r.open(m,u,a);})(r$148,"GET",file$147,true);
(function(r,f){r.onreadystatechange = f;})(r$148,function(v$155){var v$161 = (function(r){return SmlPrims.option(r.status);})(r$148);
switch (v$161[0]) { case 0: {switch (v$161[1]) { case 200: {var v$168 = (function(r){return SmlPrims.option(r.responseText);})(r$148);
switch (v$168[0]) { case 0: {return f$146([0,v$168[1]]);
 break; }default: {return f$146([1]);
} };
 break; }default: {return f$146([1]);
} };
 break; }default: {return 0;
} };
});
z11cymP27JOrM6FBeJkkje$3js$0Js$1.send$652(r$148,[1]);
return 0;
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.look$175 = function(k$178,xs$181){return dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(k$178,xs$181);
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.log$182 = function(s$185){var log$186;
var v$2794 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"log");
switch (v$2794[0]) { case 0: {log$186 = v$2794[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'log' in DOM"];
} };
(function(e,a){return e.appendChild(a);})(log$186,document.createTextNode(s$185));
return (function(e,a){return e.appendChild(a);})(log$186,document.createElement("br"));
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.windowInnerWidth$189 = function(){return (function(){return window.innerWidth;})();
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.windowInnerHeight$194 = function(){return (function(){return window.innerHeight;})();
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.isMobile$199 = function(){return (((function(){return window.innerWidth;})()) <= 1000)?(((function(){return window.innerHeight;})()) <= 1000):false;
};
var fix$7954 = {};
fix$7954.$prefixzeros = function(i$209,s$212){lab$prefixzeros: while (true) {if (s$212.length < i$209) {var t$7955 = i$209;
var t$7956 = "0" + s$212;
var i$209 = t$7955;
var s$212 = t$7956;
continue lab$prefixzeros;
} else {return s$212;
};
};
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.prefixzeros$206 = fix$7954.$prefixzeros;
((((function(){return window.innerWidth;})()) <= 1000)?(((function(){return window.innerHeight;})()) <= 1000):false)?"mobile":"stationary";
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.deviceStr$222 = ((abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456((function(){return window.innerWidth;})())) + "x") + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456((function(){return window.innerHeight;})()));
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.minimap_p$223 = ((((function(){return window.innerWidth;})()) <= 1000)?(((function(){return window.innerHeight;})()) <= 1000):false)?false:true;
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.speak$226 = function(lang$229,txt$232){var lan$233;
switch (lang$229) { case 1: {lan$233 = "dk-DA";
 break; }default: {lan$233 = "en-GB";
} };
var synth$238 = (function(){return window.speechSynthesis;})();
(function(synth){synth.cancel();})(synth$238);
(function(){window.utterances = [];})();
var msg$244 = (function(txt){return new SpeechSynthesisUtterance(txt);})(txt$232);
(function(u){window.utterances.push(u);})(msg$244);
(function(fp,s,v){fp[s] = v;})(msg$244,"lang",lan$233);
return (function(synth,msg){synth.speak(msg);})(synth$238,msg$244);
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.loadStaff$263 = function(data$266){var jsonToStaff$368 = function(j$371){switch (j$371[0]) { case 2: {var v$383 = j$371[1];
var v$378;
var v$3020;
var v$3023 = DNzgidgaaiBsxwxK6Q4Ukm$3json$0json$1.objLook$96(v$383,"id");
switch (v$3023[0]) { case 0: {v$3020 = v$3023[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find  json object id in staff.json"];
} };
switch (v$3020[0]) { case 0: {v$378 = v$3020[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find string json object id in staff.json"];
} };
var v$379;
var v$3036;
var v$3039 = DNzgidgaaiBsxwxK6Q4Ukm$3json$0json$1.objLook$96(v$383,"name");
switch (v$3039[0]) { case 0: {v$3036 = v$3039[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find  json object name in staff.json"];
} };
switch (v$3036[0]) { case 0: {v$379 = v$3036[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find string json object name in staff.json"];
} };
var t$7969;
var v$3052;
var v$3055 = DNzgidgaaiBsxwxK6Q4Ukm$3json$0json$1.objLook$96(v$383,"avatar");
switch (v$3055[0]) { case 0: {v$3052 = v$3055[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find  json object avatar in staff.json"];
} };
switch (v$3052[0]) { case 0: {t$7969 = v$3052[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find string json object avatar in staff.json"];
} };
var t$7968 = v$378;
var t$7967 = v$379;
var t$7966;
var v$3068;
var v$3071 = DNzgidgaaiBsxwxK6Q4Ukm$3json$0json$1.objLook$96(v$383,"office");
switch (v$3071[0]) { case 0: {v$3068 = v$3071[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find  json object office in staff.json"];
} };
switch (v$3068[0]) { case 0: {t$7966 = v$3068[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find string json object office in staff.json"];
} };
var t$7957;
var v$6780;
var v$6781 = DNzgidgaaiBsxwxK6Q4Ukm$3json$0json$1.objLook$96(v$383,"slides");
switch (v$6781[0]) { case 0: {v$6780 = v$6781[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find  json object slides in staff.json"];
} };
switch (v$6780[0]) { case 6: {var v$6782 = v$6780[1];
var v$6800 = null;
var fix$7958 = {};
fix$7958.$foldr = function(v$6802){if (v$6802 == null) {return v$6800;
} else {var v$6803 = v$6802;
var v$6804 = v$6803[0];
var v$6805 = v$6803[1];
var v$7385 = fix$7958.$foldr(v$6805);
switch (v$6804[0]) { case 2: {var v$6809 = v$6804[1];
var t$7965;
var t$7964;
var t$7963;
var v$6810;
var v$6811 = DNzgidgaaiBsxwxK6Q4Ukm$3json$0json$1.objLook$96(v$6809,"id");
switch (v$6811[0]) { case 0: {v$6810 = v$6811[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find  json object id in staff.json"];
} };
switch (v$6810[0]) { case 0: {t$7963 = v$6810[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find string json object id in staff.json"];
} };
var t$7962;
var v$6812 = DNzgidgaaiBsxwxK6Q4Ukm$3json$0json$1.objLook$96(v$6809,"lang");
switch (v$6812[0]) { case 0: {var v$6813 = v$6812[1];
switch (v$6813[0]) { case 0: {switch (v$6813[1]) { case "EN": {t$7962 = [0,0];
 break; }case "en": {t$7962 = [0,0];
 break; }case "DA": {t$7962 = [0,1];
 break; }case "da": {t$7962 = [0,1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find da or en json object lang in staff.json"];
} };
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find da or en json object lang in staff.json"];
} };
 break; }default: {t$7962 = [1];
} };
var t$7961;
var v$6814;
var t$7960 = abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.fromString$460;
var t$7959;
var v$6815;
var v$6816 = DNzgidgaaiBsxwxK6Q4Ukm$3json$0json$1.objLook$96(v$6809,"pages");
switch (v$6816[0]) { case 0: {v$6815 = v$6816[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find  json object pages in staff.json"];
} };
switch (v$6815[0]) { case 0: {t$7959 = v$6815[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find string json object pages in staff.json"];
} };
v$6814 = (t$7960(t$7959));
switch (v$6814[0]) { case 0: {t$7961 = v$6814[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find int json object pages in staff.json"];
} };
t$7964 = [t$7963,t$7962,t$7961];
t$7965 = [t$7964,v$7385];
return t$7965;
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find ARRAY OBJECT json object slides in staff.json"];
} };
};
};
var foldr$6801 = fix$7958.$foldr;
t$7957 = (foldr$6801(v$6782));
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find ARRAY json object slides in staff.json"];
} };
return [t$7969,t$7968,t$7967,t$7966,t$7957];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find OBJECT json object ARRAY in staff.json"];
} };
};
return DNzgidgaaiBsxwxK6Q4Ukm$3json$0json$1.foldlArrayJson$963(function(v$387){var v$388 = v$387[0];
var v$389 = v$387[1];
return [jsonToStaff$368(v$388),v$389];
},null,data$266);
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.pagesDeck$390 = function(staff$393,sid$396,did$399){var v$404 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$6818){return v$6818[1] == sid$396;
},staff$393);
switch (v$404[0]) { case 1: {return [1];
 break; }default: {var v$423 = v$404[1];
var v$409 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$6822){return v$6822[0] == did$399;
},v$423[4]);
switch (v$409[0]) { case 1: {return [1];
 break; }default: {return [0,v$409[1][2]];
} };
} };
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.nextSlide$428 = function(staff$431,v$7702,v$7703,v$7704){var did$435 = v$7704[0];
var v$445;
var v$3099 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$3117){return v$3117[1] == v$7702;
},staff$431);
switch (v$3099[0]) { case 1: {v$445 = [1];
 break; }default: {var v$3107 = v$3099[1];
var v$3108 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$3122){return v$3122[0] == did$435;
},v$3107[4]);
switch (v$3108[0]) { case 1: {v$445 = [1];
 break; }default: {v$445 = [0,v$3108[1][2]];
} };
} };
switch (v$445[0]) { case 0: {var v$447 = v$445[1];
return (v$7703[0] = (SmlPrims.mod_i32(SmlPrims.chk_ovf_i32(v$7703[0] + 1),v$447,CompilerInitial.exn$Div$45)),0);
 break; }default: {return 0;
} };
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.prevSlide$453 = function(staff$456,v$7705,v$7706,v$7707){var did$460 = v$7707[0];
var v$470;
var v$3131 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$3149){return v$3149[1] == v$7705;
},staff$456);
switch (v$3131[0]) { case 1: {v$470 = [1];
 break; }default: {var v$3139 = v$3131[1];
var v$3140 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$3154){return v$3154[0] == did$460;
},v$3139[4]);
switch (v$3140[0]) { case 1: {v$470 = [1];
 break; }default: {v$470 = [0,v$3140[1][2]];
} };
} };
switch (v$470[0]) { case 0: {var v$472 = v$470[1];
return (v$7706[0] = (SmlPrims.mod_i32(SmlPrims.chk_ovf_i32((SmlPrims.chk_ovf_i32(v$7706[0] - 1)) + v$472),v$472,CompilerInitial.exn$Div$45)),0);
 break; }default: {return 0;
} };
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.onDeck$478 = function(f$481,staff$484,v$7708,v$7709,v$7710){var v$494 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$6826){return v$6826[1] == v$7708;
},staff$484);
switch (v$494[0]) { case 1: {return 0;
 break; }default: {var v$544 = v$494[1];
var v$545 = v$544[4];
var slides$495 = f$481(v$545);
var did$496 = v$7710[0];
var fix$7970 = {};
fix$7970.$loop = function(v$500){lab$loop: while (true) {if (v$500 == null) {return (slides$495 == null)?0:(v$7710[0] = slides$495[0][0],0);
} else {var v$510 = v$500;
var v$511 = v$510[1];
if (v$511 == null) {return (slides$495 == null)?0:(v$7710[0] = slides$495[0][0],0);
} else {var v$525 = v$510[0];
var v$526 = v$511;
var v$527 = v$526[0];
var v$528 = v$526[1];
if (v$525[0] == did$496) {return (v$7710[0] = v$527[0],0);
} else {var t$7971 = [v$527,v$528];
var v$500 = t$7971;
continue lab$loop;
};
};
};
};
};
var loop$497 = fix$7970.$loop;
loop$497(slides$495);
return (v$7709[0] = 0,0);
} };
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.nextDeck$553 = function(staff$556,v$7711,v$7712,v$7713){var v$3184 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$3216){return v$3216[1] == v$7711;
},staff$556);
switch (v$3184[0]) { case 1: {return 0;
 break; }default: {var v$3192 = v$3184[1];
var v$3193 = v$3192[4];
var did$3195 = v$7713[0];
var fix$7972 = {};
fix$7972.$loop = function(v$3197){lab$loop: while (true) {if (v$3197 == null) {return (v$3193 == null)?0:(v$7713[0] = v$3193[0][0],0);
} else {var v$3198 = v$3197;
var v$3199 = v$3198[1];
if (v$3199 == null) {return (v$3193 == null)?0:(v$7713[0] = v$3193[0][0],0);
} else {var v$3200 = v$3198[0];
var v$3201 = v$3199;
var v$3202 = v$3201[0];
var v$3203 = v$3201[1];
if (v$3200[0] == did$3195) {return (v$7713[0] = v$3202[0],0);
} else {var t$7973 = [v$3202,v$3203];
var v$3197 = t$7973;
continue lab$loop;
};
};
};
};
};
var loop$3196 = fix$7972.$loop;
loop$3196(v$3193);
return (v$7712[0] = 0,0);
} };
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.prevDeck$563 = function(staff$566,v$7714,v$7715,v$7716){var v$3227 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$3259){return v$3259[1] == v$7714;
},staff$566);
switch (v$3227[0]) { case 1: {return 0;
 break; }default: {var v$3235 = v$3227[1];
var v$3236 = v$3235[4];
var slides$3237 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.rev$680(v$3236);
var did$3238 = v$7716[0];
var fix$7974 = {};
fix$7974.$loop = function(v$3240){lab$loop: while (true) {if (v$3240 == null) {return (slides$3237 == null)?0:(v$7716[0] = slides$3237[0][0],0);
} else {var v$3241 = v$3240;
var v$3242 = v$3241[1];
if (v$3242 == null) {return (slides$3237 == null)?0:(v$7716[0] = slides$3237[0][0],0);
} else {var v$3243 = v$3241[0];
var v$3244 = v$3242;
var v$3245 = v$3244[0];
var v$3246 = v$3244[1];
if (v$3243[0] == did$3238) {return (v$7716[0] = v$3245[0],0);
} else {var t$7975 = [v$3245,v$3246];
var v$3240 = t$7975;
continue lab$loop;
};
};
};
};
};
var loop$3239 = fix$7974.$loop;
loop$3239(slides$3237);
return (v$7715[0] = 0,0);
} };
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.isWall$596 = function(v$599){switch (v$599[0]) { case 9: {return false;
 break; }case 8: {return false;
 break; }default: {return true;
} };
};
var mkFun$784 = function(v$7717,v$7718,displays$791){var north$792;
var v$6016 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.filter$415(function(s$795){return (SmlPrims.chk_ovf_i32(s$795[2] - 1)) == v$7718;
},displays$791);
var dists$6856 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.map$695(function(v$6857){var v$6858 = v$6857[0];
var v$6859 = v$6857[1];
var v$6860 = v$6857[2];
var t$7980 = v$6858;
var t$7979;
var t$7978;
var t$7977;
var r$6861 = SmlPrims.chk_ovf_i32(v$6859 - v$7717);
t$7977 = (r$6861 * r$6861);
var t$7976;
var r$6862 = SmlPrims.chk_ovf_i32(v$6860 - v$7718);
t$7976 = (r$6862 * r$6862);
t$7978 = (t$7977 + t$7976);
t$7979 = (Math.sqrt(t$7978));
return [t$7980,t$7979];
},v$6016);
var v$6863;
var fix$7981 = {};
fix$7981.$mini = function(v$6865,v$6866){lab$mini: while (true) {switch (v$6865[0]) { case 1: {if (v$6866 == null) {return v$6865;
} else {var v$6867 = v$6866;
var t$7982 = [0,v$6867[0]];
var t$7983 = v$6867[1];
var v$6865 = t$7982;
var v$6866 = t$7983;
continue lab$mini;
};
 break; }default: {if (v$6866 == null) {return v$6865;
} else {var v$6870 = v$6865[1];
var v$6871 = v$6870[1];
var v$6872 = v$6866;
var v$6873 = v$6872[0];
var v$6874 = v$6873[0];
var v$6875 = v$6873[1];
var v$6876 = v$6872[1];
if (v$6875 < v$6871) {var t$7984 = [0,[v$6874,v$6875]];
var t$7985 = v$6876;
var v$6865 = t$7984;
var v$6866 = t$7985;
continue lab$mini;
} else {var t$7986 = v$6865;
var t$7987 = v$6876;
var v$6865 = t$7986;
var v$6866 = t$7987;
continue lab$mini;
};
};
} };
};
};
var mini$6864 = fix$7981.$mini;
v$6863 = (mini$6864([1],dists$6856));
switch (v$6863[0]) { case 0: {var v$6877 = v$6863[1];
var v$6878 = v$6877[0];
north$792 = [0,v$6878];
 break; }default: {north$792 = [1];
} };
var south$800;
var v$6020 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.filter$415(function(s$803){return (SmlPrims.chk_ovf_i32(s$803[2] + 1)) == v$7718;
},displays$791);
var dists$6904 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.map$695(function(v$6905){var v$6906 = v$6905[0];
var v$6907 = v$6905[1];
var v$6908 = v$6905[2];
var t$7992 = v$6906;
var t$7991;
var t$7990;
var t$7989;
var r$6909 = SmlPrims.chk_ovf_i32(v$6907 - v$7717);
t$7989 = (r$6909 * r$6909);
var t$7988;
var r$6910 = SmlPrims.chk_ovf_i32(v$6908 - v$7718);
t$7988 = (r$6910 * r$6910);
t$7990 = (t$7989 + t$7988);
t$7991 = (Math.sqrt(t$7990));
return [t$7992,t$7991];
},v$6020);
var v$6911;
var fix$7993 = {};
fix$7993.$mini = function(v$6913,v$6914){lab$mini: while (true) {switch (v$6913[0]) { case 1: {if (v$6914 == null) {return v$6913;
} else {var v$6915 = v$6914;
var t$7994 = [0,v$6915[0]];
var t$7995 = v$6915[1];
var v$6913 = t$7994;
var v$6914 = t$7995;
continue lab$mini;
};
 break; }default: {if (v$6914 == null) {return v$6913;
} else {var v$6918 = v$6913[1];
var v$6919 = v$6918[1];
var v$6920 = v$6914;
var v$6921 = v$6920[0];
var v$6922 = v$6921[0];
var v$6923 = v$6921[1];
var v$6924 = v$6920[1];
if (v$6923 < v$6919) {var t$7996 = [0,[v$6922,v$6923]];
var t$7997 = v$6924;
var v$6913 = t$7996;
var v$6914 = t$7997;
continue lab$mini;
} else {var t$7998 = v$6913;
var t$7999 = v$6924;
var v$6913 = t$7998;
var v$6914 = t$7999;
continue lab$mini;
};
};
} };
};
};
var mini$6912 = fix$7993.$mini;
v$6911 = (mini$6912([1],dists$6904));
switch (v$6911[0]) { case 0: {var v$6925 = v$6911[1];
var v$6926 = v$6925[0];
south$800 = [0,v$6926];
 break; }default: {south$800 = [1];
} };
var west$808;
var v$6024 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.filter$415(function(s$811){return (SmlPrims.chk_ovf_i32(s$811[1] + 1)) == v$7717;
},displays$791);
var dists$6952 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.map$695(function(v$6953){var v$6954 = v$6953[0];
var v$6955 = v$6953[1];
var v$6956 = v$6953[2];
var t$8004 = v$6954;
var t$8003;
var t$8002;
var t$8001;
var r$6957 = SmlPrims.chk_ovf_i32(v$6955 - v$7717);
t$8001 = (r$6957 * r$6957);
var t$8000;
var r$6958 = SmlPrims.chk_ovf_i32(v$6956 - v$7718);
t$8000 = (r$6958 * r$6958);
t$8002 = (t$8001 + t$8000);
t$8003 = (Math.sqrt(t$8002));
return [t$8004,t$8003];
},v$6024);
var v$6959;
var fix$8005 = {};
fix$8005.$mini = function(v$6961,v$6962){lab$mini: while (true) {switch (v$6961[0]) { case 1: {if (v$6962 == null) {return v$6961;
} else {var v$6963 = v$6962;
var t$8006 = [0,v$6963[0]];
var t$8007 = v$6963[1];
var v$6961 = t$8006;
var v$6962 = t$8007;
continue lab$mini;
};
 break; }default: {if (v$6962 == null) {return v$6961;
} else {var v$6966 = v$6961[1];
var v$6967 = v$6966[1];
var v$6968 = v$6962;
var v$6969 = v$6968[0];
var v$6970 = v$6969[0];
var v$6971 = v$6969[1];
var v$6972 = v$6968[1];
if (v$6971 < v$6967) {var t$8008 = [0,[v$6970,v$6971]];
var t$8009 = v$6972;
var v$6961 = t$8008;
var v$6962 = t$8009;
continue lab$mini;
} else {var t$8010 = v$6961;
var t$8011 = v$6972;
var v$6961 = t$8010;
var v$6962 = t$8011;
continue lab$mini;
};
};
} };
};
};
var mini$6960 = fix$8005.$mini;
v$6959 = (mini$6960([1],dists$6952));
switch (v$6959[0]) { case 0: {var v$6973 = v$6959[1];
var v$6974 = v$6973[0];
west$808 = [0,v$6974];
 break; }default: {west$808 = [1];
} };
var east$816;
var v$6028 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.filter$415(function(s$819){return (SmlPrims.chk_ovf_i32(s$819[1] - 1)) == v$7717;
},displays$791);
var dists$7000 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.map$695(function(v$7001){var v$7002 = v$7001[0];
var v$7003 = v$7001[1];
var v$7004 = v$7001[2];
var t$8016 = v$7002;
var t$8015;
var t$8014;
var t$8013;
var r$7005 = SmlPrims.chk_ovf_i32(v$7003 - v$7717);
t$8013 = (r$7005 * r$7005);
var t$8012;
var r$7006 = SmlPrims.chk_ovf_i32(v$7004 - v$7718);
t$8012 = (r$7006 * r$7006);
t$8014 = (t$8013 + t$8012);
t$8015 = (Math.sqrt(t$8014));
return [t$8016,t$8015];
},v$6028);
var v$7007;
var fix$8017 = {};
fix$8017.$mini = function(v$7009,v$7010){lab$mini: while (true) {switch (v$7009[0]) { case 1: {if (v$7010 == null) {return v$7009;
} else {var v$7011 = v$7010;
var t$8018 = [0,v$7011[0]];
var t$8019 = v$7011[1];
var v$7009 = t$8018;
var v$7010 = t$8019;
continue lab$mini;
};
 break; }default: {if (v$7010 == null) {return v$7009;
} else {var v$7014 = v$7009[1];
var v$7015 = v$7014[1];
var v$7016 = v$7010;
var v$7017 = v$7016[0];
var v$7018 = v$7017[0];
var v$7019 = v$7017[1];
var v$7020 = v$7016[1];
if (v$7019 < v$7015) {var t$8020 = [0,[v$7018,v$7019]];
var t$8021 = v$7020;
var v$7009 = t$8020;
var v$7010 = t$8021;
continue lab$mini;
} else {var t$8022 = v$7009;
var t$8023 = v$7020;
var v$7009 = t$8022;
var v$7010 = t$8023;
continue lab$mini;
};
};
} };
};
};
var mini$7008 = fix$8017.$mini;
v$7007 = (mini$7008([1],dists$7000));
switch (v$7007[0]) { case 0: {var v$7021 = v$7007[1];
var v$7022 = v$7021[0];
east$816 = [0,v$7022];
 break; }default: {east$816 = [1];
} };
return function(v$842){switch (v$842) { case 2: {return north$792;
 break; }case 1: {return south$800;
 break; }case 3: {return east$816;
 break; }default: {return west$808;
} };
};
};
var dsps$920 = [null];
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.load$921 = function(data$924){var v$934;
var v$3475;
var fix$8024 = {};
fix$8024.$loop = function(v$3477,v$3478){lab$loop: while (true) {if (v$3477 == null) {return [dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.rev$680(v$3478),null];
} else {var v$3479 = v$3477;
var v$3480 = v$3479[0];
switch (v$3480) { case "=": {var v$3481 = v$3479[1];
return [dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.rev$680(v$3478),v$3481];
 break; }default: {var t$8025 = v$3479[1];
var t$8026 = [v$3480,v$3478];
var v$3477 = t$8025;
var v$3478 = t$8026;
continue lab$loop;
} };
};
};
};
var loop$3476 = fix$8024.$loop;
var v$7492 = null;
v$3475 = (loop$3476(h7fbaDWer1eD5BCDBpvTxeg$3basis$0String$1.tokens$222(function(c$3483){return c$3483 == 10;
},data$924),v$7492));
v$934 = [v$3475[0],dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.map$695(function(s$3489){var v$3490 = h7fbaDWer1eD5BCDBpvTxeg$3basis$0String$1.tokens$222(function(c$3491){return (c$3491 == 58)?true:(c$3491 == 44);
},s$3489);
if (v$3490 == null) {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to parse display locations in gameMap.txt"];
} else {var v$3496 = v$3490;
var v$3497 = v$3496[1];
if (v$3497 == null) {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to parse display locations in gameMap.txt"];
} else {var v$3498 = v$3497;
var v$3499 = v$3498[1];
if (v$3499 == null) {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to parse display locations in gameMap.txt"];
} else {var v$3500 = v$3499;
if (v$3500[1] == null) {var v$3501 = v$3496[0];
var v$3502 = v$3498[0];
var v$3503 = v$3500[0];
var v$6044 = abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.fromString$460(v$3502);
var v$6045 = abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.fromString$460(v$3503);
switch (v$6044[0]) { case 0: {switch (v$6045[0]) { case 0: {return [v$3501,v$6044[1],v$6045[1]];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to parse integer locations of displays in gameMap.txt"];
} };
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to parse integer locations of displays in gameMap.txt"];
} };
} else {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to parse display locations in gameMap.txt"];
};
};
};
};
},v$3475[1])];
var v$935 = v$934[0];
var v$936 = v$934[1];
(dsps$920[0] = v$936,0);
var t$8044;
var t$8043 = Y5y0a7l58ITwhpccCWLDEa$3basis$0Array2$1.fromList$58;
var t$8042;
var fix$8027 = {};
fix$8027.$loop = function(v$7719,v$7720,v$7721){lab$loop: while (true) {if (v$7719 == null) {return dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.rev$680(v$7720);
} else {var v$3516 = v$7719;
var v$3517 = v$3516[0];
var v$3518 = v$3516[1];
var v$7865 = SmlPrims.chk_ovf_i32(v$7721 + 1);
var t$8038 = v$3518;
var t$8037;
var t$8036;
var t$8028;
var e$7026 = null;
var start$7027 = SmlPrims.chk_ovf_i32(v$3517.length - 1);
var fix$8029 = {};
fix$8029.$rl = function(v$7722,v$7723){lab$rl: while (true) {if (v$7722 >= 0) {var t$8033 = SmlPrims.chk_ovf_i32(v$7722 - 1);
var t$8030;
var v$7032 = v$3517.charCodeAt(v$7722);
var t$8032;
var t$8031;
switch (v$7032) { case 32: {t$8031 = [9];
 break; }case 119: {t$8031 = [6];
 break; }case 61: {t$8031 = [5];
 break; }case 37: {t$8031 = [4];
 break; }case 77: {t$8031 = [13,mkFun$784(v$7722,v$7721,v$936)];
 break; }case 78: {t$8031 = [12,mkFun$784(v$7722,v$7721,v$936)];
 break; }case 97: {t$8031 = [1];
 break; }case 98: {t$8031 = [2];
 break; }case 99: {t$8031 = [0];
 break; }case 42: {t$8031 = [7];
 break; }case 72: {t$8031 = [10];
 break; }case 75: {t$8031 = [11];
 break; }case 79: {t$8031 = [3];
 break; }case 73: {t$8031 = [14];
 break; }case 84: {t$8031 = [8,1];
 break; }case 65: {t$8031 = [8,6];
 break; }case 80: {t$8031 = [8,3];
 break; }case 76: {t$8031 = [8,4];
 break; }case 68: {t$8031 = [8,5];
 break; }case 83: {t$8031 = [8,2];
 break; }case 85: {t$8031 = [8,0];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,("unknown character '" + (h8UYb53cympluUQFSuaSASi$3basis$0Char$1.toString$275(v$7032))) + "' in map"];
} };
t$8032 = [t$8031,v$7723];
t$8030 = t$8032;
var t$8034 = t$8033;
var t$8035 = t$8030;
var v$7722 = t$8034;
var v$7723 = t$8035;
continue lab$rl;
} else {return v$7723;
};
};
};
var rl$7028 = fix$8029.$rl;
t$8028 = (rl$7028(start$7027,e$7026));
t$8036 = [t$8028,v$7720];
t$8037 = t$8036;
var t$8039 = t$8038;
var t$8040 = t$8037;
var t$8041 = v$7865;
var v$7719 = t$8039;
var v$7720 = t$8040;
var v$7721 = t$8041;
continue lab$loop;
};
};
};
var loop$3511 = fix$8027.$loop;
t$8042 = (loop$3511(v$935,null,0));
t$8044 = (t$8043(t$8042));
return [t$8044,dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.map$695(function(v$931){return v$931[0];
},v$936)];
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.findClosestDisplay$937 = function(v$7730,v$7731){var displays$3551 = dsps$920[0];
var dists$3552 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.map$695(function(v$3553){var v$3554 = v$3553[0];
var v$3555 = v$3553[1];
var v$3556 = v$3553[2];
var t$8049 = v$3554;
var t$8048;
var t$8047;
var t$8046;
var r$3563 = SmlPrims.chk_ovf_i32(v$3555 - v$7730);
t$8046 = (r$3563 * r$3563);
var t$8045;
var r$3564 = SmlPrims.chk_ovf_i32(v$3556 - v$7731);
t$8045 = (r$3564 * r$3564);
t$8047 = (t$8046 + t$8045);
t$8048 = (Math.sqrt(t$8047));
return [t$8049,t$8048];
},displays$3551);
var v$3565;
var fix$8050 = {};
fix$8050.$mini = function(v$3567,v$3568){lab$mini: while (true) {switch (v$3567[0]) { case 1: {if (v$3568 == null) {return v$3567;
} else {var v$3569 = v$3568;
var t$8051 = [0,v$3569[0]];
var t$8052 = v$3569[1];
var v$3567 = t$8051;
var v$3568 = t$8052;
continue lab$mini;
};
 break; }default: {if (v$3568 == null) {return v$3567;
} else {var v$3572 = v$3567[1];
var v$3573 = v$3572[1];
var v$3574 = v$3568;
var v$3575 = v$3574[0];
var v$3576 = v$3575[0];
var v$3577 = v$3575[1];
var v$3578 = v$3574[1];
if (v$3577 < v$3573) {var t$8053 = [0,[v$3576,v$3577]];
var t$8054 = v$3578;
var v$3567 = t$8053;
var v$3568 = t$8054;
continue lab$mini;
} else {var t$8055 = v$3567;
var t$8056 = v$3578;
var v$3567 = t$8055;
var v$3568 = t$8056;
continue lab$mini;
};
};
} };
};
};
var mini$3566 = fix$8050.$mini;
v$3565 = (mini$3566([1],dists$3552));
switch (v$3565[0]) { case 0: {var v$3579 = v$3565[1];
var v$3580 = v$3579[0];
return [0,v$3580];
 break; }default: {return [1];
} };
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.findDisplayState$944 = function(displayContent$947,sid$950){return dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$955){return sid$950 == v$955[1];
},displayContent$947);
};
var screenWidth$959 = ((((function(){return window.innerWidth;})()) <= 1000)?(((function(){return window.innerHeight;})()) <= 1000):false)?((function(){return window.innerWidth;})()):(SmlPrims.div_i32(1600,2,CompilerInitial.exn$Div$45));
var screenHeight$964 = ((((function(){return window.innerWidth;})()) <= 1000)?(((function(){return window.innerHeight;})()) <= 1000):false)?((function(){return window.innerHeight;})()):(SmlPrims.div_i32(900,2,CompilerInitial.exn$Div$45));
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<html><head>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<title>Canvas example</title>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<link rel='shortcut icon' type='image/x-icon' href='favicon.ico' />\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<style>\n");
if (((((function(){return window.innerWidth;})()) <= 1000)?(((function(){return window.innerHeight;})()) <= 1000):false)?false:true) {EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("div#minimapcontainer { display : flex; justify-content : center; align-items : center; margin: 10px;}\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161((("canvas#minimap { position : absolute; width : " + ((screenWidth$959 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(screenWidth$959))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(screenWidth$959)))) + "px; }") + "\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161((("canvas#minimapobjects { position : absolute; width : " + ((screenWidth$959 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(screenWidth$959))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(screenWidth$959)))) + "px; }") + "\n");
} else {0;
};
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("div#floor { position : absolute; width : 100%; height : 100%; background-color : rgb(128,128,128); z-index : -10000000; }\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("div#ceiling { position : absolute; width : 100%; height : 50%; background-color : rgb(96,96,96); z-index : -10000000; }\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161((((("#screen { position : relative; width : " + ((screenWidth$959 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(screenWidth$959))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(screenWidth$959)))) + "px; height : ") + ((screenHeight$964 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(screenHeight$964))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(screenHeight$964)))) + "px; border : 0px; overflow : hidden; }") + "\n");
var t$8065 = EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161;
var t$8064;
var t$8063;
var t$8062;
var t$8061;
var t$8060;
var t$8059 = "div#overlay { position : absolute; display : block; width : ";
var t$8058;
var i$3638 = SmlPrims.chk_ovf_i32(screenWidth$959 - 10);
t$8058 = ((i$3638 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(i$3638))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(i$3638)));
t$8060 = (t$8059 + t$8058);
t$8061 = (t$8060 + "px; height : ");
var t$8057;
var i$3640 = SmlPrims.chk_ovf_i32(screenHeight$964 - 10);
t$8057 = ((i$3640 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(i$3640))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(i$3640)));
t$8062 = (t$8061 + t$8057);
t$8063 = (t$8062 + "px; padding : 5px; color : white; font-family : lucida console, courier new; font-size : 20px; z-index : 1; }");
t$8064 = (t$8063 + "\n");
t$8065(t$8064);
((((function(){return window.innerWidth;})()) <= 1000)?(((function(){return window.innerHeight;})()) <= 1000):false)?(EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("html, body {margin: 0; height: 100%; overflow: hidden}\n")):0;
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("</style>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("</head><body><center>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<div id='screen'>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<div id='floor'></div>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<div id='ceiling'></div>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<div id='overlay'></div>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("</div>\n");
if (((((function(){return window.innerWidth;})()) <= 1000)?(((function(){return window.innerHeight;})()) <= 1000):false)?false:true) {EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<div id='minimapcontainer'>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<canvas id='minimap'></canvas>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<canvas id='minimapobjects'></canvas>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("</div>\n");
} else {0;
};
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<div id='log'></div>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("</center></body></html>\n");
var v$2699;
try {var t$8072 = h9AP67nN46MQi5f2NQrocNd$3university$0university$1.load$921;
var t$8071;
var file$3674;
var t$8070 = "data/gameMap.txt?_=";
var t$8069;
var t$8068 = y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.toString$158;
var t$8067;
var v$3677 = SmlPrims.getrealtime();
var v$3678 = v$3677[0];
var v$3679 = v$3677[1];
t$8067 = ((v$3678 - (-2147483648)) + (v$3679 / 1000000.0));
t$8069 = (t$8068(t$8067));
file$3674 = (t$8070 + t$8069);
var r$3680 = SmlPrims.newRequest();
(function(r,m,u,a){return r.open(m,u,a);})(r$3680,"GET",file$3674,false);
z11cymP27JOrM6FBeJkkje$3js$0Js$1.send$652(r$3680,[1]);
var v$3683 = (function(r){return SmlPrims.option(r.responseText);})(r$3680);
switch (v$3683[0]) { case 0: {t$8071 = v$3683[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"serverGet failed on file " + file$3674];
} };
v$2699 = (t$8072(t$8071));
} catch(v$8066) {v$2699 = ((function(exn$2706){var t$8073 = exn$2706;
if (t$8073[0] == sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52) {var msg$2703 = exn$2706[1];
var log$3686;
var v$3688 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"log");
switch (v$3688[0]) { case 0: {log$3686 = v$3688[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'log' in DOM"];
} };
(function(e,a){return e.appendChild(a);})(log$3686,document.createTextNode(msg$2703));
(function(e,a){return e.appendChild(a);})(log$3686,document.createElement("br"));
throw exn$2706;
} else {throw exn$2706;
};
})(v$8066));
};
var v$2700 = v$2699[0];
var v$2701 = v$2699[1];
var init$1072 = function(items$1075){var screen$1076;
var v$3717 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"screen");
switch (v$3717[0]) { case 0: {screen$1076 = v$3717[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'screen' in DOM"];
} };
v$2700[0][0];
var v$7408 = v$2700[0][1];
var v$7409 = v$2700[0][2];
if ((0 <= v$7408)?(v$7408 <= 123456789):false) {0;
} else {throw CompilerInitial.exn$Size$51;
};
var spriteMap$1080;
var v$6164 = [1];
var t$8081;
var t$8074;
var t$3727 = Array(v$7408);
var fix$8075 = {};
fix$8075.$init = function(v$7732,v$7733){lab$init: while (true) {if (v$7733 >= v$7408) {return 0;
} else {var t$8078 = v$7732;
var t$8077 = v$7733;
var t$8076;
if ((0 <= v$7409)?(v$7409 <= 123456789):false) {0;
} else {throw CompilerInitial.exn$Size$51;
};
t$8076 = (SmlPrims.wordTableInit(v$7409,v$6164));
(t$8078[t$8077] = t$8076,0);
var t$8079 = v$7732;
var t$8080 = SmlPrims.chk_ovf_i32(v$7733 + 1);
var v$7732 = t$8079;
var v$7733 = t$8080;
continue lab$init;
};
};
};
var init$3728 = fix$8075.$init;
init$3728(t$3727,0);
t$8074 = t$3727;
t$8081 = [t$8074,v$7408,v$7409];
spriteMap$1080 = [t$8081];
var fix$8082 = {};
fix$8082.$app = function(v$3746){lab$app: while (true) {if (v$3746 == null) {return 0;
} else {var v$3747 = v$3746;
var v$3748 = v$3747[0];
var v$3749 = v$3747[1];
var v$3783 = v$3748[0];
var v$3784 = v$3748[1];
var v$3785 = v$3748[2];
var s$3786;
var pos$3788 = [v$3784,v$3785];
var e$3789 = document.createElement("img");
var t$8085 = e$3789;
var t$8084 = "src";
var t$8083;
switch (v$3783) { case 1: {t$8083 = "tablechairs.png";
 break; }case 6: {t$8083 = (("professor" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32((SmlPrims.mod_i32(SmlPrims.chk_ovf_i32(pos$3788[0] + pos$3788[1]),4,CompilerInitial.exn$Div$45)) + 1)))) + ".gif");
 break; }case 3: {t$8083 = "plantgreen.png";
 break; }case 4: {t$8083 = "lamp.png";
 break; }case 2: {t$8083 = "sink.png";
 break; }case 5: {t$8083 = "desk.png";
 break; }default: {t$8083 = "toilet.png";
} };
(function(fp,s,v){fp[s] = v;})(t$8085,t$8084,t$8083);
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(e$3789,"style"),"display","none");
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(e$3789,"style"),"position","absolute");
var v$3792;
switch (v$3783) { case 1: {v$3792 = true;
 break; }case 6: {v$3792 = true;
 break; }case 3: {v$3792 = true;
 break; }case 4: {v$3792 = false;
 break; }case 2: {v$3792 = false;
 break; }case 5: {v$3792 = true;
 break; }default: {v$3792 = true;
} };
var v$3793 = [false];
s$3786 = [v$3792,[true],e$3789,pos$3788,v$3793];
var v$6172 = [0,s$3786];
var v$3796 = spriteMap$1080[0][0];
spriteMap$1080[0][1];
spriteMap$1080[0][2];
var v$3798 = v$3796.length;
if ((0 <= v$3785)?(v$3785 < v$3798):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$3801 = v$3796[v$3785];
var v$3802 = v$3801.length;
if ((0 <= v$3784)?(v$3784 < v$3802):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
(v$3801[v$3784] = v$6172,0);
(function(e,a){return e.appendChild(a);})(screen$1076,s$3786[2]);
var t$8086 = v$3749;
var v$3746 = t$8086;
continue lab$app;
};
};
};
var app$3745 = fix$8082.$app;
app$3745(items$1075);
return spriteMap$1080;
};
var MaxRotSpeed$1131 = (3.0 * 3.14159265358979323846) / 360.0;
var player$1132;
var v$1133 = [16.0];
var v$1134 = [10.0];
var v$1135 = [0.0];
var v$1136 = [0.0];
var v$1137 = [0.0];
player$1132 = [0.10,v$1135,[0.0],v$1137,v$1136,v$1133,v$1134];
var fov$1140 = (60.0 * 3.14159265358979323846) / 180.0;
var fovHalf$1141 = fov$1140 / 2.0;
var twoPI$1142 = 3.14159265358979323846 * 2.0;
var stripWidthR$1144 = 1;
var miniMapScaleR$1146 = 8;
v$2700[0][0];
v$2700[0][1];
var mapWidth$1148 = v$2700[0][2];
var mapWidthR$1149 = mapWidth$1148;
v$2700[0][0];
var mapHeight$1150;
var v$3816 = v$2700[0][1];
v$2700[0][2];
mapHeight$1150 = v$3816;
var mapHeightR$1151 = mapHeight$1150;
var screenWidthR$1152 = screenWidth$959;
var screenHeightR$1153 = screenHeight$964;
var numRays$1154 = SmlPrims.chk_ovf_i32(Math.ceil(screenWidthR$1152 / stripWidthR$1144));
var viewDist$1155 = (screenWidthR$1152 / 2.0) / ((Math.sin(fovHalf$1141)) / (Math.cos(fovHalf$1141)));
var bindKeys$1174 = function(staff$1177,displayContent$1180){var startSpeak$1181 = function(v$7736,v$7737,v$7738){var base$1185 = v$7738[0];
var idx$1186 = v$7737[0];
var src$1190;
var t$8091;
var t$8090 = ((((("data/" + v$7736) + "/") + base$1185) + "/") + base$1185) + "-";
var t$8089;
var fix$8087 = {};
fix$8087.$prefixzeros = function(s$7036){lab$prefixzeros: while (true) {if (s$7036.length < 3) {var t$8088 = "0" + s$7036;
var s$7036 = t$8088;
continue lab$prefixzeros;
} else {return s$7036;
};
};
};
var prefixzeros$7035 = fix$8087.$prefixzeros;
t$8089 = (prefixzeros$7035(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(idx$1186)));
t$8091 = (t$8090 + t$8089);
src$1190 = (t$8091 + ".txt");
var file$3861;
var t$8095 = src$1190 + "?_=";
var t$8094;
var t$8093 = y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.toString$158;
var t$8092;
var v$3864 = SmlPrims.getrealtime();
var v$3865 = v$3864[0];
var v$3866 = v$3864[1];
t$8092 = ((v$3865 - (-2147483648)) + (v$3866 / 1000000.0));
t$8094 = (t$8093(t$8092));
file$3861 = (t$8095 + t$8094);
var r$3867 = SmlPrims.newRequest();
(function(r,m,u,a){return r.open(m,u,a);})(r$3867,"GET",file$3861,true);
(function(r,f){r.onreadystatechange = f;})(r$3867,function(v$3872){var v$3873 = (function(r){return SmlPrims.option(r.status);})(r$3867);
switch (v$3873[0]) { case 0: {switch (v$3873[1]) { case 200: {var v$3874 = (function(r){return SmlPrims.option(r.responseText);})(r$3867);
switch (v$3874[0]) { case 0: {var v$7039 = [0,v$3874[1]];
var v$7043 = v$7039[1];
var synth$7045 = (function(){return window.speechSynthesis;})();
(function(synth){synth.cancel();})(synth$7045);
(function(){window.utterances = [];})();
var msg$7046 = (function(txt){return new SpeechSynthesisUtterance(txt);})(v$7043);
(function(u){window.utterances.push(u);})(msg$7046);
(function(fp,s,v){fp[s] = v;})(msg$7046,"lang","en-GB");
return (function(synth,msg){synth.speak(msg);})(synth$7045,msg$7046);
 break; }default: {var synth$7049 = (function(){return window.speechSynthesis;})();
(function(synth){synth.cancel();})(synth$7049);
(function(){window.utterances = [];})();
var msg$7050 = (function(txt){return new SpeechSynthesisUtterance(txt);})("");
(function(u){window.utterances.push(u);})(msg$7050);
(function(fp,s,v){fp[s] = v;})(msg$7050,"lang","en-GB");
return (function(synth,msg){synth.speak(msg);})(synth$7049,msg$7050);
} };
 break; }default: {var synth$7057 = (function(){return window.speechSynthesis;})();
(function(synth){synth.cancel();})(synth$7057);
(function(){window.utterances = [];})();
var msg$7058 = (function(txt){return new SpeechSynthesisUtterance(txt);})("");
(function(u){window.utterances.push(u);})(msg$7058);
(function(fp,s,v){fp[s] = v;})(msg$7058,"lang","en-GB");
return (function(synth,msg){synth.speak(msg);})(synth$7057,msg$7058);
} };
 break; }default: {return 0;
} };
});
z11cymP27JOrM6FBeJkkje$3js$0Js$1.send$652(r$3867,[1]);
return 0;
};
(function(f){document.onkeydown = function(e) { e = e || window.event; f(e.keyCode); };})(function(v$1297){switch (v$1297) { case 38: {return (player$1132[4][0] = 1.0,0);
 break; }case 40: {return (player$1132[4][0] = (-1.0),0);
 break; }case 37: {var rotAcc$1307 = player$1132[2];
return (rotAcc$1307[0] > (-0.5))?(rotAcc$1307[0] = (rotAcc$1307[0] - 0.1),0):0;
 break; }case 39: {var rotAcc$1298 = player$1132[2];
return (rotAcc$1298[0] < 0.5)?(rotAcc$1298[0] = (rotAcc$1298[0] + 0.1),0):0;
 break; }case 112: {var x$4005 = SmlPrims.chk_ovf_i32(Math.floor(player$1132[5][0]));
var y$4006 = SmlPrims.chk_ovf_i32(Math.floor(player$1132[6][0]));
var v$4007;
var displays$4011 = dsps$920[0];
var dists$4012 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.map$695(function(v$4013){var v$4014 = v$4013[0];
var v$4015 = v$4013[1];
var v$4016 = v$4013[2];
var t$8204 = v$4014;
var t$8203;
var t$8202;
var t$8201;
var r$4017 = SmlPrims.chk_ovf_i32(v$4015 - x$4005);
t$8201 = (r$4017 * r$4017);
var t$8200;
var r$4018 = SmlPrims.chk_ovf_i32(v$4016 - y$4006);
t$8200 = (r$4018 * r$4018);
t$8202 = (t$8201 + t$8200);
t$8203 = (Math.sqrt(t$8202));
return [t$8204,t$8203];
},displays$4011);
var v$4019;
var fix$8205 = {};
fix$8205.$mini = function(v$4021,v$4022){lab$mini: while (true) {switch (v$4021[0]) { case 1: {if (v$4022 == null) {return v$4021;
} else {var v$4023 = v$4022;
var t$8206 = [0,v$4023[0]];
var t$8207 = v$4023[1];
var v$4021 = t$8206;
var v$4022 = t$8207;
continue lab$mini;
};
 break; }default: {if (v$4022 == null) {return v$4021;
} else {var v$4026 = v$4021[1];
var v$4027 = v$4026[1];
var v$4028 = v$4022;
var v$4029 = v$4028[0];
var v$4030 = v$4029[0];
var v$4031 = v$4029[1];
var v$4032 = v$4028[1];
if (v$4031 < v$4027) {var t$8208 = [0,[v$4030,v$4031]];
var t$8209 = v$4032;
var v$4021 = t$8208;
var v$4022 = t$8209;
continue lab$mini;
} else {var t$8210 = v$4021;
var t$8211 = v$4032;
var v$4021 = t$8210;
var v$4022 = t$8211;
continue lab$mini;
};
};
} };
};
};
var mini$4020 = fix$8205.$mini;
v$4019 = (mini$4020([1],dists$4012));
switch (v$4019[0]) { case 0: {var v$4033 = v$4019[1];
var v$4034 = v$4033[0];
v$4007 = [0,v$4034];
 break; }default: {v$4007 = [1];
} };
switch (v$4007[0]) { case 1: {return 0;
 break; }default: {var v$4035 = v$4007[1];
var v$4036 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$4039){return v$4035 == v$4039[1];
},displayContent$1180);
switch (v$4036[0]) { case 1: {return 0;
 break; }default: {var v$4043 = v$4036[1];
var v$7064 = v$4043[1];
var v$7065 = v$4043[2];
var v$7066 = v$4043[0];
var did$7067 = v$7066[0];
var v$7068;
var v$7069 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$7070){return v$7070[1] == v$7064;
},staff$1177);
switch (v$7069[0]) { case 1: {v$7068 = [1];
 break; }default: {var v$7071 = v$7069[1];
var v$7072 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$7074){return v$7074[0] == did$7067;
},v$7071[4]);
switch (v$7072[0]) { case 1: {v$7068 = [1];
 break; }default: {v$7068 = [0,v$7072[1][2]];
} };
} };
switch (v$7068[0]) { case 0: {var v$7075 = v$7068[1];
(v$7065[0] = (SmlPrims.mod_i32(SmlPrims.chk_ovf_i32((SmlPrims.chk_ovf_i32(v$7065[0] - 1)) + v$7075),v$7075,CompilerInitial.exn$Div$45)),0);
 break; }default: {0;
} };
return startSpeak$1181(v$4043[1],v$4043[2],v$4043[0]);
} };
} };
 break; }case 80: {var x$4069 = SmlPrims.chk_ovf_i32(Math.floor(player$1132[5][0]));
var y$4070 = SmlPrims.chk_ovf_i32(Math.floor(player$1132[6][0]));
var v$4071;
var displays$4075 = dsps$920[0];
var dists$4076 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.map$695(function(v$4077){var v$4078 = v$4077[0];
var v$4079 = v$4077[1];
var v$4080 = v$4077[2];
var t$8192 = v$4078;
var t$8191;
var t$8190;
var t$8189;
var r$4081 = SmlPrims.chk_ovf_i32(v$4079 - x$4069);
t$8189 = (r$4081 * r$4081);
var t$8188;
var r$4082 = SmlPrims.chk_ovf_i32(v$4080 - y$4070);
t$8188 = (r$4082 * r$4082);
t$8190 = (t$8189 + t$8188);
t$8191 = (Math.sqrt(t$8190));
return [t$8192,t$8191];
},displays$4075);
var v$4083;
var fix$8193 = {};
fix$8193.$mini = function(v$4085,v$4086){lab$mini: while (true) {switch (v$4085[0]) { case 1: {if (v$4086 == null) {return v$4085;
} else {var v$4087 = v$4086;
var t$8194 = [0,v$4087[0]];
var t$8195 = v$4087[1];
var v$4085 = t$8194;
var v$4086 = t$8195;
continue lab$mini;
};
 break; }default: {if (v$4086 == null) {return v$4085;
} else {var v$4090 = v$4085[1];
var v$4091 = v$4090[1];
var v$4092 = v$4086;
var v$4093 = v$4092[0];
var v$4094 = v$4093[0];
var v$4095 = v$4093[1];
var v$4096 = v$4092[1];
if (v$4095 < v$4091) {var t$8196 = [0,[v$4094,v$4095]];
var t$8197 = v$4096;
var v$4085 = t$8196;
var v$4086 = t$8197;
continue lab$mini;
} else {var t$8198 = v$4085;
var t$8199 = v$4096;
var v$4085 = t$8198;
var v$4086 = t$8199;
continue lab$mini;
};
};
} };
};
};
var mini$4084 = fix$8193.$mini;
v$4083 = (mini$4084([1],dists$4076));
switch (v$4083[0]) { case 0: {var v$4097 = v$4083[1];
var v$4098 = v$4097[0];
v$4071 = [0,v$4098];
 break; }default: {v$4071 = [1];
} };
switch (v$4071[0]) { case 1: {return 0;
 break; }default: {var v$4099 = v$4071[1];
var v$4100 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$4103){return v$4099 == v$4103[1];
},displayContent$1180);
switch (v$4100[0]) { case 1: {return 0;
 break; }default: {var v$4107 = v$4100[1];
var v$7077 = v$4107[1];
var v$7078 = v$4107[2];
var v$7079 = v$4107[0];
var did$7080 = v$7079[0];
var v$7081;
var v$7082 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$7083){return v$7083[1] == v$7077;
},staff$1177);
switch (v$7082[0]) { case 1: {v$7081 = [1];
 break; }default: {var v$7084 = v$7082[1];
var v$7085 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$7087){return v$7087[0] == did$7080;
},v$7084[4]);
switch (v$7085[0]) { case 1: {v$7081 = [1];
 break; }default: {v$7081 = [0,v$7085[1][2]];
} };
} };
switch (v$7081[0]) { case 0: {var v$7088 = v$7081[1];
(v$7078[0] = (SmlPrims.mod_i32(SmlPrims.chk_ovf_i32((SmlPrims.chk_ovf_i32(v$7078[0] - 1)) + v$7088),v$7088,CompilerInitial.exn$Div$45)),0);
 break; }default: {0;
} };
return startSpeak$1181(v$4107[1],v$4107[2],v$4107[0]);
} };
} };
 break; }case 110: {var x$4133 = SmlPrims.chk_ovf_i32(Math.floor(player$1132[5][0]));
var y$4134 = SmlPrims.chk_ovf_i32(Math.floor(player$1132[6][0]));
var v$4135;
var displays$4139 = dsps$920[0];
var dists$4140 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.map$695(function(v$4141){var v$4142 = v$4141[0];
var v$4143 = v$4141[1];
var v$4144 = v$4141[2];
var t$8180 = v$4142;
var t$8179;
var t$8178;
var t$8177;
var r$4145 = SmlPrims.chk_ovf_i32(v$4143 - x$4133);
t$8177 = (r$4145 * r$4145);
var t$8176;
var r$4146 = SmlPrims.chk_ovf_i32(v$4144 - y$4134);
t$8176 = (r$4146 * r$4146);
t$8178 = (t$8177 + t$8176);
t$8179 = (Math.sqrt(t$8178));
return [t$8180,t$8179];
},displays$4139);
var v$4147;
var fix$8181 = {};
fix$8181.$mini = function(v$4149,v$4150){lab$mini: while (true) {switch (v$4149[0]) { case 1: {if (v$4150 == null) {return v$4149;
} else {var v$4151 = v$4150;
var t$8182 = [0,v$4151[0]];
var t$8183 = v$4151[1];
var v$4149 = t$8182;
var v$4150 = t$8183;
continue lab$mini;
};
 break; }default: {if (v$4150 == null) {return v$4149;
} else {var v$4154 = v$4149[1];
var v$4155 = v$4154[1];
var v$4156 = v$4150;
var v$4157 = v$4156[0];
var v$4158 = v$4157[0];
var v$4159 = v$4157[1];
var v$4160 = v$4156[1];
if (v$4159 < v$4155) {var t$8184 = [0,[v$4158,v$4159]];
var t$8185 = v$4160;
var v$4149 = t$8184;
var v$4150 = t$8185;
continue lab$mini;
} else {var t$8186 = v$4149;
var t$8187 = v$4160;
var v$4149 = t$8186;
var v$4150 = t$8187;
continue lab$mini;
};
};
} };
};
};
var mini$4148 = fix$8181.$mini;
v$4147 = (mini$4148([1],dists$4140));
switch (v$4147[0]) { case 0: {var v$4161 = v$4147[1];
var v$4162 = v$4161[0];
v$4135 = [0,v$4162];
 break; }default: {v$4135 = [1];
} };
switch (v$4135[0]) { case 1: {return 0;
 break; }default: {var v$4163 = v$4135[1];
var v$4164 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$4167){return v$4163 == v$4167[1];
},displayContent$1180);
switch (v$4164[0]) { case 1: {return 0;
 break; }default: {var v$4171 = v$4164[1];
var v$7090 = v$4171[1];
var v$7091 = v$4171[2];
var v$7092 = v$4171[0];
var did$7093 = v$7092[0];
var v$7094;
var v$7095 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$7096){return v$7096[1] == v$7090;
},staff$1177);
switch (v$7095[0]) { case 1: {v$7094 = [1];
 break; }default: {var v$7097 = v$7095[1];
var v$7098 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$7100){return v$7100[0] == did$7093;
},v$7097[4]);
switch (v$7098[0]) { case 1: {v$7094 = [1];
 break; }default: {v$7094 = [0,v$7098[1][2]];
} };
} };
switch (v$7094[0]) { case 0: {var v$7101 = v$7094[1];
(v$7091[0] = (SmlPrims.mod_i32(SmlPrims.chk_ovf_i32(v$7091[0] + 1),v$7101,CompilerInitial.exn$Div$45)),0);
 break; }default: {0;
} };
return startSpeak$1181(v$4171[1],v$4171[2],v$4171[0]);
} };
} };
 break; }case 78: {var x$4197 = SmlPrims.chk_ovf_i32(Math.floor(player$1132[5][0]));
var y$4198 = SmlPrims.chk_ovf_i32(Math.floor(player$1132[6][0]));
var v$4199;
var displays$4203 = dsps$920[0];
var dists$4204 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.map$695(function(v$4205){var v$4206 = v$4205[0];
var v$4207 = v$4205[1];
var v$4208 = v$4205[2];
var t$8168 = v$4206;
var t$8167;
var t$8166;
var t$8165;
var r$4209 = SmlPrims.chk_ovf_i32(v$4207 - x$4197);
t$8165 = (r$4209 * r$4209);
var t$8164;
var r$4210 = SmlPrims.chk_ovf_i32(v$4208 - y$4198);
t$8164 = (r$4210 * r$4210);
t$8166 = (t$8165 + t$8164);
t$8167 = (Math.sqrt(t$8166));
return [t$8168,t$8167];
},displays$4203);
var v$4211;
var fix$8169 = {};
fix$8169.$mini = function(v$4213,v$4214){lab$mini: while (true) {switch (v$4213[0]) { case 1: {if (v$4214 == null) {return v$4213;
} else {var v$4215 = v$4214;
var t$8170 = [0,v$4215[0]];
var t$8171 = v$4215[1];
var v$4213 = t$8170;
var v$4214 = t$8171;
continue lab$mini;
};
 break; }default: {if (v$4214 == null) {return v$4213;
} else {var v$4218 = v$4213[1];
var v$4219 = v$4218[1];
var v$4220 = v$4214;
var v$4221 = v$4220[0];
var v$4222 = v$4221[0];
var v$4223 = v$4221[1];
var v$4224 = v$4220[1];
if (v$4223 < v$4219) {var t$8172 = [0,[v$4222,v$4223]];
var t$8173 = v$4224;
var v$4213 = t$8172;
var v$4214 = t$8173;
continue lab$mini;
} else {var t$8174 = v$4213;
var t$8175 = v$4224;
var v$4213 = t$8174;
var v$4214 = t$8175;
continue lab$mini;
};
};
} };
};
};
var mini$4212 = fix$8169.$mini;
v$4211 = (mini$4212([1],dists$4204));
switch (v$4211[0]) { case 0: {var v$4225 = v$4211[1];
var v$4226 = v$4225[0];
v$4199 = [0,v$4226];
 break; }default: {v$4199 = [1];
} };
switch (v$4199[0]) { case 1: {return 0;
 break; }default: {var v$4227 = v$4199[1];
var v$4228 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$4231){return v$4227 == v$4231[1];
},displayContent$1180);
switch (v$4228[0]) { case 1: {return 0;
 break; }default: {var v$4235 = v$4228[1];
var v$7103 = v$4235[1];
var v$7104 = v$4235[2];
var v$7105 = v$4235[0];
var did$7106 = v$7105[0];
var v$7107;
var v$7108 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$7109){return v$7109[1] == v$7103;
},staff$1177);
switch (v$7108[0]) { case 1: {v$7107 = [1];
 break; }default: {var v$7110 = v$7108[1];
var v$7111 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$7113){return v$7113[0] == did$7106;
},v$7110[4]);
switch (v$7111[0]) { case 1: {v$7107 = [1];
 break; }default: {v$7107 = [0,v$7111[1][2]];
} };
} };
switch (v$7107[0]) { case 0: {var v$7114 = v$7107[1];
(v$7104[0] = (SmlPrims.mod_i32(SmlPrims.chk_ovf_i32(v$7104[0] + 1),v$7114,CompilerInitial.exn$Div$45)),0);
 break; }default: {0;
} };
return startSpeak$1181(v$4235[1],v$4235[2],v$4235[0]);
} };
} };
 break; }case 32: {var x$4261 = SmlPrims.chk_ovf_i32(Math.floor(player$1132[5][0]));
var y$4262 = SmlPrims.chk_ovf_i32(Math.floor(player$1132[6][0]));
var v$4263;
var displays$4267 = dsps$920[0];
var dists$4268 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.map$695(function(v$4269){var v$4270 = v$4269[0];
var v$4271 = v$4269[1];
var v$4272 = v$4269[2];
var t$8156 = v$4270;
var t$8155;
var t$8154;
var t$8153;
var r$4273 = SmlPrims.chk_ovf_i32(v$4271 - x$4261);
t$8153 = (r$4273 * r$4273);
var t$8152;
var r$4274 = SmlPrims.chk_ovf_i32(v$4272 - y$4262);
t$8152 = (r$4274 * r$4274);
t$8154 = (t$8153 + t$8152);
t$8155 = (Math.sqrt(t$8154));
return [t$8156,t$8155];
},displays$4267);
var v$4275;
var fix$8157 = {};
fix$8157.$mini = function(v$4277,v$4278){lab$mini: while (true) {switch (v$4277[0]) { case 1: {if (v$4278 == null) {return v$4277;
} else {var v$4279 = v$4278;
var t$8158 = [0,v$4279[0]];
var t$8159 = v$4279[1];
var v$4277 = t$8158;
var v$4278 = t$8159;
continue lab$mini;
};
 break; }default: {if (v$4278 == null) {return v$4277;
} else {var v$4282 = v$4277[1];
var v$4283 = v$4282[1];
var v$4284 = v$4278;
var v$4285 = v$4284[0];
var v$4286 = v$4285[0];
var v$4287 = v$4285[1];
var v$4288 = v$4284[1];
if (v$4287 < v$4283) {var t$8160 = [0,[v$4286,v$4287]];
var t$8161 = v$4288;
var v$4277 = t$8160;
var v$4278 = t$8161;
continue lab$mini;
} else {var t$8162 = v$4277;
var t$8163 = v$4288;
var v$4277 = t$8162;
var v$4278 = t$8163;
continue lab$mini;
};
};
} };
};
};
var mini$4276 = fix$8157.$mini;
v$4275 = (mini$4276([1],dists$4268));
switch (v$4275[0]) { case 0: {var v$4289 = v$4275[1];
var v$4290 = v$4289[0];
v$4263 = [0,v$4290];
 break; }default: {v$4263 = [1];
} };
switch (v$4263[0]) { case 1: {return 0;
 break; }default: {var v$4291 = v$4263[1];
var v$4292 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$4295){return v$4291 == v$4295[1];
},displayContent$1180);
switch (v$4292[0]) { case 1: {return 0;
 break; }default: {var v$4299 = v$4292[1];
var v$7116 = v$4299[1];
var v$7117 = v$4299[2];
var v$7118 = v$4299[0];
var did$7119 = v$7118[0];
var v$7120;
var v$7121 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$7122){return v$7122[1] == v$7116;
},staff$1177);
switch (v$7121[0]) { case 1: {v$7120 = [1];
 break; }default: {var v$7123 = v$7121[1];
var v$7124 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$7126){return v$7126[0] == did$7119;
},v$7123[4]);
switch (v$7124[0]) { case 1: {v$7120 = [1];
 break; }default: {v$7120 = [0,v$7124[1][2]];
} };
} };
switch (v$7120[0]) { case 0: {var v$7127 = v$7120[1];
(v$7117[0] = (SmlPrims.mod_i32(SmlPrims.chk_ovf_i32(v$7117[0] + 1),v$7127,CompilerInitial.exn$Div$45)),0);
 break; }default: {0;
} };
return startSpeak$1181(v$4299[1],v$4299[2],v$4299[0]);
} };
} };
 break; }case 97: {var x$4325 = SmlPrims.chk_ovf_i32(Math.floor(player$1132[5][0]));
var y$4326 = SmlPrims.chk_ovf_i32(Math.floor(player$1132[6][0]));
var v$4327;
var displays$4331 = dsps$920[0];
var dists$4332 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.map$695(function(v$4333){var v$4334 = v$4333[0];
var v$4335 = v$4333[1];
var v$4336 = v$4333[2];
var t$8142 = v$4334;
var t$8141;
var t$8140;
var t$8139;
var r$4337 = SmlPrims.chk_ovf_i32(v$4335 - x$4325);
t$8139 = (r$4337 * r$4337);
var t$8138;
var r$4338 = SmlPrims.chk_ovf_i32(v$4336 - y$4326);
t$8138 = (r$4338 * r$4338);
t$8140 = (t$8139 + t$8138);
t$8141 = (Math.sqrt(t$8140));
return [t$8142,t$8141];
},displays$4331);
var v$4339;
var fix$8143 = {};
fix$8143.$mini = function(v$4341,v$4342){lab$mini: while (true) {switch (v$4341[0]) { case 1: {if (v$4342 == null) {return v$4341;
} else {var v$4343 = v$4342;
var t$8144 = [0,v$4343[0]];
var t$8145 = v$4343[1];
var v$4341 = t$8144;
var v$4342 = t$8145;
continue lab$mini;
};
 break; }default: {if (v$4342 == null) {return v$4341;
} else {var v$4346 = v$4341[1];
var v$4347 = v$4346[1];
var v$4348 = v$4342;
var v$4349 = v$4348[0];
var v$4350 = v$4349[0];
var v$4351 = v$4349[1];
var v$4352 = v$4348[1];
if (v$4351 < v$4347) {var t$8146 = [0,[v$4350,v$4351]];
var t$8147 = v$4352;
var v$4341 = t$8146;
var v$4342 = t$8147;
continue lab$mini;
} else {var t$8148 = v$4341;
var t$8149 = v$4352;
var v$4341 = t$8148;
var v$4342 = t$8149;
continue lab$mini;
};
};
} };
};
};
var mini$4340 = fix$8143.$mini;
v$4339 = (mini$4340([1],dists$4332));
switch (v$4339[0]) { case 0: {var v$4353 = v$4339[1];
var v$4354 = v$4353[0];
v$4327 = [0,v$4354];
 break; }default: {v$4327 = [1];
} };
switch (v$4327[0]) { case 1: {return 0;
 break; }default: {var v$4355 = v$4327[1];
var v$4356 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$4359){return v$4355 == v$4359[1];
},displayContent$1180);
switch (v$4356[0]) { case 1: {return 0;
 break; }default: {var v$4363 = v$4356[1];
var v$7129 = v$4363[1];
var v$7130 = v$4363[2];
var v$7131 = v$4363[0];
var v$7132 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$7133){return v$7133[1] == v$7129;
},staff$1177);
switch (v$7132[0]) { case 1: {0;
 break; }default: {var v$7134 = v$7132[1];
var v$7135 = v$7134[4];
var slides$7136 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.rev$680(v$7135);
var did$7137 = v$7131[0];
var fix$8150 = {};
fix$8150.$loop = function(v$7139){lab$loop: while (true) {if (v$7139 == null) {return (slides$7136 == null)?0:(v$7131[0] = slides$7136[0][0],0);
} else {var v$7140 = v$7139;
var v$7141 = v$7140[1];
if (v$7141 == null) {return (slides$7136 == null)?0:(v$7131[0] = slides$7136[0][0],0);
} else {var v$7142 = v$7140[0];
var v$7143 = v$7141;
var v$7144 = v$7143[0];
var v$7145 = v$7143[1];
if (v$7142[0] == did$7137) {return (v$7131[0] = v$7144[0],0);
} else {var t$8151 = [v$7144,v$7145];
var v$7139 = t$8151;
continue lab$loop;
};
};
};
};
};
var loop$7138 = fix$8150.$loop;
loop$7138(slides$7136);
(v$7130[0] = 0,0);
} };
return startSpeak$1181(v$4363[1],v$4363[2],v$4363[0]);
} };
} };
 break; }case 65: {var x$4400 = SmlPrims.chk_ovf_i32(Math.floor(player$1132[5][0]));
var y$4401 = SmlPrims.chk_ovf_i32(Math.floor(player$1132[6][0]));
var v$4402;
var displays$4406 = dsps$920[0];
var dists$4407 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.map$695(function(v$4408){var v$4409 = v$4408[0];
var v$4410 = v$4408[1];
var v$4411 = v$4408[2];
var t$8128 = v$4409;
var t$8127;
var t$8126;
var t$8125;
var r$4412 = SmlPrims.chk_ovf_i32(v$4410 - x$4400);
t$8125 = (r$4412 * r$4412);
var t$8124;
var r$4413 = SmlPrims.chk_ovf_i32(v$4411 - y$4401);
t$8124 = (r$4413 * r$4413);
t$8126 = (t$8125 + t$8124);
t$8127 = (Math.sqrt(t$8126));
return [t$8128,t$8127];
},displays$4406);
var v$4414;
var fix$8129 = {};
fix$8129.$mini = function(v$4416,v$4417){lab$mini: while (true) {switch (v$4416[0]) { case 1: {if (v$4417 == null) {return v$4416;
} else {var v$4418 = v$4417;
var t$8130 = [0,v$4418[0]];
var t$8131 = v$4418[1];
var v$4416 = t$8130;
var v$4417 = t$8131;
continue lab$mini;
};
 break; }default: {if (v$4417 == null) {return v$4416;
} else {var v$4421 = v$4416[1];
var v$4422 = v$4421[1];
var v$4423 = v$4417;
var v$4424 = v$4423[0];
var v$4425 = v$4424[0];
var v$4426 = v$4424[1];
var v$4427 = v$4423[1];
if (v$4426 < v$4422) {var t$8132 = [0,[v$4425,v$4426]];
var t$8133 = v$4427;
var v$4416 = t$8132;
var v$4417 = t$8133;
continue lab$mini;
} else {var t$8134 = v$4416;
var t$8135 = v$4427;
var v$4416 = t$8134;
var v$4417 = t$8135;
continue lab$mini;
};
};
} };
};
};
var mini$4415 = fix$8129.$mini;
v$4414 = (mini$4415([1],dists$4407));
switch (v$4414[0]) { case 0: {var v$4428 = v$4414[1];
var v$4429 = v$4428[0];
v$4402 = [0,v$4429];
 break; }default: {v$4402 = [1];
} };
switch (v$4402[0]) { case 1: {return 0;
 break; }default: {var v$4430 = v$4402[1];
var v$4431 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$4434){return v$4430 == v$4434[1];
},displayContent$1180);
switch (v$4431[0]) { case 1: {return 0;
 break; }default: {var v$4438 = v$4431[1];
var v$7147 = v$4438[1];
var v$7148 = v$4438[2];
var v$7149 = v$4438[0];
var v$7150 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$7151){return v$7151[1] == v$7147;
},staff$1177);
switch (v$7150[0]) { case 1: {0;
 break; }default: {var v$7152 = v$7150[1];
var v$7153 = v$7152[4];
var slides$7154 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.rev$680(v$7153);
var did$7155 = v$7149[0];
var fix$8136 = {};
fix$8136.$loop = function(v$7157){lab$loop: while (true) {if (v$7157 == null) {return (slides$7154 == null)?0:(v$7149[0] = slides$7154[0][0],0);
} else {var v$7158 = v$7157;
var v$7159 = v$7158[1];
if (v$7159 == null) {return (slides$7154 == null)?0:(v$7149[0] = slides$7154[0][0],0);
} else {var v$7160 = v$7158[0];
var v$7161 = v$7159;
var v$7162 = v$7161[0];
var v$7163 = v$7161[1];
if (v$7160[0] == did$7155) {return (v$7149[0] = v$7162[0],0);
} else {var t$8137 = [v$7162,v$7163];
var v$7157 = t$8137;
continue lab$loop;
};
};
};
};
};
var loop$7156 = fix$8136.$loop;
loop$7156(slides$7154);
(v$7148[0] = 0,0);
} };
return startSpeak$1181(v$4438[1],v$4438[2],v$4438[0]);
} };
} };
 break; }case 115: {var x$4475 = SmlPrims.chk_ovf_i32(Math.floor(player$1132[5][0]));
var y$4476 = SmlPrims.chk_ovf_i32(Math.floor(player$1132[6][0]));
var v$4477;
var displays$4481 = dsps$920[0];
var dists$4482 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.map$695(function(v$4483){var v$4484 = v$4483[0];
var v$4485 = v$4483[1];
var v$4486 = v$4483[2];
var t$8114 = v$4484;
var t$8113;
var t$8112;
var t$8111;
var r$4487 = SmlPrims.chk_ovf_i32(v$4485 - x$4475);
t$8111 = (r$4487 * r$4487);
var t$8110;
var r$4488 = SmlPrims.chk_ovf_i32(v$4486 - y$4476);
t$8110 = (r$4488 * r$4488);
t$8112 = (t$8111 + t$8110);
t$8113 = (Math.sqrt(t$8112));
return [t$8114,t$8113];
},displays$4481);
var v$4489;
var fix$8115 = {};
fix$8115.$mini = function(v$4491,v$4492){lab$mini: while (true) {switch (v$4491[0]) { case 1: {if (v$4492 == null) {return v$4491;
} else {var v$4493 = v$4492;
var t$8116 = [0,v$4493[0]];
var t$8117 = v$4493[1];
var v$4491 = t$8116;
var v$4492 = t$8117;
continue lab$mini;
};
 break; }default: {if (v$4492 == null) {return v$4491;
} else {var v$4496 = v$4491[1];
var v$4497 = v$4496[1];
var v$4498 = v$4492;
var v$4499 = v$4498[0];
var v$4500 = v$4499[0];
var v$4501 = v$4499[1];
var v$4502 = v$4498[1];
if (v$4501 < v$4497) {var t$8118 = [0,[v$4500,v$4501]];
var t$8119 = v$4502;
var v$4491 = t$8118;
var v$4492 = t$8119;
continue lab$mini;
} else {var t$8120 = v$4491;
var t$8121 = v$4502;
var v$4491 = t$8120;
var v$4492 = t$8121;
continue lab$mini;
};
};
} };
};
};
var mini$4490 = fix$8115.$mini;
v$4489 = (mini$4490([1],dists$4482));
switch (v$4489[0]) { case 0: {var v$4503 = v$4489[1];
var v$4504 = v$4503[0];
v$4477 = [0,v$4504];
 break; }default: {v$4477 = [1];
} };
switch (v$4477[0]) { case 1: {return 0;
 break; }default: {var v$4505 = v$4477[1];
var v$4506 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$4509){return v$4505 == v$4509[1];
},displayContent$1180);
switch (v$4506[0]) { case 1: {return 0;
 break; }default: {var v$4513 = v$4506[1];
var v$7165 = v$4513[1];
var v$7166 = v$4513[2];
var v$7167 = v$4513[0];
var v$7168 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$7169){return v$7169[1] == v$7165;
},staff$1177);
switch (v$7168[0]) { case 1: {0;
 break; }default: {var v$7170 = v$7168[1];
var v$7171 = v$7170[4];
var did$7172 = v$7167[0];
var fix$8122 = {};
fix$8122.$loop = function(v$7174){lab$loop: while (true) {if (v$7174 == null) {return (v$7171 == null)?0:(v$7167[0] = v$7171[0][0],0);
} else {var v$7175 = v$7174;
var v$7176 = v$7175[1];
if (v$7176 == null) {return (v$7171 == null)?0:(v$7167[0] = v$7171[0][0],0);
} else {var v$7177 = v$7175[0];
var v$7178 = v$7176;
var v$7179 = v$7178[0];
var v$7180 = v$7178[1];
if (v$7177[0] == did$7172) {return (v$7167[0] = v$7179[0],0);
} else {var t$8123 = [v$7179,v$7180];
var v$7174 = t$8123;
continue lab$loop;
};
};
};
};
};
var loop$7173 = fix$8122.$loop;
loop$7173(v$7171);
(v$7166[0] = 0,0);
} };
return startSpeak$1181(v$4513[1],v$4513[2],v$4513[0]);
} };
} };
 break; }case 83: {var x$4552 = SmlPrims.chk_ovf_i32(Math.floor(player$1132[5][0]));
var y$4553 = SmlPrims.chk_ovf_i32(Math.floor(player$1132[6][0]));
var v$4554;
var displays$4558 = dsps$920[0];
var dists$4559 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.map$695(function(v$4560){var v$4561 = v$4560[0];
var v$4562 = v$4560[1];
var v$4563 = v$4560[2];
var t$8100 = v$4561;
var t$8099;
var t$8098;
var t$8097;
var r$4564 = SmlPrims.chk_ovf_i32(v$4562 - x$4552);
t$8097 = (r$4564 * r$4564);
var t$8096;
var r$4565 = SmlPrims.chk_ovf_i32(v$4563 - y$4553);
t$8096 = (r$4565 * r$4565);
t$8098 = (t$8097 + t$8096);
t$8099 = (Math.sqrt(t$8098));
return [t$8100,t$8099];
},displays$4558);
var v$4566;
var fix$8101 = {};
fix$8101.$mini = function(v$4568,v$4569){lab$mini: while (true) {switch (v$4568[0]) { case 1: {if (v$4569 == null) {return v$4568;
} else {var v$4570 = v$4569;
var t$8102 = [0,v$4570[0]];
var t$8103 = v$4570[1];
var v$4568 = t$8102;
var v$4569 = t$8103;
continue lab$mini;
};
 break; }default: {if (v$4569 == null) {return v$4568;
} else {var v$4573 = v$4568[1];
var v$4574 = v$4573[1];
var v$4575 = v$4569;
var v$4576 = v$4575[0];
var v$4577 = v$4576[0];
var v$4578 = v$4576[1];
var v$4579 = v$4575[1];
if (v$4578 < v$4574) {var t$8104 = [0,[v$4577,v$4578]];
var t$8105 = v$4579;
var v$4568 = t$8104;
var v$4569 = t$8105;
continue lab$mini;
} else {var t$8106 = v$4568;
var t$8107 = v$4579;
var v$4568 = t$8106;
var v$4569 = t$8107;
continue lab$mini;
};
};
} };
};
};
var mini$4567 = fix$8101.$mini;
v$4566 = (mini$4567([1],dists$4559));
switch (v$4566[0]) { case 0: {var v$4580 = v$4566[1];
var v$4581 = v$4580[0];
v$4554 = [0,v$4581];
 break; }default: {v$4554 = [1];
} };
switch (v$4554[0]) { case 1: {return 0;
 break; }default: {var v$4582 = v$4554[1];
var v$4583 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$4586){return v$4582 == v$4586[1];
},displayContent$1180);
switch (v$4583[0]) { case 1: {return 0;
 break; }default: {var v$4590 = v$4583[1];
var v$7182 = v$4590[1];
var v$7183 = v$4590[2];
var v$7184 = v$4590[0];
var v$7185 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$7186){return v$7186[1] == v$7182;
},staff$1177);
switch (v$7185[0]) { case 1: {0;
 break; }default: {var v$7187 = v$7185[1];
var v$7188 = v$7187[4];
var did$7189 = v$7184[0];
var fix$8108 = {};
fix$8108.$loop = function(v$7191){lab$loop: while (true) {if (v$7191 == null) {return (v$7188 == null)?0:(v$7184[0] = v$7188[0][0],0);
} else {var v$7192 = v$7191;
var v$7193 = v$7192[1];
if (v$7193 == null) {return (v$7188 == null)?0:(v$7184[0] = v$7188[0][0],0);
} else {var v$7194 = v$7192[0];
var v$7195 = v$7193;
var v$7196 = v$7195[0];
var v$7197 = v$7195[1];
if (v$7194[0] == did$7189) {return (v$7184[0] = v$7196[0],0);
} else {var t$8109 = [v$7196,v$7197];
var v$7191 = t$8109;
continue lab$loop;
};
};
};
};
};
var loop$7190 = fix$8108.$loop;
loop$7190(v$7188);
(v$7183[0] = 0,0);
} };
return startSpeak$1181(v$4590[1],v$4590[2],v$4590[0]);
} };
} };
 break; }default: {return 0;
} };
});
(function(f){document.onkeyup = function(e) { e = e || window.event; f(e.keyCode); };})(function(v$1240){switch (v$1240) { case 38: {return (player$1132[4][0] = 0.0,0);
 break; }case 40: {return (player$1132[4][0] = 0.0,0);
 break; }case 37: {(player$1132[3][0] = 0.0,0);
return (player$1132[2][0] = 0.0,0);
 break; }case 39: {(player$1132[3][0] = 0.0,0);
return (player$1132[2][0] = 0.0,0);
 break; }default: {return 0;
} };
});
return 0;
};
var checkCollision$1375 = function(spriteMap$1378,v$7739,v$7740,v$7741,v$7742,v$7743){if ((v$7742 < 0.0)?true:((v$7742 >= mapHeightR$1151)?true:((v$7741 < 0.0)?true:(v$7741 >= mapWidthR$1149)))) {return [v$7739,v$7740];
} else {var blockX$1390 = SmlPrims.chk_ovf_i32(Math.floor(v$7741));
var blockY$1391 = SmlPrims.chk_ovf_i32(Math.floor(v$7742));
var t$8212;
if ((blockY$1391 < 0.0)?true:((blockY$1391 >= mapHeightR$1151)?true:((blockX$1390 < 0.0)?true:(blockX$1390 >= mapWidthR$1149)))) {t$8212 = true;
} else {var Y$7201 = SmlPrims.chk_ovf_i32(Math.floor(blockY$1391));
var X$7202 = SmlPrims.chk_ovf_i32(Math.floor(blockX$1390));
var wt$7203;
var v$7204 = v$2700[0][0];
v$2700[0][1];
v$2700[0][2];
var v$7205 = v$7204.length;
if ((0 <= Y$7201)?(Y$7201 < v$7205):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$7206 = v$7204[Y$7201];
var v$7207 = v$7206.length;
if ((0 <= X$7202)?(X$7202 < v$7207):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
wt$7203 = v$7206[X$7202];
var t$8213;
switch (wt$7203[0]) { case 9: {t$8213 = false;
 break; }case 8: {t$8213 = false;
 break; }default: {t$8213 = true;
} };
if (t$8213) {t$8212 = true;
} else {var v$7208;
var v$7209 = spriteMap$1378[0][0];
spriteMap$1378[0][1];
spriteMap$1378[0][2];
var v$7210 = v$7209.length;
if ((0 <= Y$7201)?(Y$7201 < v$7210):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$7211 = v$7209[Y$7201];
var v$7212 = v$7211.length;
if ((0 <= X$7202)?(X$7202 < v$7212):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
v$7208 = v$7211[X$7202];
switch (v$7208[0]) { case 0: {t$8212 = v$7208[1][0];
 break; }default: {t$8212 = false;
} };
};
};
if (t$8212) {return [v$7739,v$7740];
} else {var blockTop$1397;
var v$7401 = blockY$1391 - 1.0;
if ((v$7401 < 0.0)?true:((v$7401 >= mapHeightR$1151)?true:((blockX$1390 < 0.0)?true:(blockX$1390 >= mapWidthR$1149)))) {blockTop$1397 = true;
} else {var Y$7216 = SmlPrims.chk_ovf_i32(Math.floor(v$7401));
var X$7217 = SmlPrims.chk_ovf_i32(Math.floor(blockX$1390));
var wt$7218;
var v$7219 = v$2700[0][0];
v$2700[0][1];
v$2700[0][2];
var v$7220 = v$7219.length;
if ((0 <= Y$7216)?(Y$7216 < v$7220):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$7221 = v$7219[Y$7216];
var v$7222 = v$7221.length;
if ((0 <= X$7217)?(X$7217 < v$7222):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
wt$7218 = v$7221[X$7217];
var t$8214;
switch (wt$7218[0]) { case 9: {t$8214 = false;
 break; }case 8: {t$8214 = false;
 break; }default: {t$8214 = true;
} };
if (t$8214) {blockTop$1397 = true;
} else {var v$7223;
var v$7224 = spriteMap$1378[0][0];
spriteMap$1378[0][1];
spriteMap$1378[0][2];
var v$7225 = v$7224.length;
if ((0 <= Y$7216)?(Y$7216 < v$7225):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$7226 = v$7224[Y$7216];
var v$7227 = v$7226.length;
if ((0 <= X$7217)?(X$7217 < v$7227):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
v$7223 = v$7226[X$7217];
switch (v$7223[0]) { case 0: {blockTop$1397 = v$7223[1][0];
 break; }default: {blockTop$1397 = false;
} };
};
};
var blockBottom$1398;
var v$7403 = blockY$1391 + 1.0;
if ((v$7403 < 0.0)?true:((v$7403 >= mapHeightR$1151)?true:((blockX$1390 < 0.0)?true:(blockX$1390 >= mapWidthR$1149)))) {blockBottom$1398 = true;
} else {var Y$7231 = SmlPrims.chk_ovf_i32(Math.floor(v$7403));
var X$7232 = SmlPrims.chk_ovf_i32(Math.floor(blockX$1390));
var wt$7233;
var v$7234 = v$2700[0][0];
v$2700[0][1];
v$2700[0][2];
var v$7235 = v$7234.length;
if ((0 <= Y$7231)?(Y$7231 < v$7235):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$7236 = v$7234[Y$7231];
var v$7237 = v$7236.length;
if ((0 <= X$7232)?(X$7232 < v$7237):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
wt$7233 = v$7236[X$7232];
var t$8215;
switch (wt$7233[0]) { case 9: {t$8215 = false;
 break; }case 8: {t$8215 = false;
 break; }default: {t$8215 = true;
} };
if (t$8215) {blockBottom$1398 = true;
} else {var v$7238;
var v$7239 = spriteMap$1378[0][0];
spriteMap$1378[0][1];
spriteMap$1378[0][2];
var v$7240 = v$7239.length;
if ((0 <= Y$7231)?(Y$7231 < v$7240):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$7241 = v$7239[Y$7231];
var v$7242 = v$7241.length;
if ((0 <= X$7232)?(X$7232 < v$7242):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
v$7238 = v$7241[X$7232];
switch (v$7238[0]) { case 0: {blockBottom$1398 = v$7238[1][0];
 break; }default: {blockBottom$1398 = false;
} };
};
};
var blockLeft$1399;
var v$7404 = blockX$1390 - 1.0;
if ((blockY$1391 < 0.0)?true:((blockY$1391 >= mapHeightR$1151)?true:((v$7404 < 0.0)?true:(v$7404 >= mapWidthR$1149)))) {blockLeft$1399 = true;
} else {var Y$7246 = SmlPrims.chk_ovf_i32(Math.floor(blockY$1391));
var X$7247 = SmlPrims.chk_ovf_i32(Math.floor(v$7404));
var wt$7248;
var v$7249 = v$2700[0][0];
v$2700[0][1];
v$2700[0][2];
var v$7250 = v$7249.length;
if ((0 <= Y$7246)?(Y$7246 < v$7250):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$7251 = v$7249[Y$7246];
var v$7252 = v$7251.length;
if ((0 <= X$7247)?(X$7247 < v$7252):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
wt$7248 = v$7251[X$7247];
var t$8216;
switch (wt$7248[0]) { case 9: {t$8216 = false;
 break; }case 8: {t$8216 = false;
 break; }default: {t$8216 = true;
} };
if (t$8216) {blockLeft$1399 = true;
} else {var v$7253;
var v$7254 = spriteMap$1378[0][0];
spriteMap$1378[0][1];
spriteMap$1378[0][2];
var v$7255 = v$7254.length;
if ((0 <= Y$7246)?(Y$7246 < v$7255):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$7256 = v$7254[Y$7246];
var v$7257 = v$7256.length;
if ((0 <= X$7247)?(X$7247 < v$7257):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
v$7253 = v$7256[X$7247];
switch (v$7253[0]) { case 0: {blockLeft$1399 = v$7253[1][0];
 break; }default: {blockLeft$1399 = false;
} };
};
};
var blockRight$1400;
var v$7406 = blockX$1390 + 1.0;
if ((blockY$1391 < 0.0)?true:((blockY$1391 >= mapHeightR$1151)?true:((v$7406 < 0.0)?true:(v$7406 >= mapWidthR$1149)))) {blockRight$1400 = true;
} else {var Y$7261 = SmlPrims.chk_ovf_i32(Math.floor(blockY$1391));
var X$7262 = SmlPrims.chk_ovf_i32(Math.floor(v$7406));
var wt$7263;
var v$7264 = v$2700[0][0];
v$2700[0][1];
v$2700[0][2];
var v$7265 = v$7264.length;
if ((0 <= Y$7261)?(Y$7261 < v$7265):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$7266 = v$7264[Y$7261];
var v$7267 = v$7266.length;
if ((0 <= X$7262)?(X$7262 < v$7267):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
wt$7263 = v$7266[X$7262];
var t$8217;
switch (wt$7263[0]) { case 9: {t$8217 = false;
 break; }case 8: {t$8217 = false;
 break; }default: {t$8217 = true;
} };
if (t$8217) {blockRight$1400 = true;
} else {var v$7268;
var v$7269 = spriteMap$1378[0][0];
spriteMap$1378[0][1];
spriteMap$1378[0][2];
var v$7270 = v$7269.length;
if ((0 <= Y$7261)?(Y$7261 < v$7270):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$7271 = v$7269[Y$7261];
var v$7272 = v$7271.length;
if ((0 <= X$7262)?(X$7262 < v$7272):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
v$7268 = v$7271[X$7262];
switch (v$7268[0]) { case 0: {blockRight$1400 = v$7268[1][0];
 break; }default: {blockRight$1400 = false;
} };
};
};
var toY$1401 = (blockTop$1397?((v$7742 - blockY$1391) < v$7743):false)?(blockY$1391 + v$7743):((blockBottom$1398?(((blockY$1391 + 1.0) - v$7742) < v$7743):false)?((blockY$1391 + 1.0) - v$7743):v$7742);
return [(blockLeft$1399?((v$7741 - blockX$1390) < v$7743):false)?(blockX$1390 + v$7743):((blockRight$1400?(((blockX$1390 + 1.0) - v$7741) < v$7743):false)?((blockX$1390 + 1.0) - v$7743):v$7741),toY$1401];
};
};
};
var drawMiniMap$1682 = function(){if (h9AP67nN46MQi5f2NQrocNd$3university$0university$1.minimap_p$223?false:true) {return 0;
} else {var miniMap$1689;
var v$4773 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"minimap");
switch (v$4773[0]) { case 0: {miniMap$1689 = v$4773[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'minimap' in DOM"];
} };
var miniMapCtr$1690;
var v$4779 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"minimapcontainer");
switch (v$4779[0]) { case 0: {miniMapCtr$1690 = v$4779[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'minimapcontainer' in DOM"];
} };
var miniMapObjects$1691;
var v$4785 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"minimapobjects");
switch (v$4785[0]) { case 0: {miniMapObjects$1691 = v$4785[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'minimapobjects' in DOM"];
} };
var w$1692 = SmlPrims.chk_ovf_i32(mapWidth$1148 * 8);
var h$1693 = SmlPrims.chk_ovf_i32(mapHeight$1150 * 8);
(function(fp,s,v){fp[s] = v;})(miniMap$1689,"width",w$1692);
(function(fp,s,v){fp[s] = v;})(miniMap$1689,"height",h$1693);
(function(fp,s,v){fp[s] = v;})(miniMapObjects$1691,"width",w$1692);
(function(fp,s,v){fp[s] = v;})(miniMapObjects$1691,"height",h$1693);
(function(fp,s,v){fp[s] = v;})(miniMapCtr$1690,"width",w$1692);
(function(fp,s,v){fp[s] = v;})(miniMapCtr$1690,"height",h$1693);
var w_s$1700 = ((w$1692 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(w$1692))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(w$1692))) + "px";
var h_s$1701 = ((h$1693 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(h$1693))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(h$1693))) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(miniMap$1689,"style"),"width",w_s$1700);
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(miniMapObjects$1691,"style"),"width",w_s$1700);
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(miniMapCtr$1690,"style"),"width",w_s$1700);
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(miniMap$1689,"style"),"height",h_s$1701);
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(miniMapObjects$1691,"style"),"height",h_s$1701);
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(miniMapCtr$1690,"style"),"height",h_s$1701);
var c$1708 = (function(e,s){return e.getContext(s);})(miniMap$1689,"2d");
var entireMap$1709 = function(v$7941){return [v$2700,0,[1],[1],0];
};
Y5y0a7l58ITwhpccCWLDEa$3basis$0Array2$1.appi$512(0,function(v$7848){var v$7849 = v$7848[0];
var v$7850 = v$7848[1];
var v$7851 = v$7848[2];
var t$8218;
switch (v$7851[0]) { case 9: {t$8218 = false;
 break; }case 8: {t$8218 = false;
 break; }default: {t$8218 = true;
} };
if (t$8218) {(function(c,s){c.fillStyle = s;})(c$1708,"rgb(200,200,200)");
return (function(c,a1,a2,a3,a4){c.fillRect(a1,a2,a3,a4);})(c$1708,SmlPrims.chk_ovf_i32(v$7850 * 8),SmlPrims.chk_ovf_i32(v$7849 * 8),8,8);
} else {return 0;
};
},(entireMap$1709(0))[0],(entireMap$1709(0))[4],(entireMap$1709(0))[1],(entireMap$1709(0))[3],(entireMap$1709(0))[2]);
if (h9AP67nN46MQi5f2NQrocNd$3university$0university$1.minimap_p$223?false:true) {return 0;
} else {var miniMap$7274;
var v$7275 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"minimap");
switch (v$7275[0]) { case 0: {miniMap$7274 = v$7275[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'minimap' in DOM"];
} };
var miniMapObjects$7276;
var v$7277 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"minimapobjects");
switch (v$7277[0]) { case 0: {miniMapObjects$7276 = v$7277[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'minimapobjects' in DOM"];
} };
var height$7278 = (function(fp,s){return fp[s];})(miniMap$7274,"height");
var width$7279 = (function(fp,s){return fp[s];})(miniMap$7274,"width");
var c$7280 = (function(e,s){return e.getContext(s);})(miniMapObjects$7276,"2d");
(function(c,a1,a2,a3,a4){c.clearRect(a1,a2,a3,a4);})(c$7280,0,0,width$7279,height$7278);
(function(c,a1,a2,a3,a4){c.fillRect(a1,a2,a3,a4);})(c$7280,y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615((player$1132[5][0] * miniMapScaleR$1146) - 2.0),y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615((player$1132[6][0] * miniMapScaleR$1146) - 2.0),4,4);
(function(c){c.beginPath();})(c$7280);
(function(c,a1,a2){c.moveTo(a1,a2);})(c$7280,y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615(player$1132[5][0] * miniMapScaleR$1146),y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615(player$1132[6][0] * miniMapScaleR$1146));
(function(c,a1,a2){c.lineTo(a1,a2);})(c$7280,y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615((player$1132[5][0] + (Math.cos(player$1132[1][0]))) * miniMapScaleR$1146),y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615((player$1132[6][0] + (Math.sin(player$1132[1][0]))) * miniMapScaleR$1146));
(function(c){c.closePath();})(c$7280);
return (function(c){c.stroke();})(c$7280);
};
};
};
var castSingleRay$1862;
var fix$8219 = {};
fix$8219.$RealMod = function(v$7744,v$7745){lab$RealMod: while (true) {if (v$7744 < v$7745) {return v$7744;
} else {var t$8220 = v$7744 - v$7745;
var t$8221 = v$7745;
var v$7744 = t$8220;
var v$7745 = t$8221;
continue lab$RealMod;
};
};
};
var RealMod$1744 = fix$8219.$RealMod;
castSingleRay$1862 = (function(displayContent$1865){return function(screenStrips$1868){return function(spriteMap$1871){return function(v$1876){var v$2386 = v$1876[0];
var v$2387 = v$1876[1];
var v$2388 = v$1876[2];
var rayAngle$1877 = RealMod$1744(v$2386,twoPI$1142);
var rayAngle$1878 = (rayAngle$1877 < 0.0)?(rayAngle$1877 + twoPI$1142):rayAngle$1877;
var right$1883 = (rayAngle$1878 > (twoPI$1142 * 0.75))?true:(rayAngle$1878 < (twoPI$1142 * 0.25));
var up$1888 = (rayAngle$1878 < 0.0)?true:(rayAngle$1878 > 3.14159265358979323846);
var angleSin$1893 = Math.sin(rayAngle$1878);
var angleCos$1894 = Math.cos(rayAngle$1878);
var slope$1895 = angleSin$1893 / angleCos$1894;
var dXVer$1896 = right$1883?1.0:(-1.0);
var dYVer$1901 = dXVer$1896 * slope$1895;
var x$1902 = right$1883?(SmlPrims.chk_ovf_i32(Math.ceil(player$1132[5][0]))):(SmlPrims.chk_ovf_i32(Math.floor(player$1132[5][0])));
var x$1915 = x$1902;
var y$1916 = player$1132[6][0] + ((x$1915 - player$1132[5][0]) * slope$1895);
var emptyHit$1927 = [0.0,0,false,0.0,[9],0.0,0,0.0,0];
var v$2383;
var fix$8222 = {};
fix$8222.$loopV = function(v$7748,v$7749,visibleSprites$1944){lab$loopV: while (true) {if ((v$7748 < 0.0)?true:((v$7748 >= mapWidthR$1149)?true:((v$7749 < 0.0)?true:(v$7749 >= mapHeightR$1151)))) {return [emptyHit$1927,visibleSprites$1944];
} else {var wallX$1949 = SmlPrims.chk_ovf_i32(Math.floor(right$1883?v$7748:(v$7748 - 1.0)));
var wallY$1954 = SmlPrims.chk_ovf_i32(Math.floor(v$7749));
var wt$1955;
var v$5004 = v$2700[0][0];
v$2700[0][1];
v$2700[0][2];
var v$5006 = v$5004.length;
if ((0 <= wallY$1954)?(wallY$1954 < v$5006):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$5008 = v$5004[wallY$1954];
var v$5009 = v$5008.length;
if ((0 <= wallX$1949)?(wallX$1949 < v$5009):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
wt$1955 = v$5008[wallX$1949];
var t$8223;
switch (wt$1955[0]) { case 9: {t$8223 = false;
 break; }case 8: {t$8223 = false;
 break; }default: {t$8223 = true;
} };
if (t$8223) {var distX$1960 = v$7748 - player$1132[5][0];
var distY$1965 = v$7749 - player$1132[6][0];
var dist$1970 = (distX$1960 * distX$1960) + (distY$1965 * distY$1965);
var textureX$1971 = v$7749 - (SmlPrims.chk_ovf_i32(Math.floor(v$7749)));
var textureX$1972 = (right$1883?false:true)?(1.0 - textureX$1971):textureX$1971;
return [[dist$1970,0,(rayAngle$1878 < (3.14159265358979323846 / 2.0))?true:(rayAngle$1878 > ((3.0 * 3.14159265358979323846) / 2.0)),textureX$1972,wt$1955,v$7748,wallX$1949,v$7749,wallY$1954],visibleSprites$1944];
} else {var t$8226 = v$7748 + dXVer$1896;
var t$8225 = v$7749 + dYVer$1901;
var t$8224;
var v$1995;
var v$5020 = spriteMap$1871[0][0];
spriteMap$1871[0][1];
spriteMap$1871[0][2];
var v$5022 = v$5020.length;
if ((0 <= wallY$1954)?(wallY$1954 < v$5022):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$5024 = v$5020[wallY$1954];
var v$5025 = v$5024.length;
if ((0 <= wallX$1949)?(wallX$1949 < v$5025):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
v$1995 = v$5024[wallX$1949];
switch (v$1995[0]) { case 1: {t$8224 = visibleSprites$1944;
 break; }default: {var v$2010 = v$1995[1];
if (v$2010[4][0]) {t$8224 = visibleSprites$1944;
} else {(v$2010[4][0] = true,0);
t$8224 = [v$2010,visibleSprites$1944];
};
} };
var t$8227 = t$8226;
var t$8228 = t$8225;
var t$8229 = t$8224;
var v$7748 = t$8227;
var v$7749 = t$8228;
var visibleSprites$1944 = t$8229;
continue lab$loopV;
};
};
};
};
var loopV$1937 = fix$8222.$loopV;
v$2383 = (loopV$1937(x$1915,y$1916,v$2388));
var v$2384 = v$2383[0];
var v$2385 = v$2383[1];
var slope$2028 = angleCos$1894 / angleSin$1893;
var dYHor$2029 = up$1888?(-1.0):1.0;
var dXHor$2034 = dYHor$2029 * slope$2028;
var y$2035 = up$1888?(SmlPrims.chk_ovf_i32(Math.floor(player$1132[6][0]))):(SmlPrims.chk_ovf_i32(Math.ceil(player$1132[6][0])));
var x$2048 = player$1132[5][0] + ((y$2035 - player$1132[6][0]) * slope$2028);
var v$2371;
var fix$8230 = {};
fix$8230.$loopH = function(v$7752,v$7753,visibleSprites$2064){lab$loopH: while (true) {if ((v$7752 < 0.0)?true:((v$7752 >= mapWidthR$1149)?true:((v$7753 < 0.0)?true:((v$7753 >= mapHeightR$1151)?true:((slope$2028 > 10000.0)?true:(up$1888?((v$7753 - 1.0) < 0.0):false)))))) {return [v$2384,visibleSprites$2064];
} else {var wallY$2069 = SmlPrims.chk_ovf_i32(Math.floor(up$1888?(v$7753 - 1.0):v$7753));
var wallX$2074 = SmlPrims.chk_ovf_i32(Math.floor(v$7752));
var wt$2075;
try {var v$5040 = v$2700[0][0];
v$2700[0][1];
v$2700[0][2];
var v$5042 = v$5040.length;
if ((0 <= wallY$2069)?(wallY$2069 < v$5042):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$5044 = v$5040[wallY$2069];
var v$5045 = v$5044.length;
if ((0 <= wallX$2074)?(wallX$2074 < v$5045):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
wt$2075 = v$5044[wallX$2074];
} catch(v$8231) {wt$2075 = (((function(env$8236){return function(s$m$2078){var v$8232 = env$8236[0];
var v$8233 = env$8236[1];
var v$8234 = env$8236[2];
var v$8235 = env$8236[3];
var s$5046 = (("wallX = " + ((v$8235 < 0)?("-" + (v$8234(SmlPrims.chk_ovf_i32(-(v$8235))))):(v$8234(v$8235)))) + "; wallY = ") + ((v$8233 < 0)?("-" + (v$8234(SmlPrims.chk_ovf_i32(-(v$8233))))):(v$8234(v$8233)));
var log$5047;
var v$5049 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(v$8232,"log");
switch (v$5049[0]) { case 0: {log$5047 = v$5049[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'log' in DOM"];
} };
(function(e,a){return e.appendChild(a);})(log$5047,document.createTextNode(s$5046));
(function(e,a){return e.appendChild(a);})(log$5047,document.createElement("br"));
throw s$m$2078;
};
})([z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,wallY$2069,abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456,wallX$2074]))(v$8231));
};
var t$8237;
switch (wt$2075[0]) { case 9: {t$8237 = false;
 break; }case 8: {t$8237 = false;
 break; }default: {t$8237 = true;
} };
if (t$8237) {var distX$2085 = v$7752 - player$1132[5][0];
var distY$2090 = v$7753 - player$1132[6][0];
var blockDist$2095 = (distX$2085 * distX$2085) + (distY$2090 * distY$2090);
if (((v$2384[0] > 0.0)?false:true)?true:(blockDist$2095 < v$2384[0])) {var textureX$2100 = v$7752 - (SmlPrims.chk_ovf_i32(Math.floor(v$7752)));
return [[blockDist$2095,1,rayAngle$1878 < 3.14159265358979323846,1.0 - (up$1888?(1.0 - textureX$2100):textureX$2100),wt$2075,v$7752,wallX$2074,v$7753,wallY$2069],visibleSprites$2064];
} else {return [v$2384,visibleSprites$2064];
};
} else {var t$8240 = v$7752 + dXHor$2034;
var t$8239 = v$7753 + dYHor$2029;
var t$8238;
var v$2133;
var v$5071 = spriteMap$1871[0][0];
spriteMap$1871[0][1];
spriteMap$1871[0][2];
var v$5073 = v$5071.length;
if ((0 <= wallY$2069)?(wallY$2069 < v$5073):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$5075 = v$5071[wallY$2069];
var v$5076 = v$5075.length;
if ((0 <= wallX$2074)?(wallX$2074 < v$5076):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
v$2133 = v$5075[wallX$2074];
switch (v$2133[0]) { case 1: {t$8238 = visibleSprites$2064;
 break; }default: {var v$2148 = v$2133[1];
if (v$2148[4][0]) {t$8238 = visibleSprites$2064;
} else {(v$2148[4][0] = true,0);
t$8238 = [v$2148,visibleSprites$2064];
};
} };
var t$8241 = t$8240;
var t$8242 = t$8239;
var t$8243 = t$8238;
var v$7752 = t$8241;
var v$7753 = t$8242;
var visibleSprites$2064 = t$8243;
continue lab$loopH;
};
};
};
};
var loopH$2057 = fix$8230.$loopH;
v$2371 = (loopH$2057(x$2048,y$2035,v$2385));
var v$2372 = v$2371[0];
var v$2373 = v$2372[0];
var v$2374 = v$2372[5];
var v$2375 = v$2372[7];
var v$2376 = v$2372[6];
var v$2377 = v$2372[8];
var v$2378 = v$2372[4];
var v$2379 = v$2372[3];
var v$2380 = v$2372[2];
var v$2381 = v$2372[1];
var v$2382 = v$2371[1];
if (v$2373 <= 0.0) {return v$2382;
} else {var dist$2190 = Math.sqrt(v$2373);
var dist$2191 = dist$2190 * (Math.cos(player$1132[1][0] - rayAngle$1878));
var height$2196 = y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615(viewDist$1155 / dist$2191);
var width$2197 = SmlPrims.chk_ovf_i32(height$2196 * 1);
var widthR$2198 = width$2197;
var heightR$2199 = height$2196;
var top$2200 = y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615((screenHeightR$1153 - heightR$2199) / 2.0);
var texX$2201 = y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615(v$2379 * widthR$2198);
var texX$2202 = (texX$2201 > (SmlPrims.chk_ovf_i32(width$2197 - 1)))?(SmlPrims.chk_ovf_i32(width$2197 - 1)):texX$2201;
var v$5089 = screenStrips$1868.length;
if ((0 <= v$2387)?(v$2387 < v$5089):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var stripdata$2207 = screenStrips$1868[v$2387];
var wallType$2208;
if (v$2380) {switch (v$2378[0]) { case 13: {var v$2224 = v$2378[1];
wallType$2208 = [12,v$2224];
 break; }case 12: {var v$2222 = v$2378[1];
wallType$2208 = [13,v$2222];
 break; }default: {wallType$2208 = v$2378;
} };
} else {wallType$2208 = v$2378;
};
var v$2306;
switch (wallType$2208[0]) { case 13: {var v$2370 = wallType$2208[1];
var v$5109 = stripdata$2207[0];
var v$5110 = stripdata$2207[1];
var s$5111;
var dir$5122;
switch (v$2381) { case 0: {dir$5122 = ((player$1132[5][0] > v$2374)?3:0);
 break; }default: {dir$5122 = ((player$1132[6][0] > v$2375)?1:2);
} };
var v$5123 = v$2370(dir$5122);
switch (v$5123[0]) { case 0: {var v$5124 = v$5123[1];
var v$5125 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$5128){return v$5124 == v$5128[1];
},displayContent$1865);
switch (v$5125[0]) { case 0: {var v$5132 = v$5125[1];
var v$5133 = v$5132[2];
var v$5134 = v$5132[0];
var b$5135 = v$5134[0];
var i$5136 = v$5133[0];
var t$8253;
var t$8252 = ((((("data/" + v$5124) + "/") + b$5135) + "/") + b$5135) + "-";
var t$8251;
var fix$8249 = {};
fix$8249.$prefixzeros = function(s$7293){lab$prefixzeros: while (true) {if (s$7293.length < 3) {var t$8250 = "0" + s$7293;
var s$7293 = t$8250;
continue lab$prefixzeros;
} else {return s$7293;
};
};
};
var prefixzeros$7292 = fix$8249.$prefixzeros;
t$8251 = (prefixzeros$7292(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(i$5136)));
t$8253 = (t$8252 + t$8251);
s$5111 = (t$8253 + ".png");
 break; }default: {s$5111 = "wall-white.png";
} };
 break; }default: {s$5111 = "wall-white.png";
} };
var r$5112 = v$5110[3];
if (r$5112[0] == s$5111) {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$5109,"src",s$5111);
(r$5112[0] = s$5111,0);
};
v$2306 = [1,0,texX$2202,2.0];
 break; }case 12: {var v$2366 = wallType$2208[1];
var v$5146 = stripdata$2207[0];
var v$5147 = stripdata$2207[1];
var s$5148;
var dir$5159;
switch (v$2381) { case 0: {dir$5159 = ((player$1132[5][0] > v$2374)?3:0);
 break; }default: {dir$5159 = ((player$1132[6][0] > v$2375)?1:2);
} };
var v$5160 = v$2366(dir$5159);
switch (v$5160[0]) { case 0: {var v$5161 = v$5160[1];
var v$5162 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$5165){return v$5161 == v$5165[1];
},displayContent$1865);
switch (v$5162[0]) { case 0: {var v$5169 = v$5162[1];
var v$5170 = v$5169[2];
var v$5171 = v$5169[0];
var b$5172 = v$5171[0];
var i$5173 = v$5170[0];
var t$8248;
var t$8247 = ((((("data/" + v$5161) + "/") + b$5172) + "/") + b$5172) + "-";
var t$8246;
var fix$8244 = {};
fix$8244.$prefixzeros = function(s$7298){lab$prefixzeros: while (true) {if (s$7298.length < 3) {var t$8245 = "0" + s$7298;
var s$7298 = t$8245;
continue lab$prefixzeros;
} else {return s$7298;
};
};
};
var prefixzeros$7297 = fix$8244.$prefixzeros;
t$8246 = (prefixzeros$7297(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(i$5173)));
t$8248 = (t$8247 + t$8246);
s$5148 = (t$8248 + ".png");
 break; }default: {s$5148 = "wall-white.png";
} };
 break; }default: {s$5148 = "wall-white.png";
} };
var r$5149 = v$5147[3];
if (r$5149[0] == s$5148) {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$5146,"src",s$5148);
(r$5149[0] = s$5148,0);
};
v$2306 = [1,0,SmlPrims.chk_ovf_i32(texX$2202 + width$2197),2.0];
 break; }case 1: {var v$5183 = stripdata$2207[0];
var v$5184 = stripdata$2207[1];
var r$5186 = v$5184[3];
if (r$5186[0] == "window-left.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$5183,"src","window-left.png");
(r$5186[0] = "window-left.png",0);
};
v$2306 = [1,0,texX$2202,1.0];
 break; }case 2: {var v$5196 = stripdata$2207[0];
var v$5197 = stripdata$2207[1];
var r$5199 = v$5197[3];
if (r$5199[0] == "window-center.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$5196,"src","window-center.png");
(r$5199[0] = "window-center.png",0);
};
v$2306 = [1,0,texX$2202,1.0];
 break; }case 0: {var v$5209 = stripdata$2207[0];
var v$5210 = stripdata$2207[1];
var r$5212 = v$5210[3];
if (r$5212[0] == "window-right.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$5209,"src","window-right.png");
(r$5212[0] = "window-right.png",0);
};
v$2306 = [1,0,texX$2202,1.0];
 break; }case 7: {var v$5222 = stripdata$2207[0];
var v$5223 = stripdata$2207[1];
var r$5225 = v$5223[3];
if (r$5225[0] == "wall-white.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$5222,"src","wall-white.png");
(r$5225[0] = "wall-white.png",0);
};
v$2306 = [1,0,texX$2202,1.0];
 break; }case 10: {var v$5235 = stripdata$2207[0];
var v$5236 = stripdata$2207[1];
var r$5238 = v$5236[3];
if (r$5238[0] == "wall-shelf1.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$5235,"src","wall-shelf1.png");
(r$5238[0] = "wall-shelf1.png",0);
};
v$2306 = [1,0,texX$2202,1.0];
 break; }case 11: {var v$5248 = stripdata$2207[0];
var v$5249 = stripdata$2207[1];
var r$5251 = v$5249[3];
if (r$5251[0] == "wall-shelf2.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$5248,"src","wall-shelf2.png");
(r$5251[0] = "wall-shelf2.png",0);
};
v$2306 = [1,0,texX$2202,1.0];
 break; }case 3: {var v$5261 = stripdata$2207[0];
var v$5262 = stripdata$2207[1];
var r$5264 = v$5262[3];
if (r$5264[0] == "wall-board.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$5261,"src","wall-board.png");
(r$5264[0] = "wall-board.png",0);
};
v$2306 = [1,0,texX$2202,1.0];
 break; }case 14: {var v$5274 = stripdata$2207[0];
var v$5275 = stripdata$2207[1];
var r$5277 = v$5275[3];
if (r$5277[0] == "wall-bulletin.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$5274,"src","wall-bulletin.png");
(r$5277[0] = "wall-bulletin.png",0);
};
v$2306 = [1,0,texX$2202,1.0];
 break; }case 6: {var v$5287 = stripdata$2207[0];
var v$5288 = stripdata$2207[1];
var r$5290 = v$5288[3];
if (r$5290[0] == "walls.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$5287,"src","walls.png");
(r$5290[0] = "walls.png",0);
};
v$2306 = [4,0,texX$2202,2.0];
 break; }case 5: {var v$5300 = stripdata$2207[0];
var v$5301 = stripdata$2207[1];
var r$5303 = v$5301[3];
if (r$5303[0] == "walls.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$5300,"src","walls.png");
(r$5303[0] = "walls.png",0);
};
v$2306 = [4,1,texX$2202,2.0];
 break; }case 4: {var v$5313 = stripdata$2207[0];
var v$5314 = stripdata$2207[1];
var r$5316 = v$5314[3];
if (r$5316[0] == "walls.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$5313,"src","walls.png");
(r$5316[0] = "walls.png",0);
};
v$2306 = [4,2,texX$2202,2.0];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"obj not supported"];
} };
var v$2307 = v$2306[0];
var v$2308 = v$2306[1];
var v$2309 = v$2306[2];
var v$2310 = v$2306[3];
var v$7302 = stripdata$2207[0];
var v$7303 = stripdata$2207[1];
var r$7305 = v$7303[1];
if (r$7305[0] == height$2196) {0;
} else {var v$7306 = ((height$2196 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(height$2196))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(height$2196))) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$7302,"style"),"height",v$7306);
(r$7305[0] = height$2196,0);
};
var v$7309 = stripdata$2207[0];
var v$7310 = stripdata$2207[1];
var r$7312 = v$7310[4];
if (r$7312[0] == top$2200) {0;
} else {var v$7313 = ((top$2200 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(top$2200))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(top$2200))) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$7309,"style"),"top",v$7313);
(r$7312[0] = top$2200,0);
};
var imgTop$2275 = SmlPrims.chk_ovf_i32(Math.floor(heightR$2199 * v$2308));
var styleHeight$2276 = SmlPrims.chk_ovf_i32(Math.floor(heightR$2199 * v$2307));
var v$7316 = stripdata$2207[0];
var v$7317 = stripdata$2207[1];
var r$7319 = v$7317[1];
if (r$7319[0] == styleHeight$2276) {0;
} else {var v$7320 = ((styleHeight$2276 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(styleHeight$2276))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(styleHeight$2276))) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$7316,"style"),"height",v$7320);
(r$7319[0] = styleHeight$2276,0);
};
var styleWidth$2278 = SmlPrims.chk_ovf_i32(Math.floor(widthR$2198 * v$2310));
var v$7323 = stripdata$2207[0];
var v$7324 = stripdata$2207[1];
var r$7326 = v$7324[5];
if (r$7326[0] == styleWidth$2278) {0;
} else {var v$7327 = ((styleWidth$2278 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(styleWidth$2278))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(styleWidth$2278))) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$7323,"style"),"width",v$7327);
(r$7326[0] = styleWidth$2278,0);
};
var styleTop$2280 = SmlPrims.chk_ovf_i32(top$2200 - imgTop$2275);
var v$7330 = stripdata$2207[0];
var v$7331 = stripdata$2207[1];
var r$7333 = v$7331[4];
if (r$7333[0] == styleTop$2280) {0;
} else {var v$7334 = ((styleTop$2280 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(styleTop$2280))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(styleTop$2280))) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$7330,"style"),"top",v$7334);
(r$7333[0] = styleTop$2280,0);
};
var styleLeft$2282 = SmlPrims.chk_ovf_i32((SmlPrims.chk_ovf_i32(v$2387 * 1)) - v$2309);
var v$7337 = stripdata$2207[0];
var v$7338 = stripdata$2207[1];
var r$7340 = v$7338[2];
if (r$7340[0] == styleLeft$2282) {0;
} else {var v$7341 = ((styleLeft$2282 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(styleLeft$2282))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(styleLeft$2282))) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$7337,"style"),"left",v$7341);
(r$7340[0] = styleLeft$2282,0);
};
var styleClip$2284;
var t$8261;
var t$8260;
var t$8259;
var t$8258;
var t$8257;
var t$8256 = ("rect(" + ((imgTop$2275 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(imgTop$2275))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(imgTop$2275)))) + ",";
var t$8255;
var i$5340 = SmlPrims.chk_ovf_i32(v$2309 + 1);
t$8255 = ((i$5340 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(i$5340))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(i$5340)));
t$8257 = (t$8256 + t$8255);
t$8258 = (t$8257 + ",");
var t$8254;
var i$5342 = SmlPrims.chk_ovf_i32(imgTop$2275 + height$2196);
t$8254 = ((i$5342 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(i$5342))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(i$5342)));
t$8259 = (t$8258 + t$8254);
t$8260 = (t$8259 + ",");
t$8261 = (t$8260 + ((v$2309 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(v$2309))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(v$2309))));
styleClip$2284 = (t$8261 + ")");
var v$5347 = stripdata$2207[0];
var v$5348 = stripdata$2207[1];
var r$5350 = v$5348[0];
if (r$5350[0] == styleClip$2284) {0;
} else {(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$5347,"style"),"clip",styleClip$2284);
(r$5350[0] = styleClip$2284,0);
};
var dwx$2286 = v$2376 - player$1132[5][0];
var dwy$2291 = v$2377 - player$1132[6][0];
var wallDist$2296 = (dwx$2286 * dwx$2286) + (dwy$2291 * dwy$2291);
var v$7344 = stripdata$2207[0];
var v$7345 = stripdata$2207[1];
var n$7346 = SmlPrims.chk_ovf_i32(-(SmlPrims.chk_ovf_i32(Math.floor(wallDist$2296 * 1000.0))));
var r$7347 = v$7345[6];
if (r$7347[0] == n$7346) {0;
} else {var v$7348 = (n$7346 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(n$7346))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(n$7346));
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$7344,"style"),"zIndex",v$7348);
(r$7347[0] = n$7346,0);
};
return v$2382;
};
};
};
};
});
var zero$2418 = SmlPrims.getrealtime();
var gameCycle$2423 = function(spriteMap$2426){var gameCycleDelay$2427 = TtcHr52auHS5gydZjBhWJe$3basis$0IntInfRep$1.div$1394([0,[[1000,null],false]],[0,[[30,null],false]]);
var fix$8262 = {};
fix$8262.$cycle = function(lastGameCycleTime$2431){lab$cycle: while (true) {var n$2434;
var v$7648;
var v$7881 = SmlPrims.getrealtime();
v$7648 = (g14hFoVCUPM3ZC3WsORS6h$3basis$0Time$1.s$g$309(v$7881[0],v$7881[1],zero$2418[0],zero$2418[1]));
n$2434 = (g14hFoVCUPM3ZC3WsORS6h$3basis$0Time$1.toMilliseconds$97(v$7648[0],v$7648[1]));
var timeDelta$2435 = TtcHr52auHS5gydZjBhWJe$3basis$0IntInfRep$1.s$g$1258(lastGameCycleTime$2431,n$2434);
var mul$5378 = (xe4rCkobvAWmCENzbhJ8Ed$3basis$0IntInf$1.toInt$1823(timeDelta$2435)) / (xe4rCkobvAWmCENzbhJ8Ed$3basis$0IntInf$1.toInt$1823(gameCycleDelay$2427));
var moveStep$5380 = (mul$5378 * player$1132[4][0]) * player$1132[0];
var t$8264 = player$1132[3];
var t$8263;
var a$5382 = player$1132[3][0] + player$1132[2][0];
t$8263 = ((a$5382 > 0.0)?((a$5382 > 2.0)?2.0:a$5382):((a$5382 < (-(2.0)))?(-(2.0)):a$5382));
(t$8264[0] = t$8263,0);
var drot$5384 = (mul$5378 * player$1132[3][0]) * MaxRotSpeed$1131;
var rot$5385 = player$1132[1][0] + drot$5384;
(player$1132[1][0] = ((rot$5385 > twoPI$1142)?(rot$5385 - twoPI$1142):((rot$5385 < (-(twoPI$1142)))?(rot$5385 + twoPI$1142):rot$5385)),0);
var dx$5388 = (Math.cos(player$1132[1][0])) * moveStep$5380;
var dy$5389 = (Math.sin(player$1132[1][0])) * moveStep$5380;
var fromX$5390 = player$1132[5][0];
var fromY$5391 = player$1132[6][0];
var v$5392 = checkCollision$1375(spriteMap$2426,fromX$5390,fromY$5391,fromX$5390 + dx$5388,fromY$5391 + dy$5389,0.35);
var v$5393 = v$5392[0];
var v$5394 = v$5392[1];
(player$1132[5][0] = v$5393,0);
(player$1132[6][0] = v$5394,0);
var cycleDelay$2436 = (TtcHr52auHS5gydZjBhWJe$3basis$0IntInfRep$1.s$l$1462(timeDelta$2435,gameCycleDelay$2427))?(xe4rCkobvAWmCENzbhJ8Ed$3basis$0IntInf$1.max$2267([0,[[1,null],false]],TtcHr52auHS5gydZjBhWJe$3basis$0IntInfRep$1.s$g$1258(TtcHr52auHS5gydZjBhWJe$3basis$0IntInfRep$1.s$g$1258(gameCycleDelay$2427,timeDelta$2435),gameCycleDelay$2427))):gameCycleDelay$2427;
(function(i,f){return setTimeout(f,i);})(xe4rCkobvAWmCENzbhJ8Ed$3basis$0IntInf$1.toInt$1823(cycleDelay$2436),(function(env$8267){return function(v$7655){var v$8265 = env$8267[0];
var v$8266 = env$8267[1];
return v$8266(v$8265);
};
})([n$2434,fix$8262.$cycle]));
return 0;
};
};
var cycle$2428 = fix$8262.$cycle;
return cycle$2428([0,[null,false]]);
};
var updateOverlay$2462;
var old$5413 = [""];
updateOverlay$2462 = (function(v$5414){var s$5415;
var v$7351 = v$5414[0];
var v$7352 = v$5414[1];
s$5415 = ((((("FPS: " + ((y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.fmt$169([2,[0,0]]))(v$7351))) + " | SCORE: ") + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(v$7352))) + " | ") + h9AP67nN46MQi5f2NQrocNd$3university$0university$1.deviceStr$222);
if (old$5413[0] == s$5415) {return 0;
} else {var e$5419;
var v$5421 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"overlay");
switch (v$5421[0]) { case 0: {e$5419 = v$5421[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'overlay' in DOM"];
} };
(function(e,s){e.innerHTML = s;})(e$5419,s$5415);
return (old$5413[0] = s$5415,0);
};
});
var renderSprites$2469 = function(oldSprites$2472,sprites$2475){var v$5433 = function(v$7757,v$7935,v$7936){var dx$5444 = (v$7935 + 0.5) - player$1132[5][0];
var dy$5448 = (v$7936 + 0.5) - player$1132[6][0];
var dist$5452 = Math.sqrt((dx$5444 * dx$5444) + (dy$5448 * dy$5448));
var spriteAngle$5453 = (Math.atan2(dy$5448,dx$5444)) - player$1132[1][0];
var size$5457 = viewDist$1155 / ((Math.cos(spriteAngle$5453)) * dist$5452);
if (size$5457 <= 0.0) {return 0;
} else {(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$7757,"style"),"display","block");
var screen_x$5464 = ((Math.sin(spriteAngle$5453)) / (Math.cos(spriteAngle$5453))) * viewDist$1155;
var left$5465 = y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615(((screenWidthR$1152 / 2.0) + screen_x$5464) - (size$5457 / 2.0));
var top$5466 = y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615((screenHeightR$1153 - size$5457) / 2.0);
var v$6709 = ((left$5465 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(left$5465))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(left$5465))) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$7757,"style"),"left",v$6709);
var v$6715 = ((top$5466 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(top$5466))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(top$5466))) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$7757,"style"),"top",v$6715);
var dbx$5469 = v$7935 - player$1132[5][0];
var dby$5473 = v$7936 - player$1132[6][0];
var sz$5477;
var t$8268;
var i$5524 = y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615(size$5457);
t$8268 = ((i$5524 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(i$5524))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(i$5524)));
sz$5477 = (t$8268 + "px");
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$7757,"style"),"width",sz$5477);
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$7757,"style"),"height",sz$5477);
var blockDist$5480 = (dbx$5469 * dbx$5469) + (dby$5473 * dby$5473);
var zIndex$5481 = SmlPrims.chk_ovf_i32(-(SmlPrims.chk_ovf_i32(Math.floor(blockDist$5480 * 1000.0))));
var v$6729 = (zIndex$5481 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(zIndex$5481))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(zIndex$5481));
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$7757,"style"),"zIndex",v$6729);
return 0;
};
};
var fix$8269 = {};
fix$8269.$app = function(v$5484){lab$app: while (true) {if (v$5484 == null) {return 0;
} else {var v$5485 = v$5484;
var v$5486 = v$5485[0];
var v$5487 = v$5485[1];
var v$7938 = v$5486[3];
v$5433(v$5486[2],v$7938[0],v$7938[1]);
var t$8270 = v$5487;
var v$5484 = t$8270;
continue lab$app;
};
};
};
var app$5483 = fix$8269.$app;
app$5483(sprites$2475);
var fix$8271 = {};
fix$8271.$app = function(v$5552){lab$app: while (true) {if (v$5552 == null) {return 0;
} else {var v$5553 = v$5552;
var v$5554 = v$5553[0];
var v$5555 = v$5553[1];
(v$5554[4][0]?false:true)?((function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$5554[2],"style"),"display","none")):0;
var t$8272 = v$5555;
var v$5552 = t$8272;
continue lab$app;
};
};
};
var app$5551 = fix$8271.$app;
return app$5551(oldSprites$2472);
};
var score$2571 = [0];
var renderCycle$2572 = function(displayContent$2575,screenStrips$2578,spriteMap$2581){var renderCycleDelay$2582 = TtcHr52auHS5gydZjBhWJe$3basis$0IntInfRep$1.div$1394([0,[[1000,null],false]],[0,[[30,null],false]]);
var fix$8273 = {};
fix$8273.$cycle = function(v$7758,v$7759){lab$cycle: while (true) {if (h9AP67nN46MQi5f2NQrocNd$3university$0university$1.minimap_p$223?false:true) {0;
} else {var miniMap$7354;
var v$7355 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"minimap");
switch (v$7355[0]) { case 0: {miniMap$7354 = v$7355[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'minimap' in DOM"];
} };
var miniMapObjects$7356;
var v$7357 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"minimapobjects");
switch (v$7357[0]) { case 0: {miniMapObjects$7356 = v$7357[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'minimapobjects' in DOM"];
} };
var height$7358 = (function(fp,s){return fp[s];})(miniMap$7354,"height");
var width$7359 = (function(fp,s){return fp[s];})(miniMap$7354,"width");
var c$7360 = (function(e,s){return e.getContext(s);})(miniMapObjects$7356,"2d");
(function(c,a1,a2,a3,a4){c.clearRect(a1,a2,a3,a4);})(c$7360,0,0,width$7359,height$7358);
(function(c,a1,a2,a3,a4){c.fillRect(a1,a2,a3,a4);})(c$7360,y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615((player$1132[5][0] * miniMapScaleR$1146) - 2.0),y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615((player$1132[6][0] * miniMapScaleR$1146) - 2.0),4,4);
(function(c){c.beginPath();})(c$7360);
(function(c,a1,a2){c.moveTo(a1,a2);})(c$7360,y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615(player$1132[5][0] * miniMapScaleR$1146),y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615(player$1132[6][0] * miniMapScaleR$1146));
(function(c,a1,a2){c.lineTo(a1,a2);})(c$7360,y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615((player$1132[5][0] + (Math.cos(player$1132[1][0]))) * miniMapScaleR$1146),y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615((player$1132[6][0] + (Math.sin(player$1132[1][0]))) * miniMapScaleR$1146));
(function(c){c.closePath();})(c$7360);
(function(c){c.stroke();})(c$7360);
};
var fix$8274 = {};
fix$8274.$app = function(v$5583){lab$app: while (true) {if (v$5583 == null) {return 0;
} else {var v$5584 = v$5583;
var v$5585 = v$5584[0];
var v$5586 = v$5584[1];
(v$5585[4][0] = false,0);
var t$8275 = v$5586;
var v$5583 = t$8275;
continue lab$app;
};
};
};
var app$5582 = fix$8274.$app;
app$5582(v$7759);
var sprites$2592;
var fix$8276 = {};
fix$8276.$loop = function(i$5593,acc$5594){lab$loop: while (true) {if (i$5593 >= numRays$1154) {return acc$5594;
} else {var rayScreenPos$5595 = (((-(numRays$1154)) / 2.0) + i$5593) * stripWidthR$1144;
var rayViewDist$5597 = Math.sqrt((rayScreenPos$5595 * rayScreenPos$5595) + (viewDist$1155 * viewDist$1155));
var rayAngle$5598 = Math.asin(rayScreenPos$5595 / rayViewDist$5597);
var acc$5600 = (((castSingleRay$1862(displayContent$2575))(screenStrips$2578))(spriteMap$2581))([player$1132[1][0] + rayAngle$5598,i$5593,acc$5594]);
var t$8277 = SmlPrims.chk_ovf_i32(i$5593 + 1);
var t$8278 = acc$5600;
var i$5593 = t$8277;
var acc$5594 = t$8278;
continue lab$loop;
};
};
};
var loop$5592 = fix$8276.$loop;
sprites$2592 = (loop$5592(0,null));
renderSprites$2469(v$7759,sprites$2592);
var n$2594;
var v$7666;
var v$7900 = SmlPrims.getrealtime();
v$7666 = (g14hFoVCUPM3ZC3WsORS6h$3basis$0Time$1.s$g$309(v$7900[0],v$7900[1],zero$2418[0],zero$2418[1]));
n$2594 = (g14hFoVCUPM3ZC3WsORS6h$3basis$0Time$1.toMilliseconds$97(v$7666[0],v$7666[1]));
var timeDelta$2595 = TtcHr52auHS5gydZjBhWJe$3basis$0IntInfRep$1.s$g$1258(v$7758,n$2594);
var cycleDelay$2596 = (TtcHr52auHS5gydZjBhWJe$3basis$0IntInfRep$1.s$l$1462(timeDelta$2595,renderCycleDelay$2582))?(xe4rCkobvAWmCENzbhJ8Ed$3basis$0IntInf$1.max$2267([0,[[1,null],false]],TtcHr52auHS5gydZjBhWJe$3basis$0IntInfRep$1.s$g$1258(TtcHr52auHS5gydZjBhWJe$3basis$0IntInfRep$1.s$g$1258(renderCycleDelay$2582,timeDelta$2595),renderCycleDelay$2582))):renderCycleDelay$2582;
var cycleDelay$2601 = xe4rCkobvAWmCENzbhJ8Ed$3basis$0IntInf$1.toInt$1823(cycleDelay$2596);
(function(i,f){return setTimeout(f,i);})(cycleDelay$2601,(function(env$8282){return function(v$7933){var v$8279 = env$8282[0];
var v$8280 = env$8282[1];
var v$8281 = env$8282[2];
return v$8281(v$8280,v$8279);
};
})([sprites$2592,n$2594,fix$8273.$cycle]));
return updateOverlay$2462([1000.0 / (xe4rCkobvAWmCENzbhJ8Ed$3basis$0IntInf$1.toInt$1823(timeDelta$2595)),score$2571[0]]);
};
};
var cycle$2583 = fix$8273.$cycle;
return cycle$2583([0,[null,false]],null);
};
var init$2667 = function(){var staff$2670;
try {var t$8289 = h9AP67nN46MQi5f2NQrocNd$3university$0university$1.loadStaff$263;
var t$8288;
var file$5641;
var t$8287 = "data/staff.json?_=";
var t$8286;
var t$8285 = y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.toString$158;
var t$8284;
var v$5644 = SmlPrims.getrealtime();
var v$5645 = v$5644[0];
var v$5646 = v$5644[1];
t$8284 = ((v$5645 - (-2147483648)) + (v$5646 / 1000000.0));
t$8286 = (t$8285(t$8284));
file$5641 = (t$8287 + t$8286);
var r$5647 = SmlPrims.newRequest();
(function(r,m,u,a){return r.open(m,u,a);})(r$5647,"GET",file$5641,false);
z11cymP27JOrM6FBeJkkje$3js$0Js$1.send$652(r$5647,[1]);
var v$5650 = (function(r){return SmlPrims.option(r.responseText);})(r$5647);
switch (v$5650[0]) { case 0: {t$8288 = v$5650[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"serverGet failed on file " + file$5641];
} };
staff$2670 = (t$8289(t$8288));
} catch(v$8283) {staff$2670 = ((function(v$2674){var t$8290 = v$2674;
if (t$8290[0] == sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52) {var msg$2671 = v$2674[1];
var s$5652 = "Failed to load data/staff.json file: " + msg$2671;
var log$5653;
var v$5655 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"log");
switch (v$5655[0]) { case 0: {log$5653 = v$5655[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'log' in DOM"];
} };
(function(e,a){return e.appendChild(a);})(log$5653,document.createTextNode(s$5652));
(function(e,a){return e.appendChild(a);})(log$5653,document.createElement("br"));
return null;
} else {throw v$2674;
};
})(v$8283));
};
var v$5680 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"screen");
switch (v$5680[0]) { case 0: {v$5680[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'screen' in DOM"];
} };
var screenStrips$2677;
var xs$5663;
var fix$8291 = {};
fix$8291.$loop = function(i$5684){if (i$5684 >= screenWidth$959) {return null;
} else {var strip$5685 = document.createElement("img");
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(strip$5685,"style"),"position","absolute");
(function(fp,s,v){fp[s] = v;})(strip$5685,"src","walls.png");
var stripdata$5694;
var t$8293 = strip$5685;
var t$8292;
var v$5695 = [-1];
var v$5696 = [-1];
var v$5697 = [-1];
var v$5698 = [-1];
var v$5699 = [""];
var v$5700 = [-1];
t$8292 = [v$5699,v$5696,v$5697,["walls.png"],v$5698,v$5695,v$5700];
stripdata$5694 = [t$8293,t$8292];
var v$7363 = stripdata$5694[1];
var r$7365 = v$7363[1];
if (r$7365[0] == 0) {0;
} else {var v$7366 = (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(0)) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(strip$5685,"style"),"height",v$7366);
(r$7365[0] = 0,0);
};
var v$7370 = stripdata$5694[1];
var r$7372 = v$7370[2];
if (r$7372[0] == 0) {0;
} else {var v$7373 = (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(0)) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(strip$5685,"style"),"left",v$7373);
(r$7372[0] = 0,0);
};
var v$7377 = stripdata$5694[1];
var r$7379 = v$7377[4];
if (r$7379[0] == 0) {0;
} else {var v$7380 = (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(0)) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(strip$5685,"style"),"top",v$7380);
(r$7379[0] = 0,0);
};
var t$8294;
var v$5703 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"screen");
switch (v$5703[0]) { case 0: {t$8294 = v$5703[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'screen' in DOM"];
} };
(function(e,a){return e.appendChild(a);})(t$8294,strip$5685);
return [stripdata$5694,fix$8291.$loop(SmlPrims.chk_ovf_i32(i$5684 + 1))];
};
};
var loop$5683 = fix$8291.$loop;
xs$5663 = (loop$5683(0));
var fix$8295 = {};
fix$8295.$init = function(v$7762,v$7763,v$7764){lab$init: while (true) {if (v$7762 == null) {return v$7763;
} else {var v$5668 = v$7762;
var v$5669 = v$5668[0];
var v$5670 = v$5668[1];
(v$7763[v$7764] = v$5669,0);
var t$8296 = v$5670;
var t$8297 = v$7763;
var t$8298 = SmlPrims.chk_ovf_i32(v$7764 + 1);
var v$7762 = t$8296;
var v$7763 = t$8297;
var v$7764 = t$8298;
continue lab$init;
};
};
};
var init$5664 = fix$8295.$init;
var t$8304 = init$5664;
var t$8303 = xs$5663;
var t$8302;
var n$5672;
var fix$8299 = {};
fix$8299.$acc = function(v$5674,v$5675){lab$acc: while (true) {if (v$5674 == null) {return v$5675;
} else {var t$8300 = v$5674[1];
var t$8301 = SmlPrims.chk_ovf_i32(v$5675 + 1);
var v$5674 = t$8300;
var v$5675 = t$8301;
continue lab$acc;
};
};
};
var acc$5673 = fix$8299.$acc;
n$5672 = (acc$5673(xs$5663,0));
if ((0 <= n$5672)?(n$5672 <= 123456789):false) {0;
} else {throw CompilerInitial.exn$Size$51;
};
t$8302 = (Array(n$5672));
screenStrips$2677 = (t$8304(t$8303,t$8302,0));
var spriteMap$2678 = init$1072(Y5y0a7l58ITwhpccCWLDEa$3basis$0Array2$1.foldi$383(0,function(v$7852){var v$7853 = v$7852[0];
var v$7854 = v$7852[1];
var v$7855 = v$7852[2];
var v$7856 = v$7852[3];
var v$7857;
switch (v$7855[0]) { case 8: {var v$7858 = v$7855[1];
v$7857 = [0,v$7858];
 break; }default: {v$7857 = [1];
} };
switch (v$7857[0]) { case 0: {return [[v$7857[1],v$7854,v$7853],v$7856];
 break; }default: {return v$7856;
} };
},null,v$2700,0,0,[1],[1]));
var displayContent$2679 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.map$695(function(sid$2682){var v$2684 = [0];
var t$8306;
var t$8305;
var v$5718 = dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.find$390(function(v$5719){return v$5719[1] == sid$2682;
},staff$2670);
switch (v$5718[0]) { case 0: {var v$5724 = v$5718[1];
var v$5725 = v$5724[4];
t$8305 = ((v$5725 == null)?"default":v$5725[0][0]);
 break; }default: {t$8305 = "default";
} };
t$8306 = [t$8305];
return [t$8306,sid$2682,v$2684];
},v$2701);
bindKeys$1174(staff$2670,displayContent$2679);
drawMiniMap$1682();
gameCycle$2423(spriteMap$2678);
return renderCycle$2572(displayContent$2679,screenStrips$2677,spriteMap$2678);
};
(function(a){return window.onload=a;})(function(v$7686){return init$2667();
});
return 0;
})();
