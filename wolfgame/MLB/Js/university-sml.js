if ((typeof(h9AP67nN46MQi5f2NQrocNd$3university$0university$1)) == "undefined") {h9AP67nN46MQi5f2NQrocNd$3university$0university$1 = {};
};
(function(){h9AP67nN46MQi5f2NQrocNd$3university$0university$1.eq_lang$1890 = function(v$4525,v$4526){return v$4525 == v$4526;
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.eq_sprite$1894 = function(v$4527,v$4528){return v$4527 == v$4528;
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.eq_obj$1898 = function(v$4529,v$4530){if (v$4529 == v$4530) {return true;
} else {switch (v$4529[0]) { case 8: {switch (v$4530[0]) { case 8: {return v$4529[1] == v$4530[1];
 break; }default: {return false;
} };
 break; }case 0: {switch (v$4530[0]) { case 0: {return true;
 break; }default: {return false;
} };
 break; }case 1: {switch (v$4530[0]) { case 1: {return true;
 break; }default: {return false;
} };
 break; }case 2: {switch (v$4530[0]) { case 2: {return true;
 break; }default: {return false;
} };
 break; }case 3: {switch (v$4530[0]) { case 3: {return true;
 break; }default: {return false;
} };
 break; }case 4: {switch (v$4530[0]) { case 4: {return true;
 break; }default: {return false;
} };
 break; }case 5: {switch (v$4530[0]) { case 5: {return true;
 break; }default: {return false;
} };
 break; }case 6: {switch (v$4530[0]) { case 6: {return true;
 break; }default: {return false;
} };
 break; }case 7: {switch (v$4530[0]) { case 7: {return true;
 break; }default: {return false;
} };
 break; }case 9: {switch (v$4530[0]) { case 9: {return true;
 break; }default: {return false;
} };
 break; }case 10: {switch (v$4530[0]) { case 10: {return true;
 break; }default: {return false;
} };
 break; }case 11: {switch (v$4530[0]) { case 11: {return true;
 break; }default: {return false;
} };
 break; }case 12: {switch (v$4530[0]) { case 12: {return true;
 break; }default: {return false;
} };
 break; }case 13: {switch (v$4530[0]) { case 13: {return true;
 break; }default: {return false;
} };
 break; }case 14: {switch (v$4530[0]) { case 14: {return true;
 break; }default: {return false;
} };
 break; } };
};
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.loadStaff$60 = function(data$63){var jsonToStaff$165 = function(j$168){switch (j$168[0]) { case 2: {var v$180 = j$168[1];
var v$175;
var v$2063;
var v$2066 = DNzgidgaaiBsxwxK6Q4Ukm$3json$0json$1.objLook$96(v$180,"id");
switch (v$2066[0]) { case 0: {v$2063 = v$2066[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find  json object id in staff.json"];
} };
switch (v$2063[0]) { case 0: {v$175 = v$2063[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find string json object id in staff.json"];
} };
var v$176;
var v$2079;
var v$2082 = DNzgidgaaiBsxwxK6Q4Ukm$3json$0json$1.objLook$96(v$180,"name");
switch (v$2082[0]) { case 0: {v$2079 = v$2082[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find  json object name in staff.json"];
} };
switch (v$2079[0]) { case 0: {v$176 = v$2079[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find string json object name in staff.json"];
} };
var t$4697;
var v$2095;
var v$2098 = DNzgidgaaiBsxwxK6Q4Ukm$3json$0json$1.objLook$96(v$180,"avatar");
switch (v$2098[0]) { case 0: {v$2095 = v$2098[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find  json object avatar in staff.json"];
} };
switch (v$2095[0]) { case 0: {t$4697 = v$2095[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find string json object avatar in staff.json"];
} };
var t$4696 = v$175;
var t$4695 = v$176;
var t$4694;
var v$2111;
var v$2114 = DNzgidgaaiBsxwxK6Q4Ukm$3json$0json$1.objLook$96(v$180,"office");
switch (v$2114[0]) { case 0: {v$2111 = v$2114[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find  json object office in staff.json"];
} };
switch (v$2111[0]) { case 0: {t$4694 = v$2111[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find string json object office in staff.json"];
} };
var t$4685;
var v$4240;
var v$4241 = DNzgidgaaiBsxwxK6Q4Ukm$3json$0json$1.objLook$96(v$180,"slides");
switch (v$4241[0]) { case 0: {v$4240 = v$4241[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find  json object slides in staff.json"];
} };
switch (v$4240[0]) { case 6: {var v$4242 = v$4240[1];
var v$4260 = null;
var fix$4686 = {};
fix$4686.$foldr = function(v$4262){if (v$4262 == null) {return v$4260;
} else {var v$4263 = v$4262;
var v$4264 = v$4263[0];
var v$4265 = v$4263[1];
var v$4454 = fix$4686.$foldr(v$4265);
switch (v$4264[0]) { case 2: {var v$4269 = v$4264[1];
var t$4693;
var t$4692;
var t$4691;
var v$4270;
var v$4271 = DNzgidgaaiBsxwxK6Q4Ukm$3json$0json$1.objLook$96(v$4269,"is");
switch (v$4271[0]) { case 0: {v$4270 = v$4271[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find  json object is in staff.json"];
} };
switch (v$4270[0]) { case 0: {t$4691 = v$4270[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find string json object is in staff.json"];
} };
var t$4690;
var v$4272 = DNzgidgaaiBsxwxK6Q4Ukm$3json$0json$1.objLook$96(v$4269,"lang");
switch (v$4272[0]) { case 0: {var v$4273 = v$4272[1];
switch (v$4273[0]) { case 0: {switch (v$4273[1]) { case "EN": {t$4690 = [0,0];
 break; }case "en": {t$4690 = [0,0];
 break; }case "DA": {t$4690 = [0,1];
 break; }case "da": {t$4690 = [0,1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find da or en json object lang in staff.json"];
} };
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find da or en json object lang in staff.json"];
} };
 break; }default: {t$4690 = [1];
} };
var t$4689;
var v$4274;
var t$4688 = abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.fromString$460;
var t$4687;
var v$4275;
var v$4276 = DNzgidgaaiBsxwxK6Q4Ukm$3json$0json$1.objLook$96(v$4269,"pages");
switch (v$4276[0]) { case 0: {v$4275 = v$4276[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find  json object pages in staff.json"];
} };
switch (v$4275[0]) { case 0: {t$4687 = v$4275[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find string json object pages in staff.json"];
} };
v$4274 = (t$4688(t$4687));
switch (v$4274[0]) { case 0: {t$4689 = v$4274[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find int json object pages in staff.json"];
} };
t$4692 = [t$4691,t$4690,t$4689];
t$4693 = [t$4692,v$4454];
return t$4693;
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find ARRAY OBJECT json object slides in staff.json"];
} };
};
};
var foldr$4261 = fix$4686.$foldr;
t$4685 = (foldr$4261(v$4242));
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find ARRAY json object slides in staff.json"];
} };
return [t$4697,t$4696,t$4695,t$4694,t$4685];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"Failed to find OBJECT json object ARRAY in staff.json"];
} };
};
return DNzgidgaaiBsxwxK6Q4Ukm$3json$0json$1.foldlArrayJson$963(function(v$184){var v$185 = v$184[0];
var v$186 = v$184[1];
return [jsonToStaff$165(v$185),v$186];
},null,data$63);
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.ppInt$187 = function(i$190){if (i$190 < 0) {return "-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(i$190))));
} else {return abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(i$190);
};
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.s$d$195 = function(id$198){var v$203 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,id$198);
switch (v$203[0]) { case 0: {return v$203[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,("no element with id '" + id$198) + "' in DOM"];
} };
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.println$206 = function(s$209){return EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161(s$209 + "\n");
};
h9AP67nN46MQi5f2NQrocNd$3university$0university$1.serverGet$210 = function(file$213){var file$214;
var t$4701 = file$213 + "?_=";
var t$4700;
var t$4699 = y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.toString$158;
var t$4698;
var v$2139 = SmlPrims.getrealtime();
var v$2140 = v$2139[0];
var v$2141 = v$2139[1];
t$4698 = ((v$2140 - (-2147483648)) + (v$2141 / 1000000.0));
t$4700 = (t$4699(t$4698));
file$214 = (t$4701 + t$4700);
var r$215 = SmlPrims.newRequest();
(function(r,m,u,a){return r.open(m,u,a);})(r$215,"GET",file$214,false);
z11cymP27JOrM6FBeJkkje$3js$0Js$1.send$652(r$215,[1]);
var v$222 = (function(r){return SmlPrims.option(r.responseText);})(r$215);
switch (v$222[0]) { case 0: {return v$222[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"serverGet failed on file " + file$214];
} };
};
var screenWidth$230 = SmlPrims.div_i32(1600,2,CompilerInitial.exn$Div$45);
var screenHeight$231 = SmlPrims.div_i32(900,2,CompilerInitial.exn$Div$45);
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<html><head>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<title>Canvas example</title>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<link rel='shortcut icon' type='image/x-icon' href='favicon.ico' />\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<style>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("div#minimapcontainer { position : absolute; width : 100%; }\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161((("canvas#minimap { position : absolute; width : " + ((screenWidth$230 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(screenWidth$230))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(screenWidth$230)))) + "px; }") + "\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161((("canvas#minimapobjects { position : absolute; width : " + ((screenWidth$230 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(screenWidth$230))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(screenWidth$230)))) + "px; }") + "\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("div#floor { position : absolute; width : 100%; height : 100%; background-color : rgb(128,128,128); z-index : -10000000; }\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("div#ceiling { position : absolute; width : 100%; height : 50%; background-color : rgb(96,96,96); z-index : -10000000; }\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161((((("#screen { position : relative; width : " + ((screenWidth$230 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(screenWidth$230))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(screenWidth$230)))) + "px; height : ") + ((screenHeight$231 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(screenHeight$231))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(screenHeight$231)))) + "px; border : 1px solid black; overflow : hidden; }") + "\n");
var t$4710 = EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161;
var t$4709;
var t$4708;
var t$4707;
var t$4706;
var t$4705;
var t$4704 = "div#overlay { position : absolute; display : block; width : ";
var t$4703;
var i$2190 = SmlPrims.chk_ovf_i32(screenWidth$230 - 10);
t$4703 = ((i$2190 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(i$2190))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(i$2190)));
t$4705 = (t$4704 + t$4703);
t$4706 = (t$4705 + "px; height : ");
var t$4702;
var i$2192 = SmlPrims.chk_ovf_i32(screenHeight$231 - 10);
t$4702 = ((i$2192 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(i$2192))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(i$2192)));
t$4707 = (t$4706 + t$4702);
t$4708 = (t$4707 + "px; padding : 5px; color : white; font-family : lucida console, courier new; font-size : 20px; z-index : 1; }");
t$4709 = (t$4708 + "\n");
t$4710(t$4709);
var t$4718 = EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161;
var t$4717;
var t$4716;
var t$4715;
var t$4714;
var t$4713;
var t$4712 = "div#score { position : relative; display : block; width : ";
var t$4711;
var i$2200 = SmlPrims.chk_ovf_i32(screenWidth$230 - 10);
t$4711 = ((i$2200 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(i$2200))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(i$2200)));
t$4713 = (t$4712 + t$4711);
t$4714 = (t$4713 + "px; height : ");
t$4715 = (t$4714 + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(30)));
t$4716 = (t$4715 + "px; padding : 5px; color : blue; font-family : lucida console, courier new; font-size : 20px; z-index : 1; }");
t$4717 = (t$4716 + "\n");
t$4718(t$4717);
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("</style>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("</head><body><center>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<h2>The PLTC Hallway!</h2>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<div id='screen'>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<div id='floor'></div>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<div id='ceiling'></div>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<div id='overlay'></div>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("</div>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<div id='score'> </div>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<div id='minimapcontainer'>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<canvas id='minimap'></canvas>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<canvas id='minimapobjects'></canvas>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("</div>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("<div id='log'></div>\n");
EJ47NxTIZkokCnHI8kSKKb$3basis$0General$1.print$161("</center></body></html>\n");
var Smap$239;
var t$4725 = h7fbaDWer1eD5BCDBpvTxeg$3basis$0String$1.tokens$222;
var t$4724 = function(c$242){return c$242 == 10;
};
var t$4723;
var file$2249;
var t$4722 = "data/gameMap.txt?_=";
var t$4721;
var t$4720 = y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.toString$158;
var t$4719;
var v$2252 = SmlPrims.getrealtime();
var v$2253 = v$2252[0];
var v$2254 = v$2252[1];
t$4719 = ((v$2253 - (-2147483648)) + (v$2254 / 1000000.0));
t$4721 = (t$4720(t$4719));
file$2249 = (t$4722 + t$4721);
var r$2255 = SmlPrims.newRequest();
(function(r,m,u,a){return r.open(m,u,a);})(r$2255,"GET",file$2249,false);
z11cymP27JOrM6FBeJkkje$3js$0Js$1.send$652(r$2255,[1]);
var v$2258 = (function(r){return SmlPrims.option(r.responseText);})(r$2255);
switch (v$2258[0]) { case 0: {t$4723 = v$2258[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"serverGet failed on file " + file$2249];
} };
Smap$239 = (t$4725(t$4724,t$4723));
var Map$332;
try {Map$332 = (Y5y0a7l58ITwhpccCWLDEa$3basis$0Array2$1.fromList$58(dQvcrgdPh2Rb0tWb4ecVml$3basis$0List$1.map$330(function(s$2272){var e$2280 = null;
var fix$4727 = {};
fix$4727.$rl = function(v$4531,v$4532){lab$rl: while (true) {if (v$4531 >= 0) {var t$4731 = SmlPrims.chk_ovf_i32(v$4531 - 1);
var t$4728;
var v$3823 = s$2272.charCodeAt(v$4531);
var t$4730;
var t$4729;
switch (v$3823) { case 32: {t$4729 = [9];
 break; }case 119: {t$4729 = [6];
 break; }case 61: {t$4729 = [5];
 break; }case 37: {t$4729 = [4];
 break; }case 77: {t$4729 = [13];
 break; }case 78: {t$4729 = [12];
 break; }case 97: {t$4729 = [1];
 break; }case 98: {t$4729 = [2];
 break; }case 99: {t$4729 = [0];
 break; }case 42: {t$4729 = [7];
 break; }case 72: {t$4729 = [10];
 break; }case 75: {t$4729 = [11];
 break; }case 79: {t$4729 = [3];
 break; }case 73: {t$4729 = [14];
 break; }case 84: {t$4729 = [8,1];
 break; }case 65: {t$4729 = [8,6];
 break; }case 80: {t$4729 = [8,3];
 break; }case 76: {t$4729 = [8,4];
 break; }case 68: {t$4729 = [8,5];
 break; }case 83: {t$4729 = [8,2];
 break; }case 85: {t$4729 = [8,0];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,("unknown character '" + (h8UYb53cympluUQFSuaSASi$3basis$0Char$1.toString$275(v$3823))) + "'"];
} };
t$4730 = [t$4729,v$4532];
t$4728 = t$4730;
var t$4732 = t$4731;
var t$4733 = t$4728;
var v$4531 = t$4732;
var v$4532 = t$4733;
continue lab$rl;
} else {return v$4532;
};
};
};
var rl$2282 = fix$4727.$rl;
return rl$2282(SmlPrims.chk_ovf_i32(s$2272.length - 1),e$2280);
},Smap$239)));
} catch(v$4726) {Map$332 = ((function(s$m$335){var log$2292;
var v$2294 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"log");
switch (v$2294[0]) { case 0: {log$2292 = v$2294[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'log' in DOM"];
} };
(function(e,a){return e.appendChild(a);})(log$2292,document.createTextNode("error loading map"));
(function(e,a){return e.appendChild(a);})(log$2292,document.createElement("br"));
throw s$m$335;
})(v$4726));
};
var init$416 = function(items$419){var screen$420;
var v$2323 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"screen");
switch (v$2323[0]) { case 0: {screen$420 = v$2323[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'screen' in DOM"];
} };
Map$332[0][0];
var v$4467 = Map$332[0][1];
var v$4468 = Map$332[0][2];
if ((0 <= v$4467)?(v$4467 <= 123456789):false) {0;
} else {throw CompilerInitial.exn$Size$51;
};
var spriteMap$424;
var v$3839 = [1];
var t$4741;
var t$4734;
var t$2333 = Array(v$4467);
var fix$4735 = {};
fix$4735.$init = function(v$4535,v$4536){lab$init: while (true) {if (v$4536 >= v$4467) {return 0;
} else {var t$4738 = v$4535;
var t$4737 = v$4536;
var t$4736;
if ((0 <= v$4468)?(v$4468 <= 123456789):false) {0;
} else {throw CompilerInitial.exn$Size$51;
};
t$4736 = (SmlPrims.wordTableInit(v$4468,v$3839));
(t$4738[t$4737] = t$4736,0);
var t$4739 = v$4535;
var t$4740 = SmlPrims.chk_ovf_i32(v$4536 + 1);
var v$4535 = t$4739;
var v$4536 = t$4740;
continue lab$init;
};
};
};
var init$2334 = fix$4735.$init;
init$2334(t$2333,0);
t$4734 = t$2333;
t$4741 = [t$4734,v$4467,v$4468];
spriteMap$424 = [t$4741];
var fix$4742 = {};
fix$4742.$app = function(v$2352){lab$app: while (true) {if (v$2352 == null) {return 0;
} else {var v$2353 = v$2352;
var v$2354 = v$2353[0];
var v$2355 = v$2353[1];
var v$2389 = v$2354[0];
var v$2390 = v$2354[1];
var v$2391 = v$2354[2];
var s$2392;
var pos$2394 = [v$2390,v$2391];
var e$2395 = document.createElement("img");
var t$4745 = e$2395;
var t$4744 = "src";
var t$4743;
switch (v$2389) { case 1: {t$4743 = "tablechairs.png";
 break; }case 6: {t$4743 = (("professor" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32((SmlPrims.mod_i32(SmlPrims.chk_ovf_i32(pos$2394[0] + pos$2394[1]),4,CompilerInitial.exn$Div$45)) + 1)))) + ".gif");
 break; }case 3: {t$4743 = "plantgreen.png";
 break; }case 4: {t$4743 = "lamp.png";
 break; }case 2: {t$4743 = "sink.png";
 break; }case 5: {t$4743 = "desk.png";
 break; }default: {t$4743 = "toilet.png";
} };
(function(fp,s,v){fp[s] = v;})(t$4745,t$4744,t$4743);
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(e$2395,"style"),"display","none");
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(e$2395,"style"),"position","absolute");
var v$2398;
switch (v$2389) { case 1: {v$2398 = true;
 break; }case 6: {v$2398 = true;
 break; }case 3: {v$2398 = true;
 break; }case 4: {v$2398 = false;
 break; }case 2: {v$2398 = false;
 break; }case 5: {v$2398 = true;
 break; }default: {v$2398 = true;
} };
var v$2399 = [false];
s$2392 = [v$2398,[true],e$2395,pos$2394,v$2399];
var v$3847 = [0,s$2392];
var v$2402 = spriteMap$424[0][0];
spriteMap$424[0][1];
spriteMap$424[0][2];
var v$2404 = v$2402.length;
if ((0 <= v$2391)?(v$2391 < v$2404):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$2407 = v$2402[v$2391];
var v$2408 = v$2407.length;
if ((0 <= v$2390)?(v$2390 < v$2408):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
(v$2407[v$2390] = v$3847,0);
(function(e,a){return e.appendChild(a);})(screen$420,s$2392[2]);
var t$4746 = v$2355;
var v$2352 = t$4746;
continue lab$app;
};
};
};
var app$2351 = fix$4742.$app;
app$2351(items$419);
return spriteMap$424;
};
var MaxRotSpeed$475 = (3.0 * 3.14159265358979323846) / 360.0;
var player$476;
var v$477 = [16.0];
var v$478 = [10.0];
var v$479 = [0.0];
var v$480 = [0.0];
var v$481 = [0.0];
player$476 = [0.10,v$479,[0.0],v$481,v$480,v$477,v$478];
var fov$484 = (60.0 * 3.14159265358979323846) / 180.0;
var fovHalf$485 = fov$484 / 2.0;
var twoPI$486 = 3.14159265358979323846 * 2.0;
var stripWidthR$488 = 1;
var miniMapScaleR$490 = 8;
Map$332[0][0];
Map$332[0][1];
var mapWidth$492 = Map$332[0][2];
var mapWidthR$493 = mapWidth$492;
Map$332[0][0];
var mapHeight$494;
var v$2422 = Map$332[0][1];
Map$332[0][2];
mapHeight$494 = v$2422;
var mapHeightR$495 = mapHeight$494;
var screenWidthR$496 = screenWidth$230;
var screenHeightR$497 = screenHeight$231;
var numRays$498 = SmlPrims.chk_ovf_i32(Math.ceil(screenWidthR$496 / stripWidthR$488));
var viewDist$499 = (screenWidthR$496 / 2.0) / ((Math.sin(fovHalf$485)) / (Math.cos(fovHalf$485)));
var checkCollision$661 = function(spriteMap$664,v$4539,v$4540,v$4541,v$4542,v$4543){if ((v$4542 < 0.0)?true:((v$4542 >= mapHeightR$495)?true:((v$4541 < 0.0)?true:(v$4541 >= mapWidthR$493)))) {return [v$4539,v$4540];
} else {var blockX$676 = SmlPrims.chk_ovf_i32(Math.floor(v$4541));
var blockY$677 = SmlPrims.chk_ovf_i32(Math.floor(v$4542));
var t$4747;
if ((blockY$677 < 0.0)?true:((blockY$677 >= mapHeightR$495)?true:((blockX$676 < 0.0)?true:(blockX$676 >= mapWidthR$493)))) {t$4747 = true;
} else {var Y$4281 = SmlPrims.chk_ovf_i32(Math.floor(blockY$677));
var X$4282 = SmlPrims.chk_ovf_i32(Math.floor(blockX$676));
var wt$4283;
var v$4284 = Map$332[0][0];
Map$332[0][1];
Map$332[0][2];
var v$4285 = v$4284.length;
if ((0 <= Y$4281)?(Y$4281 < v$4285):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$4286 = v$4284[Y$4281];
var v$4287 = v$4286.length;
if ((0 <= X$4282)?(X$4282 < v$4287):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
wt$4283 = v$4286[X$4282];
var t$4748;
switch (wt$4283[0]) { case 9: {t$4748 = false;
 break; }case 8: {t$4748 = false;
 break; }default: {t$4748 = true;
} };
if (t$4748) {t$4747 = true;
} else {var v$4288;
var v$4289 = spriteMap$664[0][0];
spriteMap$664[0][1];
spriteMap$664[0][2];
var v$4290 = v$4289.length;
if ((0 <= Y$4281)?(Y$4281 < v$4290):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$4291 = v$4289[Y$4281];
var v$4292 = v$4291.length;
if ((0 <= X$4282)?(X$4282 < v$4292):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
v$4288 = v$4291[X$4282];
switch (v$4288[0]) { case 0: {t$4747 = v$4288[1][0];
 break; }default: {t$4747 = false;
} };
};
};
if (t$4747) {return [v$4539,v$4540];
} else {var blockTop$683;
var v$4460 = blockY$677 - 1.0;
if ((v$4460 < 0.0)?true:((v$4460 >= mapHeightR$495)?true:((blockX$676 < 0.0)?true:(blockX$676 >= mapWidthR$493)))) {blockTop$683 = true;
} else {var Y$4296 = SmlPrims.chk_ovf_i32(Math.floor(v$4460));
var X$4297 = SmlPrims.chk_ovf_i32(Math.floor(blockX$676));
var wt$4298;
var v$4299 = Map$332[0][0];
Map$332[0][1];
Map$332[0][2];
var v$4300 = v$4299.length;
if ((0 <= Y$4296)?(Y$4296 < v$4300):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$4301 = v$4299[Y$4296];
var v$4302 = v$4301.length;
if ((0 <= X$4297)?(X$4297 < v$4302):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
wt$4298 = v$4301[X$4297];
var t$4749;
switch (wt$4298[0]) { case 9: {t$4749 = false;
 break; }case 8: {t$4749 = false;
 break; }default: {t$4749 = true;
} };
if (t$4749) {blockTop$683 = true;
} else {var v$4303;
var v$4304 = spriteMap$664[0][0];
spriteMap$664[0][1];
spriteMap$664[0][2];
var v$4305 = v$4304.length;
if ((0 <= Y$4296)?(Y$4296 < v$4305):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$4306 = v$4304[Y$4296];
var v$4307 = v$4306.length;
if ((0 <= X$4297)?(X$4297 < v$4307):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
v$4303 = v$4306[X$4297];
switch (v$4303[0]) { case 0: {blockTop$683 = v$4303[1][0];
 break; }default: {blockTop$683 = false;
} };
};
};
var blockBottom$684;
var v$4462 = blockY$677 + 1.0;
if ((v$4462 < 0.0)?true:((v$4462 >= mapHeightR$495)?true:((blockX$676 < 0.0)?true:(blockX$676 >= mapWidthR$493)))) {blockBottom$684 = true;
} else {var Y$4311 = SmlPrims.chk_ovf_i32(Math.floor(v$4462));
var X$4312 = SmlPrims.chk_ovf_i32(Math.floor(blockX$676));
var wt$4313;
var v$4314 = Map$332[0][0];
Map$332[0][1];
Map$332[0][2];
var v$4315 = v$4314.length;
if ((0 <= Y$4311)?(Y$4311 < v$4315):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$4316 = v$4314[Y$4311];
var v$4317 = v$4316.length;
if ((0 <= X$4312)?(X$4312 < v$4317):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
wt$4313 = v$4316[X$4312];
var t$4750;
switch (wt$4313[0]) { case 9: {t$4750 = false;
 break; }case 8: {t$4750 = false;
 break; }default: {t$4750 = true;
} };
if (t$4750) {blockBottom$684 = true;
} else {var v$4318;
var v$4319 = spriteMap$664[0][0];
spriteMap$664[0][1];
spriteMap$664[0][2];
var v$4320 = v$4319.length;
if ((0 <= Y$4311)?(Y$4311 < v$4320):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$4321 = v$4319[Y$4311];
var v$4322 = v$4321.length;
if ((0 <= X$4312)?(X$4312 < v$4322):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
v$4318 = v$4321[X$4312];
switch (v$4318[0]) { case 0: {blockBottom$684 = v$4318[1][0];
 break; }default: {blockBottom$684 = false;
} };
};
};
var blockLeft$685;
var v$4463 = blockX$676 - 1.0;
if ((blockY$677 < 0.0)?true:((blockY$677 >= mapHeightR$495)?true:((v$4463 < 0.0)?true:(v$4463 >= mapWidthR$493)))) {blockLeft$685 = true;
} else {var Y$4326 = SmlPrims.chk_ovf_i32(Math.floor(blockY$677));
var X$4327 = SmlPrims.chk_ovf_i32(Math.floor(v$4463));
var wt$4328;
var v$4329 = Map$332[0][0];
Map$332[0][1];
Map$332[0][2];
var v$4330 = v$4329.length;
if ((0 <= Y$4326)?(Y$4326 < v$4330):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$4331 = v$4329[Y$4326];
var v$4332 = v$4331.length;
if ((0 <= X$4327)?(X$4327 < v$4332):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
wt$4328 = v$4331[X$4327];
var t$4751;
switch (wt$4328[0]) { case 9: {t$4751 = false;
 break; }case 8: {t$4751 = false;
 break; }default: {t$4751 = true;
} };
if (t$4751) {blockLeft$685 = true;
} else {var v$4333;
var v$4334 = spriteMap$664[0][0];
spriteMap$664[0][1];
spriteMap$664[0][2];
var v$4335 = v$4334.length;
if ((0 <= Y$4326)?(Y$4326 < v$4335):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$4336 = v$4334[Y$4326];
var v$4337 = v$4336.length;
if ((0 <= X$4327)?(X$4327 < v$4337):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
v$4333 = v$4336[X$4327];
switch (v$4333[0]) { case 0: {blockLeft$685 = v$4333[1][0];
 break; }default: {blockLeft$685 = false;
} };
};
};
var blockRight$686;
var v$4465 = blockX$676 + 1.0;
if ((blockY$677 < 0.0)?true:((blockY$677 >= mapHeightR$495)?true:((v$4465 < 0.0)?true:(v$4465 >= mapWidthR$493)))) {blockRight$686 = true;
} else {var Y$4341 = SmlPrims.chk_ovf_i32(Math.floor(blockY$677));
var X$4342 = SmlPrims.chk_ovf_i32(Math.floor(v$4465));
var wt$4343;
var v$4344 = Map$332[0][0];
Map$332[0][1];
Map$332[0][2];
var v$4345 = v$4344.length;
if ((0 <= Y$4341)?(Y$4341 < v$4345):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$4346 = v$4344[Y$4341];
var v$4347 = v$4346.length;
if ((0 <= X$4342)?(X$4342 < v$4347):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
wt$4343 = v$4346[X$4342];
var t$4752;
switch (wt$4343[0]) { case 9: {t$4752 = false;
 break; }case 8: {t$4752 = false;
 break; }default: {t$4752 = true;
} };
if (t$4752) {blockRight$686 = true;
} else {var v$4348;
var v$4349 = spriteMap$664[0][0];
spriteMap$664[0][1];
spriteMap$664[0][2];
var v$4350 = v$4349.length;
if ((0 <= Y$4341)?(Y$4341 < v$4350):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$4351 = v$4349[Y$4341];
var v$4352 = v$4351.length;
if ((0 <= X$4342)?(X$4342 < v$4352):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
v$4348 = v$4351[X$4342];
switch (v$4348[0]) { case 0: {blockRight$686 = v$4348[1][0];
 break; }default: {blockRight$686 = false;
} };
};
};
var toY$687 = (blockTop$683?((v$4542 - blockY$677) < v$4543):false)?(blockY$677 + v$4543):((blockBottom$684?(((blockY$677 + 1.0) - v$4542) < v$4543):false)?((blockY$677 + 1.0) - v$4543):v$4542);
return [(blockLeft$685?((v$4541 - blockX$676) < v$4543):false)?(blockX$676 + v$4543):((blockRight$686?(((blockX$676 + 1.0) - v$4541) < v$4543):false)?((blockX$676 + 1.0) - v$4543):v$4541),toY$687];
};
};
};
var drawMiniMap$955 = function(){var miniMap$962;
var v$2619 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"minimap");
switch (v$2619[0]) { case 0: {miniMap$962 = v$2619[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'minimap' in DOM"];
} };
var miniMapCtr$963;
var v$2625 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"minimapcontainer");
switch (v$2625[0]) { case 0: {miniMapCtr$963 = v$2625[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'minimapcontainer' in DOM"];
} };
var miniMapObjects$964;
var v$2631 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"minimapobjects");
switch (v$2631[0]) { case 0: {miniMapObjects$964 = v$2631[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'minimapobjects' in DOM"];
} };
var w$965 = SmlPrims.chk_ovf_i32(mapWidth$492 * 8);
var h$966 = SmlPrims.chk_ovf_i32(mapHeight$494 * 8);
(function(fp,s,v){fp[s] = v;})(miniMap$962,"width",w$965);
(function(fp,s,v){fp[s] = v;})(miniMap$962,"height",h$966);
(function(fp,s,v){fp[s] = v;})(miniMapObjects$964,"width",w$965);
(function(fp,s,v){fp[s] = v;})(miniMapObjects$964,"height",h$966);
(function(fp,s,v){fp[s] = v;})(miniMapCtr$963,"width",w$965);
(function(fp,s,v){fp[s] = v;})(miniMapCtr$963,"height",h$966);
var w_s$973 = ((w$965 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(w$965))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(w$965))) + "px";
var h_s$974 = ((h$966 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(h$966))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(h$966))) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(miniMap$962,"style"),"width",w_s$973);
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(miniMapObjects$964,"style"),"width",w_s$973);
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(miniMapCtr$963,"style"),"width",w_s$973);
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(miniMap$962,"style"),"height",h_s$974);
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(miniMapObjects$964,"style"),"height",h_s$974);
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(miniMapCtr$963,"style"),"height",h_s$974);
var c$981 = (function(e,s){return e.getContext(s);})(miniMap$962,"2d");
var entireMap$982 = function(v$4684){return [Map$332,0,[1],[1],0];
};
Y5y0a7l58ITwhpccCWLDEa$3basis$0Array2$1.appi$512(0,function(v$4605){var v$4606 = v$4605[0];
var v$4607 = v$4605[1];
var v$4608 = v$4605[2];
var t$4753;
switch (v$4608[0]) { case 9: {t$4753 = false;
 break; }case 8: {t$4753 = false;
 break; }default: {t$4753 = true;
} };
if (t$4753) {(function(c,s){c.fillStyle = s;})(c$981,"rgb(200,200,200)");
return (function(c,a1,a2,a3,a4){c.fillRect(a1,a2,a3,a4);})(c$981,SmlPrims.chk_ovf_i32(v$4607 * 8),SmlPrims.chk_ovf_i32(v$4606 * 8),8,8);
} else {return 0;
};
},(entireMap$982(0))[0],(entireMap$982(0))[4],(entireMap$982(0))[1],(entireMap$982(0))[3],(entireMap$982(0))[2]);
var miniMap$4354;
var v$4355 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"minimap");
switch (v$4355[0]) { case 0: {miniMap$4354 = v$4355[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'minimap' in DOM"];
} };
var miniMapObjects$4356;
var v$4357 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"minimapobjects");
switch (v$4357[0]) { case 0: {miniMapObjects$4356 = v$4357[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'minimapobjects' in DOM"];
} };
var height$4358 = (function(fp,s){return fp[s];})(miniMap$4354,"height");
var width$4359 = (function(fp,s){return fp[s];})(miniMap$4354,"width");
var c$4360 = (function(e,s){return e.getContext(s);})(miniMapObjects$4356,"2d");
(function(c,a1,a2,a3,a4){c.clearRect(a1,a2,a3,a4);})(c$4360,0,0,width$4359,height$4358);
(function(c,a1,a2,a3,a4){c.fillRect(a1,a2,a3,a4);})(c$4360,y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615((player$476[5][0] * miniMapScaleR$490) - 2.0),y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615((player$476[6][0] * miniMapScaleR$490) - 2.0),4,4);
(function(c){c.beginPath();})(c$4360);
(function(c,a1,a2){c.moveTo(a1,a2);})(c$4360,y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615(player$476[5][0] * miniMapScaleR$490),y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615(player$476[6][0] * miniMapScaleR$490));
(function(c,a1,a2){c.lineTo(a1,a2);})(c$4360,y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615((player$476[5][0] + (Math.cos(player$476[1][0]))) * miniMapScaleR$490),y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615((player$476[6][0] + (Math.sin(player$476[1][0]))) * miniMapScaleR$490));
(function(c){c.closePath();})(c$4360);
return (function(c){c.stroke();})(c$4360);
};
var castSingleRay$1135;
var fix$4754 = {};
fix$4754.$RealMod = function(v$4544,v$4545){lab$RealMod: while (true) {if (v$4544 < v$4545) {return v$4544;
} else {var t$4755 = v$4544 - v$4545;
var t$4756 = v$4545;
var v$4544 = t$4755;
var v$4545 = t$4756;
continue lab$RealMod;
};
};
};
var RealMod$1017 = fix$4754.$RealMod;
castSingleRay$1135 = (function(screenStrips$1138){return function(spriteMap$1141){return function(v$1146){var v$1594 = v$1146[0];
var v$1595 = v$1146[1];
var v$1596 = v$1146[2];
var rayAngle$1147 = RealMod$1017(v$1594,twoPI$486);
var rayAngle$1148 = (rayAngle$1147 < 0.0)?(rayAngle$1147 + twoPI$486):rayAngle$1147;
var right$1153 = (rayAngle$1148 > (twoPI$486 * 0.75))?true:(rayAngle$1148 < (twoPI$486 * 0.25));
var up$1158 = (rayAngle$1148 < 0.0)?true:(rayAngle$1148 > 3.14159265358979323846);
var angleSin$1163 = Math.sin(rayAngle$1148);
var angleCos$1164 = Math.cos(rayAngle$1148);
var slope$1165 = angleSin$1163 / angleCos$1164;
var dXVer$1166 = right$1153?1.0:(-1.0);
var dYVer$1171 = dXVer$1166 * slope$1165;
var x$1172 = right$1153?(SmlPrims.chk_ovf_i32(Math.ceil(player$476[5][0]))):(SmlPrims.chk_ovf_i32(Math.floor(player$476[5][0])));
var x$1185 = x$1172;
var y$1186 = player$476[6][0] + ((x$1185 - player$476[5][0]) * slope$1165);
var emptyHit$1195 = [0.0,false,0.0,[9],0.0,0,0.0,0];
var v$1591;
var fix$4757 = {};
fix$4757.$loopV = function(v$4548,v$4549,visibleSprites$1211){lab$loopV: while (true) {if ((v$4548 < 0.0)?true:((v$4548 >= mapWidthR$493)?true:((v$4549 < 0.0)?true:(v$4549 >= mapHeightR$495)))) {return [emptyHit$1195,visibleSprites$1211];
} else {var wallX$1216 = SmlPrims.chk_ovf_i32(Math.floor(right$1153?v$4548:(v$4548 - 1.0)));
var wallY$1221 = SmlPrims.chk_ovf_i32(Math.floor(v$4549));
var wt$1222;
var v$2850 = Map$332[0][0];
Map$332[0][1];
Map$332[0][2];
var v$2852 = v$2850.length;
if ((0 <= wallY$1221)?(wallY$1221 < v$2852):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$2854 = v$2850[wallY$1221];
var v$2855 = v$2854.length;
if ((0 <= wallX$1216)?(wallX$1216 < v$2855):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
wt$1222 = v$2854[wallX$1216];
var t$4758;
switch (wt$1222[0]) { case 9: {t$4758 = false;
 break; }case 8: {t$4758 = false;
 break; }default: {t$4758 = true;
} };
if (t$4758) {var distX$1227 = v$4548 - player$476[5][0];
var distY$1232 = v$4549 - player$476[6][0];
var dist$1237 = (distX$1227 * distX$1227) + (distY$1232 * distY$1232);
var textureX$1238 = v$4549 - (SmlPrims.chk_ovf_i32(Math.floor(v$4549)));
var textureX$1239 = (right$1153?false:true)?(1.0 - textureX$1238):textureX$1238;
return [[dist$1237,(rayAngle$1148 < (3.14159265358979323846 / 2.0))?true:(rayAngle$1148 > ((3.0 * 3.14159265358979323846) / 2.0)),textureX$1239,wt$1222,v$4548,wallX$1216,v$4549,wallY$1221],visibleSprites$1211];
} else {var t$4761 = v$4548 + dXVer$1166;
var t$4760 = v$4549 + dYVer$1171;
var t$4759;
var v$1261;
var v$2866 = spriteMap$1141[0][0];
spriteMap$1141[0][1];
spriteMap$1141[0][2];
var v$2868 = v$2866.length;
if ((0 <= wallY$1221)?(wallY$1221 < v$2868):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$2870 = v$2866[wallY$1221];
var v$2871 = v$2870.length;
if ((0 <= wallX$1216)?(wallX$1216 < v$2871):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
v$1261 = v$2870[wallX$1216];
switch (v$1261[0]) { case 1: {t$4759 = visibleSprites$1211;
 break; }default: {var v$1276 = v$1261[1];
if (v$1276[4][0]) {t$4759 = visibleSprites$1211;
} else {(v$1276[4][0] = true,0);
t$4759 = [v$1276,visibleSprites$1211];
};
} };
var t$4762 = t$4761;
var t$4763 = t$4760;
var t$4764 = t$4759;
var v$4548 = t$4762;
var v$4549 = t$4763;
var visibleSprites$1211 = t$4764;
continue lab$loopV;
};
};
};
};
var loopV$1204 = fix$4757.$loopV;
v$1591 = (loopV$1204(x$1185,y$1186,v$1596));
var v$1592 = v$1591[0];
var v$1593 = v$1591[1];
var slope$1294 = angleCos$1164 / angleSin$1163;
var dYHor$1295 = up$1158?(-1.0):1.0;
var dXHor$1300 = dYHor$1295 * slope$1294;
var y$1301 = up$1158?(SmlPrims.chk_ovf_i32(Math.floor(player$476[6][0]))):(SmlPrims.chk_ovf_i32(Math.ceil(player$476[6][0])));
var x$1314 = player$476[5][0] + ((y$1301 - player$476[6][0]) * slope$1294);
var v$1580;
var fix$4765 = {};
fix$4765.$loopH = function(v$4552,v$4553,visibleSprites$1330){lab$loopH: while (true) {if ((v$4552 < 0.0)?true:((v$4552 >= mapWidthR$493)?true:((v$4553 < 0.0)?true:((v$4553 >= mapHeightR$495)?true:((slope$1294 > 10000.0)?true:(up$1158?((v$4553 - 1.0) < 0.0):false)))))) {return [v$1592,visibleSprites$1330];
} else {var wallY$1335 = SmlPrims.chk_ovf_i32(Math.floor(up$1158?(v$4553 - 1.0):v$4553));
var wallX$1340 = SmlPrims.chk_ovf_i32(Math.floor(v$4552));
var wt$1341;
try {var v$2886 = Map$332[0][0];
Map$332[0][1];
Map$332[0][2];
var v$2888 = v$2886.length;
if ((0 <= wallY$1335)?(wallY$1335 < v$2888):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$2890 = v$2886[wallY$1335];
var v$2891 = v$2890.length;
if ((0 <= wallX$1340)?(wallX$1340 < v$2891):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
wt$1341 = v$2890[wallX$1340];
} catch(v$4766) {wt$1341 = (((function(env$4771){return function(s$m$1344){var v$4767 = env$4771[0];
var v$4768 = env$4771[1];
var v$4769 = env$4771[2];
var v$4770 = env$4771[3];
var s$2892 = (("wallX = " + ((v$4770 < 0)?("-" + (v$4769(SmlPrims.chk_ovf_i32(-(v$4770))))):(v$4769(v$4770)))) + "; wallY = ") + ((v$4768 < 0)?("-" + (v$4769(SmlPrims.chk_ovf_i32(-(v$4768))))):(v$4769(v$4768)));
var log$2893;
var v$2895 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(v$4767,"log");
switch (v$2895[0]) { case 0: {log$2893 = v$2895[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'log' in DOM"];
} };
(function(e,a){return e.appendChild(a);})(log$2893,document.createTextNode(s$2892));
(function(e,a){return e.appendChild(a);})(log$2893,document.createElement("br"));
throw s$m$1344;
};
})([z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,wallY$1335,abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456,wallX$1340]))(v$4766));
};
var t$4772;
switch (wt$1341[0]) { case 9: {t$4772 = false;
 break; }case 8: {t$4772 = false;
 break; }default: {t$4772 = true;
} };
if (t$4772) {var distX$1351 = v$4552 - player$476[5][0];
var distY$1356 = v$4553 - player$476[6][0];
var blockDist$1361 = (distX$1351 * distX$1351) + (distY$1356 * distY$1356);
if (((v$1592[0] > 0.0)?false:true)?true:(blockDist$1361 < v$1592[0])) {var textureX$1366 = v$4552 - (SmlPrims.chk_ovf_i32(Math.floor(v$4552)));
return [[blockDist$1361,rayAngle$1148 < 3.14159265358979323846,1.0 - (up$1158?(1.0 - textureX$1366):textureX$1366),wt$1341,v$4552,wallX$1340,v$4553,wallY$1335],visibleSprites$1330];
} else {return [v$1592,visibleSprites$1330];
};
} else {var t$4775 = v$4552 + dXHor$1300;
var t$4774 = v$4553 + dYHor$1295;
var t$4773;
var v$1398;
var v$2917 = spriteMap$1141[0][0];
spriteMap$1141[0][1];
spriteMap$1141[0][2];
var v$2919 = v$2917.length;
if ((0 <= wallY$1335)?(wallY$1335 < v$2919):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var v$2921 = v$2917[wallY$1335];
var v$2922 = v$2921.length;
if ((0 <= wallX$1340)?(wallX$1340 < v$2922):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
v$1398 = v$2921[wallX$1340];
switch (v$1398[0]) { case 1: {t$4773 = visibleSprites$1330;
 break; }default: {var v$1413 = v$1398[1];
if (v$1413[4][0]) {t$4773 = visibleSprites$1330;
} else {(v$1413[4][0] = true,0);
t$4773 = [v$1413,visibleSprites$1330];
};
} };
var t$4776 = t$4775;
var t$4777 = t$4774;
var t$4778 = t$4773;
var v$4552 = t$4776;
var v$4553 = t$4777;
var visibleSprites$1330 = t$4778;
continue lab$loopH;
};
};
};
};
var loopH$1323 = fix$4765.$loopH;
v$1580 = (loopH$1323(x$1314,y$1301,v$1593));
var v$1581 = v$1580[0];
var v$1582 = v$1581[0];
var v$1585 = v$1581[5];
var v$1586 = v$1581[7];
var v$1587 = v$1581[3];
var v$1588 = v$1581[2];
var v$1589 = v$1581[1];
var v$1590 = v$1580[1];
if (v$1582 <= 0.0) {return v$1590;
} else {var dist$1454 = Math.sqrt(v$1582);
var dist$1455 = dist$1454 * (Math.cos(player$476[1][0] - rayAngle$1148));
var height$1460 = y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615(viewDist$499 / dist$1455);
var width$1461 = SmlPrims.chk_ovf_i32(height$1460 * 1);
var widthR$1462 = width$1461;
var heightR$1463 = height$1460;
var top$1464 = y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615((screenHeightR$497 - heightR$1463) / 2.0);
var texX$1465 = y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615(v$1588 * widthR$1462);
var texX$1466 = (texX$1465 > (SmlPrims.chk_ovf_i32(width$1461 - 1)))?(SmlPrims.chk_ovf_i32(width$1461 - 1)):texX$1465;
var v$2935 = screenStrips$1138.length;
if ((0 <= v$1595)?(v$1595 < v$2935):false) {0;
} else {throw CompilerInitial.exn$Subscript$50;
};
var stripdata$1471 = screenStrips$1138[v$1595];
var wallType$1472;
if (v$1589) {switch (v$1587[0]) { case 13: {wallType$1472 = [12];
 break; }case 12: {wallType$1472 = [13];
 break; }default: {wallType$1472 = v$1587;
} };
} else {wallType$1472 = v$1587;
};
var v$1521;
switch (wallType$1472[0]) { case 13: {var v$2937 = stripdata$1471[0];
var v$2938 = stripdata$1471[1];
var r$2940 = v$2938[3];
if (r$2940[0] == "datoek-000.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$2937,"src","datoek-000.png");
(r$2940[0] = "datoek-000.png",0);
};
v$1521 = [1,0,texX$1466,2.0];
 break; }case 12: {var v$2950 = stripdata$1471[0];
var v$2951 = stripdata$1471[1];
var r$2953 = v$2951[3];
if (r$2953[0] == "datoek-000.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$2950,"src","datoek-000.png");
(r$2953[0] = "datoek-000.png",0);
};
v$1521 = [1,0,SmlPrims.chk_ovf_i32(texX$1466 + width$1461),2.0];
 break; }case 1: {var v$2963 = stripdata$1471[0];
var v$2964 = stripdata$1471[1];
var r$2966 = v$2964[3];
if (r$2966[0] == "window-left.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$2963,"src","window-left.png");
(r$2966[0] = "window-left.png",0);
};
v$1521 = [1,0,texX$1466,1.0];
 break; }case 2: {var v$2976 = stripdata$1471[0];
var v$2977 = stripdata$1471[1];
var r$2979 = v$2977[3];
if (r$2979[0] == "window-center.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$2976,"src","window-center.png");
(r$2979[0] = "window-center.png",0);
};
v$1521 = [1,0,texX$1466,1.0];
 break; }case 0: {var v$2989 = stripdata$1471[0];
var v$2990 = stripdata$1471[1];
var r$2992 = v$2990[3];
if (r$2992[0] == "window-right.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$2989,"src","window-right.png");
(r$2992[0] = "window-right.png",0);
};
v$1521 = [1,0,texX$1466,1.0];
 break; }case 7: {var v$3002 = stripdata$1471[0];
var v$3003 = stripdata$1471[1];
var r$3005 = v$3003[3];
if (r$3005[0] == "wall-white.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$3002,"src","wall-white.png");
(r$3005[0] = "wall-white.png",0);
};
v$1521 = [1,0,texX$1466,1.0];
 break; }case 10: {var v$3015 = stripdata$1471[0];
var v$3016 = stripdata$1471[1];
var r$3018 = v$3016[3];
if (r$3018[0] == "wall-shelf1.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$3015,"src","wall-shelf1.png");
(r$3018[0] = "wall-shelf1.png",0);
};
v$1521 = [1,0,texX$1466,1.0];
 break; }case 11: {var v$3028 = stripdata$1471[0];
var v$3029 = stripdata$1471[1];
var r$3031 = v$3029[3];
if (r$3031[0] == "wall-shelf2.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$3028,"src","wall-shelf2.png");
(r$3031[0] = "wall-shelf2.png",0);
};
v$1521 = [1,0,texX$1466,1.0];
 break; }case 3: {var v$3041 = stripdata$1471[0];
var v$3042 = stripdata$1471[1];
var r$3044 = v$3042[3];
if (r$3044[0] == "wall-board.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$3041,"src","wall-board.png");
(r$3044[0] = "wall-board.png",0);
};
v$1521 = [1,0,texX$1466,1.0];
 break; }case 14: {var v$3054 = stripdata$1471[0];
var v$3055 = stripdata$1471[1];
var r$3057 = v$3055[3];
if (r$3057[0] == "wall-bulletin.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$3054,"src","wall-bulletin.png");
(r$3057[0] = "wall-bulletin.png",0);
};
v$1521 = [1,0,texX$1466,1.0];
 break; }case 6: {var v$3067 = stripdata$1471[0];
var v$3068 = stripdata$1471[1];
var r$3070 = v$3068[3];
if (r$3070[0] == "walls.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$3067,"src","walls.png");
(r$3070[0] = "walls.png",0);
};
v$1521 = [4,0,texX$1466,2.0];
 break; }case 5: {var v$3080 = stripdata$1471[0];
var v$3081 = stripdata$1471[1];
var r$3083 = v$3081[3];
if (r$3083[0] == "walls.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$3080,"src","walls.png");
(r$3083[0] = "walls.png",0);
};
v$1521 = [4,1,texX$1466,2.0];
 break; }case 4: {var v$3093 = stripdata$1471[0];
var v$3094 = stripdata$1471[1];
var r$3096 = v$3094[3];
if (r$3096[0] == "walls.png") {0;
} else {(function(e,a,b){return e.setAttribute(a,b);})(v$3093,"src","walls.png");
(r$3096[0] = "walls.png",0);
};
v$1521 = [4,2,texX$1466,2.0];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"obj not supported"];
} };
var v$1522 = v$1521[0];
var v$1523 = v$1521[1];
var v$1524 = v$1521[2];
var v$1525 = v$1521[3];
var v$4372 = stripdata$1471[0];
var v$4373 = stripdata$1471[1];
var r$4375 = v$4373[1];
if (r$4375[0] == height$1460) {0;
} else {var v$4376 = ((height$1460 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(height$1460))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(height$1460))) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$4372,"style"),"height",v$4376);
(r$4375[0] = height$1460,0);
};
var v$4379 = stripdata$1471[0];
var v$4380 = stripdata$1471[1];
var r$4382 = v$4380[4];
if (r$4382[0] == top$1464) {0;
} else {var v$4383 = ((top$1464 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(top$1464))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(top$1464))) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$4379,"style"),"top",v$4383);
(r$4382[0] = top$1464,0);
};
var imgTop$1490 = SmlPrims.chk_ovf_i32(Math.floor(heightR$1463 * v$1523));
var styleHeight$1491 = SmlPrims.chk_ovf_i32(Math.floor(heightR$1463 * v$1522));
var v$4386 = stripdata$1471[0];
var v$4387 = stripdata$1471[1];
var r$4389 = v$4387[1];
if (r$4389[0] == styleHeight$1491) {0;
} else {var v$4390 = ((styleHeight$1491 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(styleHeight$1491))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(styleHeight$1491))) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$4386,"style"),"height",v$4390);
(r$4389[0] = styleHeight$1491,0);
};
var styleWidth$1493 = SmlPrims.chk_ovf_i32(Math.floor(widthR$1462 * v$1525));
var v$4393 = stripdata$1471[0];
var v$4394 = stripdata$1471[1];
var r$4396 = v$4394[5];
if (r$4396[0] == styleWidth$1493) {0;
} else {var v$4397 = ((styleWidth$1493 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(styleWidth$1493))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(styleWidth$1493))) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$4393,"style"),"width",v$4397);
(r$4396[0] = styleWidth$1493,0);
};
var styleTop$1495 = SmlPrims.chk_ovf_i32(top$1464 - imgTop$1490);
var v$4400 = stripdata$1471[0];
var v$4401 = stripdata$1471[1];
var r$4403 = v$4401[4];
if (r$4403[0] == styleTop$1495) {0;
} else {var v$4404 = ((styleTop$1495 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(styleTop$1495))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(styleTop$1495))) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$4400,"style"),"top",v$4404);
(r$4403[0] = styleTop$1495,0);
};
var styleLeft$1497 = SmlPrims.chk_ovf_i32((SmlPrims.chk_ovf_i32(v$1595 * 1)) - v$1524);
var v$4407 = stripdata$1471[0];
var v$4408 = stripdata$1471[1];
var r$4410 = v$4408[2];
if (r$4410[0] == styleLeft$1497) {0;
} else {var v$4411 = ((styleLeft$1497 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(styleLeft$1497))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(styleLeft$1497))) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$4407,"style"),"left",v$4411);
(r$4410[0] = styleLeft$1497,0);
};
var styleClip$1499;
var t$4786;
var t$4785;
var t$4784;
var t$4783;
var t$4782;
var t$4781 = ("rect(" + ((imgTop$1490 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(imgTop$1490))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(imgTop$1490)))) + ",";
var t$4780;
var i$3120 = SmlPrims.chk_ovf_i32(v$1524 + 1);
t$4780 = ((i$3120 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(i$3120))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(i$3120)));
t$4782 = (t$4781 + t$4780);
t$4783 = (t$4782 + ",");
var t$4779;
var i$3122 = SmlPrims.chk_ovf_i32(imgTop$1490 + height$1460);
t$4779 = ((i$3122 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(i$3122))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(i$3122)));
t$4784 = (t$4783 + t$4779);
t$4785 = (t$4784 + ",");
t$4786 = (t$4785 + ((v$1524 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(v$1524))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(v$1524))));
styleClip$1499 = (t$4786 + ")");
var v$3127 = stripdata$1471[0];
var v$3128 = stripdata$1471[1];
var r$3130 = v$3128[0];
if (r$3130[0] == styleClip$1499) {0;
} else {(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$3127,"style"),"clip",styleClip$1499);
(r$3130[0] = styleClip$1499,0);
};
var dwx$1501 = v$1585 - player$476[5][0];
var dwy$1506 = v$1586 - player$476[6][0];
var wallDist$1511 = (dwx$1501 * dwx$1501) + (dwy$1506 * dwy$1506);
var v$4414 = stripdata$1471[0];
var v$4415 = stripdata$1471[1];
var n$4416 = SmlPrims.chk_ovf_i32(-(SmlPrims.chk_ovf_i32(Math.floor(wallDist$1511 * 1000.0))));
var r$4417 = v$4415[6];
if (r$4417[0] == n$4416) {0;
} else {var v$4418 = (n$4416 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(n$4416))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(n$4416));
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$4414,"style"),"zIndex",v$4418);
(r$4417[0] = n$4416,0);
};
return v$1590;
};
};
};
});
var zero$1623 = SmlPrims.getrealtime();
var gameCycle$1628 = function(spriteMap$1631){var gameCycleDelay$1632 = TtcHr52auHS5gydZjBhWJe$3basis$0IntInfRep$1.div$1394([0,[[1000,null],false]],[0,[[30,null],false]]);
var fix$4787 = {};
fix$4787.$cycle = function(lastGameCycleTime$1636){lab$cycle: while (true) {var n$1639;
var v$4492;
var v$4628 = SmlPrims.getrealtime();
v$4492 = (g14hFoVCUPM3ZC3WsORS6h$3basis$0Time$1.s$g$309(v$4628[0],v$4628[1],zero$1623[0],zero$1623[1]));
n$1639 = (g14hFoVCUPM3ZC3WsORS6h$3basis$0Time$1.toMilliseconds$97(v$4492[0],v$4492[1]));
var timeDelta$1640 = TtcHr52auHS5gydZjBhWJe$3basis$0IntInfRep$1.s$g$1258(lastGameCycleTime$1636,n$1639);
var mul$3158 = (xe4rCkobvAWmCENzbhJ8Ed$3basis$0IntInf$1.toInt$1823(timeDelta$1640)) / (xe4rCkobvAWmCENzbhJ8Ed$3basis$0IntInf$1.toInt$1823(gameCycleDelay$1632));
var moveStep$3160 = (mul$3158 * player$476[4][0]) * player$476[0];
var t$4789 = player$476[3];
var t$4788;
var a$3162 = player$476[3][0] + player$476[2][0];
t$4788 = ((a$3162 > 0.0)?((a$3162 > 2.0)?2.0:a$3162):((a$3162 < (-(2.0)))?(-(2.0)):a$3162));
(t$4789[0] = t$4788,0);
var drot$3164 = (mul$3158 * player$476[3][0]) * MaxRotSpeed$475;
var v$4100 = player$476[1];
(v$4100[0] = (v$4100[0] + drot$3164),0);
var dx$3169 = (Math.cos(player$476[1][0])) * moveStep$3160;
var dy$3170 = (Math.sin(player$476[1][0])) * moveStep$3160;
var fromX$3171 = player$476[5][0];
var fromY$3172 = player$476[6][0];
var v$3173 = checkCollision$661(spriteMap$1631,fromX$3171,fromY$3172,fromX$3171 + dx$3169,fromY$3172 + dy$3170,0.35);
var v$3174 = v$3173[0];
var v$3175 = v$3173[1];
(player$476[5][0] = v$3174,0);
(player$476[6][0] = v$3175,0);
var cycleDelay$1641 = (TtcHr52auHS5gydZjBhWJe$3basis$0IntInfRep$1.s$l$1462(timeDelta$1640,gameCycleDelay$1632))?(xe4rCkobvAWmCENzbhJ8Ed$3basis$0IntInf$1.max$2267([0,[[1,null],false]],TtcHr52auHS5gydZjBhWJe$3basis$0IntInfRep$1.s$g$1258(TtcHr52auHS5gydZjBhWJe$3basis$0IntInfRep$1.s$g$1258(gameCycleDelay$1632,timeDelta$1640),gameCycleDelay$1632))):gameCycleDelay$1632;
(function(i,f){return setTimeout(f,i);})(xe4rCkobvAWmCENzbhJ8Ed$3basis$0IntInf$1.toInt$1823(cycleDelay$1641),(function(env$4792){return function(v$4499){var v$4790 = env$4792[0];
var v$4791 = env$4792[1];
return v$4791(v$4790);
};
})([n$1639,fix$4787.$cycle]));
return 0;
};
};
var cycle$1633 = fix$4787.$cycle;
return cycle$1633([0,[null,false]]);
};
var updateOverlay$1667;
var old$3194 = [""];
updateOverlay$1667 = (function(v$3195){var s$3196 = "FPS: " + ((y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.fmt$169([2,[0,0]]))(v$3195));
if (old$3194[0] == s$3196) {return 0;
} else {var e$3200;
var v$3202 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"overlay");
switch (v$3202[0]) { case 0: {e$3200 = v$3202[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'overlay' in DOM"];
} };
(function(e,s){e.innerHTML = s;})(e$3200,s$3196);
return (old$3194[0] = s$3196,0);
};
});
var updateScore$1671;
var old$3212 = [""];
updateScore$1671 = (function(v$3213){var s$3214 = "SCORE: " + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(v$3213));
if (old$3212[0] == s$3214) {return 0;
} else {var e$3218;
var v$3220 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"score");
switch (v$3220[0]) { case 0: {e$3218 = v$3220[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'score' in DOM"];
} };
(function(e,s){e.innerHTML = s;})(e$3218,s$3214);
return (old$3212[0] = s$3214,0);
};
});
var renderSprites$1675 = function(oldSprites$1678,sprites$1681){var v$3228 = function(v$4557,v$4678,v$4679){var dx$3239 = (v$4678 + 0.5) - player$476[5][0];
var dy$3243 = (v$4679 + 0.5) - player$476[6][0];
var dist$3247 = Math.sqrt((dx$3239 * dx$3239) + (dy$3243 * dy$3243));
var spriteAngle$3248 = (Math.atan2(dy$3243,dx$3239)) - player$476[1][0];
var size$3252 = viewDist$499 / ((Math.cos(spriteAngle$3248)) * dist$3247);
if (size$3252 <= 0.0) {return 0;
} else {(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$4557,"style"),"display","block");
var screen_x$3259 = ((Math.sin(spriteAngle$3248)) / (Math.cos(spriteAngle$3248))) * viewDist$499;
var left$3260 = y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615(((screenWidthR$496 / 2.0) + screen_x$3259) - (size$3252 / 2.0));
var top$3261 = y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615((screenHeightR$497 - size$3252) / 2.0);
var v$4145 = ((left$3260 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(left$3260))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(left$3260))) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$4557,"style"),"left",v$4145);
var v$4151 = ((top$3261 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(top$3261))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(top$3261))) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$4557,"style"),"top",v$4151);
var dbx$3264 = v$4678 - player$476[5][0];
var dby$3268 = v$4679 - player$476[6][0];
var sz$3272;
var t$4793;
var i$3319 = y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615(size$3252);
t$4793 = ((i$3319 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(i$3319))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(i$3319)));
sz$3272 = (t$4793 + "px");
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$4557,"style"),"width",sz$3272);
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$4557,"style"),"height",sz$3272);
var blockDist$3275 = (dbx$3264 * dbx$3264) + (dby$3268 * dby$3268);
var zIndex$3276 = SmlPrims.chk_ovf_i32(-(SmlPrims.chk_ovf_i32(Math.floor(blockDist$3275 * 1000.0))));
var v$4165 = (zIndex$3276 < 0)?("-" + (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(SmlPrims.chk_ovf_i32(-(zIndex$3276))))):(abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(zIndex$3276));
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$4557,"style"),"zIndex",v$4165);
return 0;
};
};
var fix$4794 = {};
fix$4794.$app = function(v$3279){lab$app: while (true) {if (v$3279 == null) {return 0;
} else {var v$3280 = v$3279;
var v$3281 = v$3280[0];
var v$3282 = v$3280[1];
var v$4681 = v$3281[3];
v$3228(v$3281[2],v$4681[0],v$4681[1]);
var t$4795 = v$3282;
var v$3279 = t$4795;
continue lab$app;
};
};
};
var app$3278 = fix$4794.$app;
app$3278(sprites$1681);
var fix$4796 = {};
fix$4796.$app = function(v$3347){lab$app: while (true) {if (v$3347 == null) {return 0;
} else {var v$3348 = v$3347;
var v$3349 = v$3348[0];
var v$3350 = v$3348[1];
(v$3349[4][0]?false:true)?((function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(v$3349[2],"style"),"display","none")):0;
var t$4797 = v$3350;
var v$3347 = t$4797;
continue lab$app;
};
};
};
var app$3346 = fix$4796.$app;
return app$3346(oldSprites$1678);
};
var score$1777 = [0];
var renderCycle$1778 = function(screenStrips$1781,spriteMap$1784){var renderCycleDelay$1785 = TtcHr52auHS5gydZjBhWJe$3basis$0IntInfRep$1.div$1394([0,[[1000,null],false]],[0,[[30,null],false]]);
var fix$4798 = {};
fix$4798.$cycle = function(v$4558,v$4559){lab$cycle: while (true) {var miniMap$4423;
var v$4424 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"minimap");
switch (v$4424[0]) { case 0: {miniMap$4423 = v$4424[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'minimap' in DOM"];
} };
var miniMapObjects$4425;
var v$4426 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"minimapobjects");
switch (v$4426[0]) { case 0: {miniMapObjects$4425 = v$4426[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'minimapobjects' in DOM"];
} };
var height$4427 = (function(fp,s){return fp[s];})(miniMap$4423,"height");
var width$4428 = (function(fp,s){return fp[s];})(miniMap$4423,"width");
var c$4429 = (function(e,s){return e.getContext(s);})(miniMapObjects$4425,"2d");
(function(c,a1,a2,a3,a4){c.clearRect(a1,a2,a3,a4);})(c$4429,0,0,width$4428,height$4427);
(function(c,a1,a2,a3,a4){c.fillRect(a1,a2,a3,a4);})(c$4429,y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615((player$476[5][0] * miniMapScaleR$490) - 2.0),y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615((player$476[6][0] * miniMapScaleR$490) - 2.0),4,4);
(function(c){c.beginPath();})(c$4429);
(function(c,a1,a2){c.moveTo(a1,a2);})(c$4429,y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615(player$476[5][0] * miniMapScaleR$490),y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615(player$476[6][0] * miniMapScaleR$490));
(function(c,a1,a2){c.lineTo(a1,a2);})(c$4429,y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615((player$476[5][0] + (Math.cos(player$476[1][0]))) * miniMapScaleR$490),y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.round$615((player$476[6][0] + (Math.sin(player$476[1][0]))) * miniMapScaleR$490));
(function(c){c.closePath();})(c$4429);
(function(c){c.stroke();})(c$4429);
var fix$4799 = {};
fix$4799.$app = function(v$3378){lab$app: while (true) {if (v$3378 == null) {return 0;
} else {var v$3379 = v$3378;
var v$3380 = v$3379[0];
var v$3381 = v$3379[1];
(v$3380[4][0] = false,0);
var t$4800 = v$3381;
var v$3378 = t$4800;
continue lab$app;
};
};
};
var app$3377 = fix$4799.$app;
app$3377(v$4559);
var sprites$1795;
var fix$4801 = {};
fix$4801.$loop = function(i$3387,acc$3388){lab$loop: while (true) {if (i$3387 >= numRays$498) {return acc$3388;
} else {var rayScreenPos$3389 = (((-(numRays$498)) / 2.0) + i$3387) * stripWidthR$488;
var rayViewDist$3391 = Math.sqrt((rayScreenPos$3389 * rayScreenPos$3389) + (viewDist$499 * viewDist$499));
var rayAngle$3392 = Math.asin(rayScreenPos$3389 / rayViewDist$3391);
var acc$3394 = ((castSingleRay$1135(screenStrips$1781))(spriteMap$1784))([player$476[1][0] + rayAngle$3392,i$3387,acc$3388]);
var t$4802 = SmlPrims.chk_ovf_i32(i$3387 + 1);
var t$4803 = acc$3394;
var i$3387 = t$4802;
var acc$3388 = t$4803;
continue lab$loop;
};
};
};
var loop$3386 = fix$4801.$loop;
sprites$1795 = (loop$3386(0,null));
renderSprites$1675(v$4559,sprites$1795);
var n$1797;
var v$4510;
var v$4647 = SmlPrims.getrealtime();
v$4510 = (g14hFoVCUPM3ZC3WsORS6h$3basis$0Time$1.s$g$309(v$4647[0],v$4647[1],zero$1623[0],zero$1623[1]));
n$1797 = (g14hFoVCUPM3ZC3WsORS6h$3basis$0Time$1.toMilliseconds$97(v$4510[0],v$4510[1]));
var timeDelta$1798 = TtcHr52auHS5gydZjBhWJe$3basis$0IntInfRep$1.s$g$1258(v$4558,n$1797);
var cycleDelay$1799 = (TtcHr52auHS5gydZjBhWJe$3basis$0IntInfRep$1.s$l$1462(timeDelta$1798,renderCycleDelay$1785))?(xe4rCkobvAWmCENzbhJ8Ed$3basis$0IntInf$1.max$2267([0,[[1,null],false]],TtcHr52auHS5gydZjBhWJe$3basis$0IntInfRep$1.s$g$1258(TtcHr52auHS5gydZjBhWJe$3basis$0IntInfRep$1.s$g$1258(renderCycleDelay$1785,timeDelta$1798),renderCycleDelay$1785))):renderCycleDelay$1785;
var cycleDelay$1804 = xe4rCkobvAWmCENzbhJ8Ed$3basis$0IntInf$1.toInt$1823(cycleDelay$1799);
(function(i,f){return setTimeout(f,i);})(cycleDelay$1804,(function(env$4807){return function(v$4676){var v$4804 = env$4807[0];
var v$4805 = env$4807[1];
var v$4806 = env$4807[2];
return v$4806(v$4805,v$4804);
};
})([sprites$1795,n$1797,fix$4798.$cycle]));
var fps$1805 = 1000.0 / (xe4rCkobvAWmCENzbhJ8Ed$3basis$0IntInf$1.toInt$1823(timeDelta$1798));
updateOverlay$1667(fps$1805);
return updateScore$1671(score$1777[0]);
};
};
var cycle$1786 = fix$4798.$cycle;
return cycle$1786([0,[null,false]],null);
};
var init$1839 = function(){(function(f){document.onkeydown = function(e) { e = e || window.event; f(e.keyCode); };})(function(v$3435){switch (v$3435) { case 38: {return (player$476[4][0] = 1.0,0);
 break; }case 40: {return (player$476[4][0] = (-1.0),0);
 break; }case 37: {var rotAcc$3438 = player$476[2];
return (rotAcc$3438[0] > (-0.5))?(rotAcc$3438[0] = (rotAcc$3438[0] - 0.1),0):0;
 break; }case 39: {var rotAcc$3440 = player$476[2];
return (rotAcc$3440[0] < 0.5)?(rotAcc$3440[0] = (rotAcc$3440[0] + 0.1),0):0;
 break; }default: {return 0;
} };
});
(function(f){document.onkeyup = function(e) { e = e || window.event; f(e.keyCode); };})(function(v$3444){switch (v$3444) { case 38: {return (player$476[4][0] = 0.0,0);
 break; }case 40: {return (player$476[4][0] = 0.0,0);
 break; }case 37: {(player$476[3][0] = 0.0,0);
return (player$476[2][0] = 0.0,0);
 break; }case 39: {(player$476[3][0] = 0.0,0);
return (player$476[2][0] = 0.0,0);
 break; }default: {return 0;
} };
});
try {var t$4814 = h9AP67nN46MQi5f2NQrocNd$3university$0university$1.loadStaff$60;
var t$4813;
var file$3452;
var t$4812 = "data/staff.json?_=";
var t$4811;
var t$4810 = y1CWDAIcrGTm72MVeo9tyi$3basis$0Real$1.toString$158;
var t$4809;
var v$3455 = SmlPrims.getrealtime();
var v$3456 = v$3455[0];
var v$3457 = v$3455[1];
t$4809 = ((v$3456 - (-2147483648)) + (v$3457 / 1000000.0));
t$4811 = (t$4810(t$4809));
file$3452 = (t$4812 + t$4811);
var r$3458 = SmlPrims.newRequest();
(function(r,m,u,a){return r.open(m,u,a);})(r$3458,"GET",file$3452,false);
z11cymP27JOrM6FBeJkkje$3js$0Js$1.send$652(r$3458,[1]);
var v$3461 = (function(r){return SmlPrims.option(r.responseText);})(r$3458);
switch (v$3461[0]) { case 0: {t$4813 = v$3461[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"serverGet failed on file " + file$3452];
} };
t$4814(t$4813);
} catch(v$4808) {(function(v$1847){var t$4815 = v$1847;
if (t$4815[0] == sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52) {var msg$1844 = v$1847[1];
var s$3463 = "Failed to load data/staff.json file: " + msg$1844;
var log$3464;
var v$3466 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"log");
switch (v$3466[0]) { case 0: {log$3464 = v$3466[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'log' in DOM"];
} };
(function(e,a){return e.appendChild(a);})(log$3464,document.createTextNode(s$3463));
(function(e,a){return e.appendChild(a);})(log$3464,document.createElement("br"));
return null;
} else {throw v$1847;
};
})(v$4808);
};
var v$3491 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"screen");
switch (v$3491[0]) { case 0: {v$3491[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'screen' in DOM"];
} };
var screenStrips$1850;
var xs$3474;
var fix$4816 = {};
fix$4816.$loop = function(i$3495){if (i$3495 >= screenWidth$230) {return null;
} else {var strip$3496 = document.createElement("img");
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(strip$3496,"style"),"position","absolute");
(function(fp,s,v){fp[s] = v;})(strip$3496,"src","walls.png");
var stripdata$3505;
var t$4818 = strip$3496;
var t$4817;
var v$3506 = [-1];
var v$3507 = [-1];
var v$3508 = [-1];
var v$3509 = [-1];
var v$3510 = [""];
var v$3511 = [-1];
t$4817 = [v$3510,v$3507,v$3508,["walls.png"],v$3509,v$3506,v$3511];
stripdata$3505 = [t$4818,t$4817];
var v$4432 = stripdata$3505[1];
var r$4434 = v$4432[1];
if (r$4434[0] == 0) {0;
} else {var v$4435 = (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(0)) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(strip$3496,"style"),"height",v$4435);
(r$4434[0] = 0,0);
};
var v$4439 = stripdata$3505[1];
var r$4441 = v$4439[2];
if (r$4441[0] == 0) {0;
} else {var v$4442 = (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(0)) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(strip$3496,"style"),"left",v$4442);
(r$4441[0] = 0,0);
};
var v$4446 = stripdata$3505[1];
var r$4448 = v$4446[4];
if (r$4448[0] == 0) {0;
} else {var v$4449 = (abSkfeMyxlIKxrMz4NXGul$3basis$0Int32$1.toString$456(0)) + "px";
(function(fp,s,v){fp[s] = v;})((function(fp,s){return fp[s];})(strip$3496,"style"),"top",v$4449);
(r$4448[0] = 0,0);
};
var t$4819;
var v$3514 = (function(d,id){return SmlPrims.option(d.getElementById(id));})(z11cymP27JOrM6FBeJkkje$3js$0Js$1.document$86,"screen");
switch (v$3514[0]) { case 0: {t$4819 = v$3514[1];
 break; }default: {throw [sWBNi829bz3yxJwtxAWd8b$3basis$0Initial$1.en$Fail$52,"no element with id 'screen' in DOM"];
} };
(function(e,a){return e.appendChild(a);})(t$4819,strip$3496);
return [stripdata$3505,fix$4816.$loop(SmlPrims.chk_ovf_i32(i$3495 + 1))];
};
};
var loop$3494 = fix$4816.$loop;
xs$3474 = (loop$3494(0));
var fix$4820 = {};
fix$4820.$init = function(v$4562,v$4563,v$4564){lab$init: while (true) {if (v$4562 == null) {return v$4563;
} else {var v$3479 = v$4562;
var v$3480 = v$3479[0];
var v$3481 = v$3479[1];
(v$4563[v$4564] = v$3480,0);
var t$4821 = v$3481;
var t$4822 = v$4563;
var t$4823 = SmlPrims.chk_ovf_i32(v$4564 + 1);
var v$4562 = t$4821;
var v$4563 = t$4822;
var v$4564 = t$4823;
continue lab$init;
};
};
};
var init$3475 = fix$4820.$init;
var t$4829 = init$3475;
var t$4828 = xs$3474;
var t$4827;
var n$3483;
var fix$4824 = {};
fix$4824.$acc = function(v$3485,v$3486){lab$acc: while (true) {if (v$3485 == null) {return v$3486;
} else {var t$4825 = v$3485[1];
var t$4826 = SmlPrims.chk_ovf_i32(v$3486 + 1);
var v$3485 = t$4825;
var v$3486 = t$4826;
continue lab$acc;
};
};
};
var acc$3484 = fix$4824.$acc;
n$3483 = (acc$3484(xs$3474,0));
if ((0 <= n$3483)?(n$3483 <= 123456789):false) {0;
} else {throw CompilerInitial.exn$Size$51;
};
t$4827 = (Array(n$3483));
screenStrips$1850 = (t$4829(t$4828,t$4827,0));
var spriteMap$1851 = init$416(Y5y0a7l58ITwhpccCWLDEa$3basis$0Array2$1.foldi$383(0,function(v$4609){var v$4610 = v$4609[0];
var v$4611 = v$4609[1];
var v$4612 = v$4609[2];
var v$4613 = v$4609[3];
var v$4614;
switch (v$4612[0]) { case 8: {var v$4615 = v$4612[1];
v$4614 = [0,v$4615];
 break; }default: {v$4614 = [1];
} };
switch (v$4614[0]) { case 0: {return [[v$4614[1],v$4611,v$4610],v$4613];
 break; }default: {return v$4613;
} };
},null,Map$332,0,0,[1],[1]));
drawMiniMap$955();
gameCycle$1628(spriteMap$1851);
return renderCycle$1778(screenStrips$1850,spriteMap$1851);
};
(function(a){return window.onload=a;})(function(v$4524){return init$1839();
});
return 0;
})();
